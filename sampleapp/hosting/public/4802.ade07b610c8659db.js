"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[4802],{4802:(Wx,ju,U)=>{U.r(ju),U.d(ju,{HomePageModule:()=>$x});var Ku=U(6814),qe=U(3800),Z_=U(95),$u=U(4934),b=U(9212),Y_=U(8662),Oe=U(1180),Ne=U(8326),ai=U(7217),ht=U(7213),X_=U(6321),J_=U(5592),ui=U(2459),Qu=U(2096),ks=U(7921),ef=U(9360),tf=U(8251);function Fs(){return(0,ef.e)((n,e)=>{let t,r=!1;n.subscribe((0,tf.x)(e,i=>{const s=t;t=i,r&&e.next([s,i]),r=!0}))})}var w,je=U(7398),Ms=U(6699),nf=U(3997),Wu=U(2181),rf=(U(6230),U(3106)),g=U(5861),ci=U(534),Hu=U(4537),Ke=U(7879),$=U(9058),sf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Ue={},Os=Os||{},N=sf||self;function li(n){var e=typeof n;return"array"==(e="object"!=e?e:n?Array.isArray(n)?"array":e:"null")||"object"==e&&"number"==typeof n.length}function Hn(n){var e=typeof n;return"object"==e&&null!=n||"function"==e}var Ls="closure_uid_"+(1e9*Math.random()>>>0),af=0;function uf(n,e,t){return n.call.apply(n.bind,arguments)}function cf(n,e,t){if(!n)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,r),n.apply(e,i)}}return function(){return n.apply(e,arguments)}}function Ie(n,e,t){return(Ie=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?uf:cf).apply(null,arguments)}function hi(n,e){var t=Array.prototype.slice.call(arguments,1);return function(){var r=t.slice();return r.push.apply(r,arguments),n.apply(this,r)}}function le(n,e){function t(){}t.prototype=e.prototype,n.$=e.prototype,n.prototype=new t,n.prototype.constructor=n,n.ac=function(r,i,s){for(var o=Array(arguments.length-2),a=2;a<arguments.length;a++)o[a-2]=arguments[a];return e.prototype[i].apply(r,o)}}function dt(){this.s=this.s,this.o=this.o}dt.prototype.s=!1,dt.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),0)&&function of(n){Object.prototype.hasOwnProperty.call(n,Ls)&&n[Ls]||(n[Ls]=++af)}(this)},dt.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const Zu=Array.prototype.indexOf?function(n,e){return Array.prototype.indexOf.call(n,e,void 0)}:function(n,e){if("string"==typeof n)return"string"!=typeof e||1!=e.length?-1:n.indexOf(e,0);for(let t=0;t<n.length;t++)if(t in n&&n[t]===e)return t;return-1};function Bs(n){const e=n.length;if(0<e){const t=Array(e);for(let r=0;r<e;r++)t[r]=n[r];return t}return[]}function Yu(n,e){for(let t=1;t<arguments.length;t++){const r=arguments[t];if(li(r)){const i=n.length||0,s=r.length||0;n.length=i+s;for(let o=0;o<s;o++)n[i+o]=r[o]}else n.push(r)}}function Te(n,e){this.type=n,this.g=this.target=e,this.defaultPrevented=!1}Te.prototype.h=function(){this.defaultPrevented=!0};var hf=function(){if(!N.addEventListener||!Object.defineProperty)return!1;var n=!1,e=Object.defineProperty({},"passive",{get:function(){n=!0}});try{const t=()=>{};N.addEventListener("test",t,e),N.removeEventListener("test",t,e)}catch{}return n}();function Zn(n){return/^[\s\xa0]*$/.test(n)}function di(){var n=N.navigator;return n&&(n=n.userAgent)?n:""}function $e(n){return-1!=di().indexOf(n)}function qs(n){return qs[" "](n),n}qs[" "]=function(){};var Gs,n,_f=$e("Opera"),on=$e("Trident")||$e("MSIE"),Xu=$e("Edge"),Us=Xu||on,Ju=$e("Gecko")&&!(-1!=di().toLowerCase().indexOf("webkit")&&!$e("Edge"))&&!($e("Trident")||$e("MSIE"))&&!$e("Edge"),ff=-1!=di().toLowerCase().indexOf("webkit")&&!$e("Edge");function ec(){var n=N.document;return n?n.documentMode:void 0}e:{var zs="",js=(n=di(),Ju?/rv:([^\);]+)(\)|;)/.exec(n):Xu?/Edge\/([\d\.]+)/.exec(n):on?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(n):ff?/WebKit\/(\S+)/.exec(n):_f?/(?:Version)[ \/]?(\S+)/.exec(n):void 0);if(js&&(zs=js?js[1]:""),on){var Ks=ec();if(null!=Ks&&Ks>parseFloat(zs)){Gs=String(Ks);break e}}Gs=zs}var mf=N.document&&on&&(ec()||parseInt(Gs,10))||void 0;function Yn(n,e){if(Te.call(this,n?n.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,n){var t=this.type=n.type,r=n.changedTouches&&n.changedTouches.length?n.changedTouches[0]:null;if(this.target=n.target||n.srcElement,this.g=e,e=n.relatedTarget){if(Ju){e:{try{qs(e.nodeName);var i=!0;break e}catch{}i=!1}i||(e=null)}}else"mouseover"==t?e=n.fromElement:"mouseout"==t&&(e=n.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==n.clientX?n.clientX:n.pageX,this.clientY=void 0!==n.clientY?n.clientY:n.pageY,this.screenX=n.screenX||0,this.screenY=n.screenY||0),this.button=n.button,this.key=n.key||"",this.ctrlKey=n.ctrlKey,this.altKey=n.altKey,this.shiftKey=n.shiftKey,this.metaKey=n.metaKey,this.pointerId=n.pointerId||0,this.pointerType="string"==typeof n.pointerType?n.pointerType:gf[n.pointerType]||"",this.state=n.state,this.i=n,n.defaultPrevented&&Yn.$.h.call(this)}}le(Yn,Te);var gf={2:"touch",3:"pen",4:"mouse"};Yn.prototype.h=function(){Yn.$.h.call(this);var n=this.i;n.preventDefault?n.preventDefault():n.returnValue=!1};var Xn="closure_listenable_"+(1e6*Math.random()|0),pf=0;function xf(n,e,t,r,i){this.listener=n,this.proxy=null,this.src=e,this.type=t,this.capture=!!r,this.la=i,this.key=++pf,this.fa=this.ia=!1}function _i(n){n.fa=!0,n.listener=null,n.proxy=null,n.src=null,n.la=null}function Qs(n,e,t){for(const r in n)e.call(t,n[r],r,n)}function nc(n){const e={};for(const t in n)e[t]=n[t];return e}const rc="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ic(n,e){let t,r;for(let i=1;i<arguments.length;i++){for(t in r=arguments[i],r)n[t]=r[t];for(let s=0;s<rc.length;s++)t=rc[s],Object.prototype.hasOwnProperty.call(r,t)&&(n[t]=r[t])}}function fi(n){this.src=n,this.g={},this.h=0}function Ws(n,e){var t=e.type;if(t in n.g){var s,r=n.g[t],i=Zu(r,e);(s=0<=i)&&Array.prototype.splice.call(r,i,1),s&&(_i(e),0==n.g[t].length&&(delete n.g[t],n.h--))}}function Hs(n,e,t,r){for(var i=0;i<n.length;++i){var s=n[i];if(!s.fa&&s.listener==e&&s.capture==!!t&&s.la==r)return i}return-1}fi.prototype.add=function(n,e,t,r,i){var s=n.toString();(n=this.g[s])||(n=this.g[s]=[],this.h++);var o=Hs(n,e,r,i);return-1<o?(e=n[o],t||(e.ia=!1)):((e=new xf(e,this.src,s,!!r,i)).ia=t,n.push(e)),e};var Zs="closure_lm_"+(1e6*Math.random()|0),Ys={};function sc(n,e,t,r,i){if(r&&r.once)return ac(n,e,t,r,i);if(Array.isArray(e)){for(var s=0;s<e.length;s++)sc(n,e[s],t,r,i);return null}return t=to(t),n&&n[Xn]?n.O(e,t,Hn(r)?!!r.capture:!!r,i):oc(n,e,t,!1,r,i)}function oc(n,e,t,r,i,s){if(!e)throw Error("Invalid event type");var o=Hn(i)?!!i.capture:!!i,a=Js(n);if(a||(n[Zs]=a=new fi(n)),(t=a.add(e,t,r,o,s)).proxy)return t;if(r=function If(){const e=Tf;return function n(t){return e.call(n.src,n.listener,t)}}(),t.proxy=r,r.src=n,r.listener=t,n.addEventListener)hf||(i=o),void 0===i&&(i=!1),n.addEventListener(e.toString(),r,i);else if(n.attachEvent)n.attachEvent(cc(e.toString()),r);else{if(!n.addListener||!n.removeListener)throw Error("addEventListener and attachEvent are unavailable.");n.addListener(r)}return t}function ac(n,e,t,r,i){if(Array.isArray(e)){for(var s=0;s<e.length;s++)ac(n,e[s],t,r,i);return null}return t=to(t),n&&n[Xn]?n.P(e,t,Hn(r)?!!r.capture:!!r,i):oc(n,e,t,!0,r,i)}function uc(n,e,t,r,i){if(Array.isArray(e))for(var s=0;s<e.length;s++)uc(n,e[s],t,r,i);else r=Hn(r)?!!r.capture:!!r,t=to(t),n&&n[Xn]?(n=n.i,(e=String(e).toString())in n.g&&-1<(t=Hs(s=n.g[e],t,r,i))&&(_i(s[t]),Array.prototype.splice.call(s,t,1),0==s.length&&(delete n.g[e],n.h--))):n&&(n=Js(n))&&(e=n.g[e.toString()],n=-1,e&&(n=Hs(e,t,r,i)),(t=-1<n?e[n]:null)&&Xs(t))}function Xs(n){if("number"!=typeof n&&n&&!n.fa){var e=n.src;if(e&&e[Xn])Ws(e.i,n);else{var t=n.type,r=n.proxy;e.removeEventListener?e.removeEventListener(t,r,n.capture):e.detachEvent?e.detachEvent(cc(t),r):e.addListener&&e.removeListener&&e.removeListener(r),(t=Js(e))?(Ws(t,n),0==t.h&&(t.src=null,e[Zs]=null)):_i(n)}}}function cc(n){return n in Ys?Ys[n]:Ys[n]="on"+n}function Tf(n,e){if(n.fa)n=!0;else{e=new Yn(e,this);var t=n.listener,r=n.la||n.src;n.ia&&Xs(n),n=t.call(r,e)}return n}function Js(n){return(n=n[Zs])instanceof fi?n:null}var eo="__closure_events_fn_"+(1e9*Math.random()>>>0);function to(n){return"function"==typeof n?n:(n[eo]||(n[eo]=function(e){return n.handleEvent(e)}),n[eo])}function he(){dt.call(this),this.i=new fi(this),this.S=this,this.J=null}function me(n,e){var t,r=n.J;if(r)for(t=[];r;r=r.J)t.push(r);if(n=n.S,r=e.type||e,"string"==typeof e)e=new Te(e,n);else if(e instanceof Te)e.target=e.target||n;else{var i=e;ic(e=new Te(r,n),i)}if(i=!0,t)for(var s=t.length-1;0<=s;s--){var o=e.g=t[s];i=mi(o,r,!0,e)&&i}if(i=mi(o=e.g=n,r,!0,e)&&i,i=mi(o,r,!1,e)&&i,t)for(s=0;s<t.length;s++)i=mi(o=e.g=t[s],r,!1,e)&&i}function mi(n,e,t,r){if(!(e=n.i.g[String(e)]))return!0;e=e.concat();for(var i=!0,s=0;s<e.length;++s){var o=e[s];if(o&&!o.fa&&o.capture==t){var a=o.listener,u=o.la||o.src;o.ia&&Ws(n.i,o),i=!1!==a.call(u,r)&&i}}return i&&!r.defaultPrevented}le(he,dt),he.prototype[Xn]=!0,he.prototype.removeEventListener=function(n,e,t,r){uc(this,n,e,t,r)},he.prototype.N=function(){if(he.$.N.call(this),this.i){var e,n=this.i;for(e in n.g){for(var t=n.g[e],r=0;r<t.length;r++)_i(t[r]);delete n.g[e],n.h--}}this.J=null},he.prototype.O=function(n,e,t,r){return this.i.add(String(n),e,!1,t,r)},he.prototype.P=function(n,e,t,r){return this.i.add(String(n),e,!0,t,r)};var no=N.JSON.stringify;function vf(){var n=ro;let e=null;return n.g&&(e=n.g,n.g=n.g.next,n.g||(n.h=null),e.next=null),e}var lc=new class Ef{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}(()=>new Af,n=>n.reset());class Af{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}function bf(n){var e=1;n=n.split(":");const t=[];for(;0<e&&n.length;)t.push(n.shift()),e--;return n.length&&t.push(n.join(":")),t}function Rf(n){N.setTimeout(()=>{throw n},0)}let Jn,er=!1,ro=new class wf{constructor(){this.h=this.g=null}add(e,t){const r=lc.get();r.set(e,t),this.h?this.h.next=r:this.g=r,this.h=r}},hc=()=>{const n=N.Promise.resolve(void 0);Jn=()=>{n.then(Pf)}};var Pf=()=>{for(var n;n=vf();){try{n.h.call(n.g)}catch(t){Rf(t)}var e=lc;e.j(n),100>e.h&&(e.h++,n.next=e.g,e.g=n)}er=!1};function gi(n,e){he.call(this),this.h=n||1,this.g=e||N,this.j=Ie(this.qb,this),this.l=Date.now()}function io(n){n.ga=!1,n.T&&(n.g.clearTimeout(n.T),n.T=null)}function so(n,e,t){if("function"==typeof n)t&&(n=Ie(n,t));else{if(!n||"function"!=typeof n.handleEvent)throw Error("Invalid listener argument");n=Ie(n.handleEvent,n)}return 2147483647<Number(e)?-1:N.setTimeout(n,e||0)}function dc(n){n.g=so(()=>{n.g=null,n.i&&(n.i=!1,dc(n))},n.j);const e=n.h;n.h=null,n.m.apply(null,e)}le(gi,he),(w=gi.prototype).ga=!1,w.T=null,w.qb=function(){if(this.ga){var n=Date.now()-this.l;0<n&&n<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-n):(this.T&&(this.g.clearTimeout(this.T),this.T=null),me(this,"tick"),this.ga&&(io(this),this.start()))}},w.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())},w.N=function(){gi.$.N.call(this),io(this),delete this.g};class Sf extends dt{constructor(e,t){super(),this.m=e,this.j=t,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:dc(this)}N(){super.N(),this.g&&(N.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function tr(n){dt.call(this),this.h=n,this.g={}}le(tr,dt);var _c=[];function fc(n,e,t,r){Array.isArray(t)||(t&&(_c[0]=t.toString()),t=_c);for(var i=0;i<t.length;i++){var s=sc(e,t[i],r||n.handleEvent,!1,n.h||n);if(!s)break;n.g[s.key]=s}}function mc(n){Qs(n.g,function(e,t){this.g.hasOwnProperty(t)&&Xs(e)},n),n.g={}}function pi(){this.g=!0}function an(n,e,t,r){n.info(function(){return"XMLHTTP TEXT ("+e+"): "+function Nf(n,e){if(!n.g)return e;if(!e)return null;try{var t=JSON.parse(e);if(t)for(n=0;n<t.length;n++)if(Array.isArray(t[n])){var r=t[n];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var o=1;o<i.length;o++)i[o]=""}}}return no(t)}catch{return e}}(n,t)+(r?" "+r:"")})}tr.prototype.N=function(){tr.$.N.call(this),mc(this)},tr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},pi.prototype.Ea=function(){this.g=!1},pi.prototype.info=function(){};var kt={},gc=null;function xi(){return gc=gc||new he}function pc(n){Te.call(this,kt.Ta,n)}function nr(n){const e=xi();me(e,new pc(e))}function xc(n,e){Te.call(this,kt.STAT_EVENT,n),this.stat=e}function Ae(n){const e=xi();me(e,new xc(e,n))}function yc(n,e){Te.call(this,kt.Ua,n),this.size=e}function rr(n,e){if("function"!=typeof n)throw Error("Fn must not be null and must be a function");return N.setTimeout(function(){n()},e)}kt.Ta="serverreachability",le(pc,Te),kt.STAT_EVENT="statevent",le(xc,Te),kt.Ua="timingevent",le(yc,Te);var yi={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},Ic={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function oo(){}function Ec(){}oo.prototype.h=null;var co,ir={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function ao(){Te.call(this,"d")}function uo(){Te.call(this,"c")}function Ii(){}function sr(n,e,t,r){this.l=n,this.j=e,this.m=t,this.W=r||1,this.U=new tr(this),this.P=kf,this.V=new gi(n=Us?125:void 0),this.I=null,this.i=!1,this.u=this.B=this.A=this.L=this.G=this.Y=this.C=null,this.F=[],this.g=null,this.o=0,this.s=this.v=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new vc}function vc(){this.i=null,this.g="",this.h=!1}le(ao,Te),le(uo,Te),le(Ii,oo),Ii.prototype.g=function(){return new XMLHttpRequest},Ii.prototype.i=function(){return{}},co=new Ii;var kf=45e3,wc={},lo={};function ho(n,e,t){n.L=1,n.A=wi(tt(e)),n.u=t,n.S=!0,Ac(n,null)}function Ac(n,e){n.G=Date.now(),or(n),n.B=tt(n.A);var t=n.B,r=n.W;Array.isArray(r)||(r=[String(r)]),Fc(t.i,"t",r),n.o=0,t=n.l.J,n.h=new vc,n.g=sl(n.l,t?e:null,!n.u),0<n.O&&(n.M=new Sf(Ie(n.Pa,n,n.g),n.O)),fc(n.U,n.g,"readystatechange",n.nb),e=n.I?nc(n.I):{},n.u?(n.v||(n.v="POST"),e["Content-Type"]="application/x-www-form-urlencoded",n.g.ha(n.B,n.v,n.u,e)):(n.v="GET",n.g.ha(n.B,n.v,null,e)),nr(),function Vf(n,e,t,r,i,s){n.info(function(){if(n.g)if(s)for(var o="",a=s.split("&"),u=0;u<a.length;u++){var c=a[u].split("=");if(1<c.length){var l=c[0];c=c[1];var h=l.split("_");o=2<=h.length&&"type"==h[1]?o+(l+"=")+c+"&":o+(l+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+t+"\n"+o})}(n.j,n.v,n.B,n.m,n.W,n.u)}function bc(n){return!!n.g&&"GET"==n.v&&2!=n.L&&n.l.Ha}function Rc(n,e,t){let i,r=!0;for(;!n.J&&n.o<t.length;){if(i=Ff(n,t),i==lo){4==e&&(n.s=4,Ae(14),r=!1),an(n.j,n.m,null,"[Incomplete Response]");break}if(i==wc){n.s=4,Ae(15),an(n.j,n.m,t,"[Invalid Chunk]"),r=!1;break}an(n.j,n.m,i,null),_o(n,i)}bc(n)&&0!=n.o&&(n.h.g=n.h.g.slice(n.o),n.o=0),4!=e||0!=t.length||n.h.h||(n.s=1,Ae(16),r=!1),n.i=n.i&&r,r?0<t.length&&!n.ba&&(n.ba=!0,(e=n.l).g==n&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+t.length),Io(e),e.M=!0,Ae(11))):(an(n.j,n.m,t,"[Invalid Chunked Response]"),Ft(n),ar(n))}function Ff(n,e){var t=n.o,r=e.indexOf("\n",t);return-1==r?lo:(t=Number(e.substring(t,r)),isNaN(t)?wc:(r+=1)+t>e.length?lo:(e=e.slice(r,r+t),n.o=r+t,e))}function or(n){n.Y=Date.now()+n.P,Pc(n,n.P)}function Pc(n,e){if(null!=n.C)throw Error("WatchDog timer not null");n.C=rr(Ie(n.lb,n),e)}function Ti(n){n.C&&(N.clearTimeout(n.C),n.C=null)}function ar(n){0==n.l.H||n.J||tl(n.l,n)}function Ft(n){Ti(n);var e=n.M;e&&"function"==typeof e.sa&&e.sa(),n.M=null,io(n.V),mc(n.U),n.g&&(e=n.g,n.g=null,e.abort(),e.sa())}function _o(n,e){try{var t=n.l;if(0!=t.H&&(t.g==n||fo(t.i,n)))if(!n.K&&fo(t.i,n)&&3==t.H){try{var r=t.Ja.g.parse(e)}catch{r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){e:if(!t.u){if(t.g){if(!(t.g.G+3e3<n.G))break e;Vi(t),Pi(t)}yo(t),Ae(18)}}else t.Fa=i[1],0<t.Fa-t.V&&37500>i[2]&&t.G&&0==t.A&&!t.v&&(t.v=rr(Ie(t.ib,t),6e3));if(1>=Lc(t.i)&&t.oa){try{t.oa()}catch{}t.oa=void 0}}else Ot(t,11)}else if((n.K||t.g==n)&&Vi(t),!Zn(e))for(i=t.Ja.g.parse(e),e=0;e<i.length;e++){let c=i[e];if(t.V=c[0],c=c[1],2==t.H)if("c"==c[0]){t.K=c[1],t.pa=c[2];const l=c[3];null!=l&&(t.ra=l,t.l.info("VER="+t.ra));const h=c[4];null!=h&&(t.Ga=h,t.l.info("SVER="+t.Ga));const d=c[5];null!=d&&"number"==typeof d&&0<d&&(t.L=r=1.5*d,t.l.info("backChannelRequestTimeoutMs_="+r)),r=t;const f=n.g;if(f){const y=f.g?f.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(y){var s=r.i;s.g||-1==y.indexOf("spdy")&&-1==y.indexOf("quic")&&-1==y.indexOf("h2")||(s.j=s.l,s.g=new Set,s.h&&(mo(s,s.h),s.h=null))}if(r.F){const I=f.g?f.g.getResponseHeader("X-HTTP-Session-Id"):null;I&&(r.Da=I,H(r.I,r.F,I))}}t.H=3,t.h&&t.h.Ba(),t.ca&&(t.S=Date.now()-n.G,t.l.info("Handshake RTT: "+t.S+"ms"));var o=n;if((r=t).wa=il(r,r.J?r.pa:null,r.Y),o.K){Bc(r.i,o);var a=o,u=r.L;u&&a.setTimeout(u),a.C&&(Ti(a),or(a)),r.g=o}else Jc(r);0<t.j.length&&Si(t)}else"stop"!=c[0]&&"close"!=c[0]||Ot(t,7);else 3==t.H&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?Ot(t,7):xo(t):"noop"!=c[0]&&t.h&&t.h.Aa(c),t.A=0)}nr()}catch{}}function Sc(n,e){if(n.forEach&&"function"==typeof n.forEach)n.forEach(e,void 0);else if(li(n)||"string"==typeof n)Array.prototype.forEach.call(n,e,void 0);else for(var t=function Of(n){if(n.ta&&"function"==typeof n.ta)return n.ta();if(!n.Z||"function"!=typeof n.Z){if(typeof Map<"u"&&n instanceof Map)return Array.from(n.keys());if(!(typeof Set<"u"&&n instanceof Set)){if(li(n)||"string"==typeof n){var e=[];n=n.length;for(var t=0;t<n;t++)e.push(t);return e}e=[],t=0;for(const r in n)e[t++]=r;return e}}}(n),r=function Mf(n){if(n.Z&&"function"==typeof n.Z)return n.Z();if(typeof Map<"u"&&n instanceof Map||typeof Set<"u"&&n instanceof Set)return Array.from(n.values());if("string"==typeof n)return n.split("");if(li(n)){for(var e=[],t=n.length,r=0;r<t;r++)e.push(n[r]);return e}for(r in e=[],t=0,n)e[t++]=n[r];return e}(n),i=r.length,s=0;s<i;s++)e.call(void 0,r[s],t&&t[s],n)}(w=sr.prototype).setTimeout=function(n){this.P=n},w.nb=function(n){n=n.target;const e=this.M;e&&3==Qe(n)?e.l():this.Pa(n)},w.Pa=function(n){try{if(n==this.g)e:{const l=Qe(this.g);var e=this.g.Ia();if(this.g.da(),!(3>l)&&(3!=l||Us||this.g&&(this.h.h||this.g.ja()||Qc(this.g)))){this.J||4!=l||7==e||nr(),Ti(this);var t=this.g.da();this.ca=t;t:if(bc(this)){var r=Qc(this.g);n="";var i=r.length,s=4==Qe(this.g);if(!this.h.i){if(typeof TextDecoder>"u"){Ft(this),ar(this);var o="";break t}this.h.i=new N.TextDecoder}for(e=0;e<i;e++)this.h.h=!0,n+=this.h.i.decode(r[e],{stream:s&&e==i-1});r.length=0,this.h.g+=n,this.o=0,o=this.h.g}else o=this.g.ja();if(this.i=200==t,function Cf(n,e,t,r,i,s,o){n.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+t+"\n"+s+" "+o})}(this.j,this.v,this.B,this.m,this.W,l,t),this.i){if(this.aa&&!this.K){t:{if(this.g){var a,u=this.g;if((a=u.g?u.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Zn(a)){var c=a;break t}}c=null}if(!(t=c)){this.i=!1,this.s=3,Ae(12),Ft(this),ar(this);break e}an(this.j,this.m,t,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,_o(this,t)}this.S?(Rc(this,l,o),Us&&this.i&&3==l&&(fc(this.U,this.V,"tick",this.mb),this.V.start())):(an(this.j,this.m,o,null),_o(this,o)),4==l&&Ft(this),this.i&&!this.J&&(4==l?tl(this.l,this):(this.i=!1,or(this)))}else(function t0(n){const e={};n=(n.g&&2<=Qe(n)&&n.g.getAllResponseHeaders()||"").split("\r\n");for(let r=0;r<n.length;r++){if(Zn(n[r]))continue;var t=bf(n[r]);const i=t[0];if("string"!=typeof(t=t[1]))continue;t=t.trim();const s=e[i]||[];e[i]=s,s.push(t)}!function yf(n,e){for(const t in n)e.call(void 0,n[t],t,n)}(e,function(r){return r.join(", ")})})(this.g),400==t&&0<o.indexOf("Unknown SID")?(this.s=3,Ae(12)):(this.s=0,Ae(13)),Ft(this),ar(this)}}}catch{}},w.mb=function(){if(this.g){var n=Qe(this.g),e=this.g.ja();this.o<e.length&&(Ti(this),Rc(this,n,e),this.i&&4!=n&&or(this))}},w.cancel=function(){this.J=!0,Ft(this)},w.lb=function(){this.C=null;const n=Date.now();0<=n-this.Y?(function Df(n,e){n.info(function(){return"TIMEOUT: "+e})}(this.j,this.B),2!=this.L&&(nr(),Ae(17)),Ft(this),this.s=2,ar(this)):Pc(this,this.Y-n)};var Vc=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Mt(n){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,n instanceof Mt){this.h=n.h,Ei(this,n.j),this.s=n.s,this.g=n.g,vi(this,n.m),this.l=n.l;var e=n.i,t=new lr;t.i=e.i,e.g&&(t.g=new Map(e.g),t.h=e.h),Cc(this,t),this.o=n.o}else n&&(e=String(n).match(Vc))?(this.h=!1,Ei(this,e[1]||"",!0),this.s=ur(e[2]||""),this.g=ur(e[3]||"",!0),vi(this,e[4]),this.l=ur(e[5]||"",!0),Cc(this,e[6]||"",!0),this.o=ur(e[7]||"")):(this.h=!1,this.i=new lr(null,this.h))}function tt(n){return new Mt(n)}function Ei(n,e,t){n.j=t?ur(e,!0):e,n.j&&(n.j=n.j.replace(/:$/,""))}function vi(n,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);n.m=e}else n.m=null}function Cc(n,e,t){e instanceof lr?(n.i=e,function jf(n,e){e&&!n.j&&(_t(n),n.i=null,n.g.forEach(function(t,r){var i=r.toLowerCase();r!=i&&(Nc(this,r),Fc(this,i,t))},n)),n.j=e}(n.i,n.h)):(t||(e=cr(e,Gf)),n.i=new lr(e,n.h))}function H(n,e,t){n.i.set(e,t)}function wi(n){return H(n,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),n}function ur(n,e){return n?e?decodeURI(n.replace(/%25/g,"%2525")):decodeURIComponent(n):""}function cr(n,e,t){return"string"==typeof n?(n=encodeURI(n).replace(e,Bf),t&&(n=n.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n):null}function Bf(n){return"%"+((n=n.charCodeAt(0))>>4&15).toString(16)+(15&n).toString(16)}Mt.prototype.toString=function(){var n=[],e=this.j;e&&n.push(cr(e,Dc,!0),":");var t=this.g;return(t||"file"==e)&&(n.push("//"),(e=this.s)&&n.push(cr(e,Dc,!0),"@"),n.push(encodeURIComponent(String(t)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(t=this.m)&&n.push(":",String(t))),(t=this.l)&&(this.g&&"/"!=t.charAt(0)&&n.push("/"),n.push(cr(t,"/"==t.charAt(0)?Uf:qf,!0))),(t=this.i.toString())&&n.push("?",t),(t=this.o)&&n.push("#",cr(t,zf)),n.join("")};var Dc=/[#\/\?@]/g,qf=/[#\?:]/g,Uf=/[#\?]/g,Gf=/[#\?@]/g,zf=/#/g;function lr(n,e){this.h=this.g=null,this.i=n||null,this.j=!!e}function _t(n){n.g||(n.g=new Map,n.h=0,n.i&&function Lf(n,e){if(n){n=n.split("&");for(var t=0;t<n.length;t++){var r=n[t].indexOf("="),i=null;if(0<=r){var s=n[t].substring(0,r);i=n[t].substring(r+1)}else s=n[t];e(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(n.i,function(e,t){n.add(decodeURIComponent(e.replace(/\+/g," ")),t)}))}function Nc(n,e){_t(n),e=un(n,e),n.g.has(e)&&(n.i=null,n.h-=n.g.get(e).length,n.g.delete(e))}function kc(n,e){return _t(n),e=un(n,e),n.g.has(e)}function Fc(n,e,t){Nc(n,e),0<t.length&&(n.i=null,n.g.set(un(n,e),Bs(t)),n.h+=t.length)}function un(n,e){return e=String(e),n.j&&(e=e.toLowerCase()),e}(w=lr.prototype).add=function(n,e){_t(this),this.i=null,n=un(this,n);var t=this.g.get(n);return t||this.g.set(n,t=[]),t.push(e),this.h+=1,this},w.forEach=function(n,e){_t(this),this.g.forEach(function(t,r){t.forEach(function(i){n.call(e,i,r,this)},this)},this)},w.ta=function(){_t(this);const n=Array.from(this.g.values()),e=Array.from(this.g.keys()),t=[];for(let r=0;r<e.length;r++){const i=n[r];for(let s=0;s<i.length;s++)t.push(e[r])}return t},w.Z=function(n){_t(this);let e=[];if("string"==typeof n)kc(this,n)&&(e=e.concat(this.g.get(un(this,n))));else{n=Array.from(this.g.values());for(let t=0;t<n.length;t++)e=e.concat(n[t])}return e},w.set=function(n,e){return _t(this),this.i=null,kc(this,n=un(this,n))&&(this.h-=this.g.get(n).length),this.g.set(n,[e]),this.h+=1,this},w.get=function(n,e){return n&&0<(n=this.Z(n)).length?String(n[0]):e},w.toString=function(){if(this.i)return this.i;if(!this.g)return"";const n=[],e=Array.from(this.g.keys());for(var t=0;t<e.length;t++){var r=e[t];const s=encodeURIComponent(String(r)),o=this.Z(r);for(r=0;r<o.length;r++){var i=s;""!==o[r]&&(i+="="+encodeURIComponent(String(o[r]))),n.push(i)}}return this.i=n.join("&")};var Kf=class{constructor(n,e){this.g=n,this.map=e}};function Mc(n){this.l=n||$f,n=N.PerformanceNavigationTiming?0<(n=N.performance.getEntriesByType("navigation")).length&&("hq"==n[0].nextHopProtocol||"h2"==n[0].nextHopProtocol):!!(N.g&&N.g.Ka&&N.g.Ka()&&N.g.Ka().dc),this.j=n?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var $f=10;function Oc(n){return!!n.h||!!n.g&&n.g.size>=n.j}function Lc(n){return n.h?1:n.g?n.g.size:0}function fo(n,e){return n.h?n.h==e:!!n.g&&n.g.has(e)}function mo(n,e){n.g?n.g.add(e):n.h=e}function Bc(n,e){n.h&&n.h==e?n.h=null:n.g&&n.g.has(e)&&n.g.delete(e)}function qc(n){if(null!=n.h)return n.i.concat(n.h.F);if(null!=n.g&&0!==n.g.size){let e=n.i;for(const t of n.g.values())e=e.concat(t.F);return e}return Bs(n.i)}Mc.prototype.cancel=function(){if(this.i=qc(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const n of this.g.values())n.cancel();this.g.clear()}};var Qf=class{stringify(n){return N.JSON.stringify(n,void 0)}parse(n){return N.JSON.parse(n,void 0)}};function Wf(){this.g=new Qf}function Hf(n,e,t){const r=t||"";try{Sc(n,function(i,s){let o=i;Hn(i)&&(o=no(i)),e.push(r+s+"="+encodeURIComponent(o))})}catch(i){throw e.push(r+"type="+encodeURIComponent("_badmap")),i}}function Ai(n,e,t,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch{}}function hr(n){this.l=n.ec||null,this.j=n.ob||!1}function bi(n,e){he.call(this),this.F=n,this.u=e,this.m=void 0,this.readyState=go,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}le(hr,oo),hr.prototype.g=function(){return new bi(this.l,this.j)},hr.prototype.i=function(n){return function(){return n}}({}),le(bi,he);var go=0;function Uc(n){n.j.read().then(n.Xa.bind(n)).catch(n.ka.bind(n))}function dr(n){n.readyState=4,n.l=null,n.j=null,n.A=null,_r(n)}function _r(n){n.onreadystatechange&&n.onreadystatechange.call(n)}(w=bi.prototype).open=function(n,e){if(this.readyState!=go)throw this.abort(),Error("Error reopening a connection");this.C=n,this.B=e,this.readyState=1,_r(this)},w.send=function(n){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};n&&(e.body=n),(this.F||N).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))},w.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,dr(this)),this.readyState=go},w.$a=function(n){if(this.g&&(this.l=n,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=n.headers,this.readyState=2,_r(this)),this.g&&(this.readyState=3,_r(this),this.g)))if("arraybuffer"===this.responseType)n.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof N.ReadableStream<"u"&&"body"in n){if(this.j=n.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;Uc(this)}else n.text().then(this.Za.bind(this),this.ka.bind(this))},w.Xa=function(n){if(this.g){if(this.u&&n.value)this.response.push(n.value);else if(!this.u){var e=n.value?n.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!n.done}))&&(this.response=this.responseText+=e)}n.done?dr(this):_r(this),3==this.readyState&&Uc(this)}},w.Za=function(n){this.g&&(this.response=this.responseText=n,dr(this))},w.Ya=function(n){this.g&&(this.response=n,dr(this))},w.ka=function(){this.g&&dr(this)},w.setRequestHeader=function(n,e){this.v.append(n,e)},w.getResponseHeader=function(n){return this.h&&this.h.get(n.toLowerCase())||""},w.getAllResponseHeaders=function(){if(!this.h)return"";const n=[],e=this.h.entries();for(var t=e.next();!t.done;)n.push((t=t.value)[0]+": "+t[1]),t=e.next();return n.join("\r\n")},Object.defineProperty(bi.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(n){this.m=n?"include":"same-origin"}});var Yf=N.JSON.parse;function te(n){he.call(this),this.headers=new Map,this.u=n||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=Gc,this.L=this.M=!1}le(te,he);var Gc="",Xf=/^https?$/i,Jf=["POST","PUT"];function zc(n,e){n.h=!1,n.g&&(n.l=!0,n.g.abort(),n.l=!1),n.j=e,n.m=5,jc(n),Ri(n)}function jc(n){n.F||(n.F=!0,me(n,"complete"),me(n,"error"))}function Kc(n){if(n.h&&typeof Os<"u"&&(!n.C[1]||4!=Qe(n)||2!=n.da()))if(n.v&&4==Qe(n))so(n.La,0,n);else if(me(n,"readystatechange"),4==Qe(n)){n.h=!1;try{const o=n.da();e:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var t;if(!(t=e)){var r;if(r=0===o){var i=String(n.I).match(Vc)[1]||null;!i&&N.self&&N.self.location&&(i=N.self.location.protocol.slice(0,-1)),r=!Xf.test(i?i.toLowerCase():"")}t=r}if(t)me(n,"complete"),me(n,"success");else{n.m=6;try{var s=2<Qe(n)?n.g.statusText:""}catch{s=""}n.j=s+" ["+n.da()+"]",jc(n)}}finally{Ri(n)}}}function Ri(n,e){if(n.g){$c(n);const t=n.g,r=n.C[0]?()=>{}:null;n.g=null,n.C=null,e||me(n,"ready");try{t.onreadystatechange=r}catch{}}}function $c(n){n.g&&n.L&&(n.g.ontimeout=null),n.A&&(N.clearTimeout(n.A),n.A=null)}function Qe(n){return n.g?n.g.readyState:0}function Qc(n){try{if(!n.g)return null;if("response"in n.g)return n.g.response;switch(n.K){case Gc:case"text":return n.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in n.g)return n.g.mozResponseArrayBuffer}return null}catch{return null}}function Wc(n){let e="";return Qs(n,function(t,r){e+=r,e+=":",e+=t,e+="\r\n"}),e}function po(n,e,t){e:{for(r in t){var r=!1;break e}r=!0}r||(t=Wc(t),"string"==typeof n?null!=t&&encodeURIComponent(String(t)):H(n,e,t))}function fr(n,e,t){return t&&t.internalChannelParams&&t.internalChannelParams[n]||e}function Hc(n){this.Ga=0,this.j=[],this.l=new pi,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=fr("failFast",!1,n),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=fr("baseRetryDelayMs",5e3,n),this.hb=fr("retryDelaySeedMs",1e4,n),this.eb=fr("forwardChannelMaxRetries",2,n),this.xa=fr("forwardChannelRequestTimeoutMs",2e4,n),this.va=n&&n.xmlHttpFactory||void 0,this.Ha=n&&n.useFetchStreams||!1,this.L=void 0,this.J=n&&n.supportsCrossDomainXhr||!1,this.K="",this.i=new Mc(n&&n.concurrentRequestLimit),this.Ja=new Wf,this.P=n&&n.fastHandshake||!1,this.O=n&&n.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=n&&n.bc||!1,n&&n.Ea&&this.l.Ea(),n&&n.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&n&&n.detectBufferingProxy||!1,this.qa=void 0,n&&n.longPollingTimeout&&0<n.longPollingTimeout&&(this.qa=n.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}function xo(n){if(Zc(n),3==n.H){var e=n.W++,t=tt(n.I);if(H(t,"SID",n.K),H(t,"RID",e),H(t,"TYPE","terminate"),mr(n,t),(e=new sr(n,n.l,e)).L=2,e.A=wi(tt(t)),t=!1,N.navigator&&N.navigator.sendBeacon)try{t=N.navigator.sendBeacon(e.A.toString(),"")}catch{}!t&&N.Image&&((new Image).src=e.A,t=!0),t||(e.g=sl(e.l,null),e.g.ha(e.A)),e.G=Date.now(),or(e)}rl(n)}function Pi(n){n.g&&(Io(n),n.g.cancel(),n.g=null)}function Zc(n){Pi(n),n.u&&(N.clearTimeout(n.u),n.u=null),Vi(n),n.i.cancel(),n.m&&("number"==typeof n.m&&N.clearTimeout(n.m),n.m=null)}function Si(n){if(!Oc(n.i)&&!n.m){n.m=!0;var e=n.Na;Jn||hc(),er||(Jn(),er=!0),ro.add(e,n),n.C=0}}function Yc(n,e){var t;t=e?e.m:n.W++;const r=tt(n.I);H(r,"SID",n.K),H(r,"RID",t),H(r,"AID",n.V),mr(n,r),n.o&&n.s&&po(r,n.o,n.s),t=new sr(n,n.l,t,n.C+1),null===n.o&&(t.I=n.s),e&&(n.j=e.F.concat(n.j)),e=Xc(n,t,1e3),t.setTimeout(Math.round(.5*n.xa)+Math.round(.5*n.xa*Math.random())),mo(n.i,t),ho(t,r,e)}function mr(n,e){n.na&&Qs(n.na,function(t,r){H(e,r,t)}),n.h&&Sc({},function(t,r){H(e,r,t)})}function Xc(n,e,t){t=Math.min(n.j.length,t);var r=n.h?Ie(n.h.Va,n.h,n):null;e:{var i=n.j;let s=-1;for(;;){const o=["count="+t];-1==s?0<t?(s=i[0].g,o.push("ofs="+s)):s=0:o.push("ofs="+s);let a=!0;for(let u=0;u<t;u++){let c=i[u].g;const l=i[u].map;if(c-=s,0>c)s=Math.max(0,i[u].g-100),a=!1;else try{Hf(l,o,"req"+c+"_")}catch{r&&r(l)}}if(a){r=o.join("&");break e}}}return n=n.j.splice(0,t),e.F=n,r}function Jc(n){if(!n.g&&!n.u){n.ba=1;var e=n.Ma;Jn||hc(),er||(Jn(),er=!0),ro.add(e,n),n.A=0}}function yo(n){return!(n.g||n.u||3<=n.A||(n.ba++,n.u=rr(Ie(n.Ma,n),nl(n,n.A)),n.A++,0))}function Io(n){null!=n.B&&(N.clearTimeout(n.B),n.B=null)}function el(n){n.g=new sr(n,n.l,"rpc",n.ba),null===n.o&&(n.g.I=n.s),n.g.O=0;var e=tt(n.wa);H(e,"RID","rpc"),H(e,"SID",n.K),H(e,"AID",n.V),H(e,"CI",n.G?"0":"1"),!n.G&&n.qa&&H(e,"TO",n.qa),H(e,"TYPE","xmlhttp"),mr(n,e),n.o&&n.s&&po(e,n.o,n.s),n.L&&n.g.setTimeout(n.L);var t=n.g;n=n.pa,t.L=1,t.A=wi(tt(e)),t.u=null,t.S=!0,Ac(t,n)}function Vi(n){null!=n.v&&(N.clearTimeout(n.v),n.v=null)}function tl(n,e){var t=null;if(n.g==e){Vi(n),Io(n),n.g=null;var r=2}else{if(!fo(n.i,e))return;t=e.F,Bc(n.i,e),r=1}if(0!=n.H)if(e.i)if(1==r){t=e.u?e.u.length:0,e=Date.now()-e.G;var i=n.C;me(r=xi(),new yc(r,t)),Si(n)}else Jc(n);else if(3==(i=e.s)||0==i&&0<e.ca||!(1==r&&function n0(n,e){return!(Lc(n.i)>=n.i.j-(n.m?1:0)||(n.m?(n.j=e.F.concat(n.j),0):1==n.H||2==n.H||n.C>=(n.cb?0:n.eb)||(n.m=rr(Ie(n.Na,n,e),nl(n,n.C)),n.C++,0)))}(n,e)||2==r&&yo(n)))switch(t&&0<t.length&&(e=n.i,e.i=e.i.concat(t)),i){case 1:Ot(n,5);break;case 4:Ot(n,10);break;case 3:Ot(n,6);break;default:Ot(n,2)}}function nl(n,e){let t=n.ab+Math.floor(Math.random()*n.hb);return n.isActive()||(t*=2),t*e}function Ot(n,e){if(n.l.info("Error code "+e),2==e){var t=null;n.h&&(t=null);var r=Ie(n.pb,n);t||(t=new Mt("//www.google.com/images/cleardot.gif"),N.location&&"http"==N.location.protocol||Ei(t,"https"),wi(t)),function Zf(n,e){const t=new pi;if(N.Image){const r=new Image;r.onload=hi(Ai,t,r,"TestLoadImage: loaded",!0,e),r.onerror=hi(Ai,t,r,"TestLoadImage: error",!1,e),r.onabort=hi(Ai,t,r,"TestLoadImage: abort",!1,e),r.ontimeout=hi(Ai,t,r,"TestLoadImage: timeout",!1,e),N.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=n}else e(!1)}(t.toString(),r)}else Ae(2);n.H=0,n.h&&n.h.za(e),rl(n),Zc(n)}function rl(n){if(n.H=0,n.ma=[],n.h){const e=qc(n.i);(0!=e.length||0!=n.j.length)&&(Yu(n.ma,e),Yu(n.ma,n.j),n.i.i.length=0,Bs(n.j),n.j.length=0),n.h.ya()}}function il(n,e,t){var r=t instanceof Mt?tt(t):new Mt(t);if(""!=r.g)e&&(r.g=e+"."+r.g),vi(r,r.m);else{var i=N.location;r=i.protocol,e=e?e+"."+i.hostname:i.hostname,i=+i.port;var s=new Mt(null);r&&Ei(s,r),e&&(s.g=e),i&&vi(s,i),t&&(s.l=t),r=s}return e=n.Da,(t=n.F)&&e&&H(r,t,e),H(r,"VER",n.ra),mr(n,r),r}function sl(n,e,t){if(e&&!n.J)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new te(n.Ha&&!n.va?new hr({ob:t}):n.va)).Oa(n.J),e}function ol(){}function Ci(){if(on&&!(10<=Number(mf)))throw Error("Environmental error: no available transport.")}function ke(n,e){he.call(this),this.g=new Hc(e),this.l=n,this.h=e&&e.messageUrlParams||null,n=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(n?n["X-Client-Protocol"]="webchannel":n={"X-Client-Protocol":"webchannel"}),this.g.s=n,n=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(n?n["X-WebChannel-Content-Type"]=e.messageContentType:n={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(n?n["X-WebChannel-Client-Profile"]=e.Ca:n={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=n,(n=e&&e.cc)&&!Zn(n)&&(this.g.o=n),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Zn(e)&&(this.g.F=e,null!==(n=this.h)&&e in n&&e in(n=this.h)&&delete n[e]),this.j=new cn(this)}function al(n){ao.call(this),n.__headers__&&(this.headers=n.__headers__,this.statusCode=n.__status__,delete n.__headers__,delete n.__status__);var e=n.__sm__;if(e){e:{for(const t in e){n=t;break e}n=void 0}(this.i=n)&&(n=this.i,e=null!==e&&n in e?e[n]:void 0),this.data=e}else this.data=n}function ul(){uo.call(this),this.status=1}function cn(n){this.g=n}function Ge(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}function To(n,e,t){t||(t=0);var r=Array(16);if("string"==typeof e)for(var i=0;16>i;++i)r[i]=e.charCodeAt(t++)|e.charCodeAt(t++)<<8|e.charCodeAt(t++)<<16|e.charCodeAt(t++)<<24;else for(i=0;16>i;++i)r[i]=e[t++]|e[t++]<<8|e[t++]<<16|e[t++]<<24;var s=n.g[3],o=(e=n.g[0])+(s^(t=n.g[1])&((i=n.g[2])^s))+r[0]+3614090360&4294967295;o=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=t+(o<<7&4294967295|o>>>25))+((o=s+(i^e&(t^i))+r[1]+3905402710&4294967295)<<12&4294967295|o>>>20))+((o=i+(t^s&(e^t))+r[2]+606105819&4294967295)<<17&4294967295|o>>>15))+((o=t+(e^i&(s^e))+r[3]+3250441966&4294967295)<<22&4294967295|o>>>10))+((o=e+(s^t&(i^s))+r[4]+4118548399&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^e&(t^i))+r[5]+1200080426&4294967295)<<12&4294967295|o>>>20))+((o=i+(t^s&(e^t))+r[6]+2821735955&4294967295)<<17&4294967295|o>>>15))+((o=t+(e^i&(s^e))+r[7]+4249261313&4294967295)<<22&4294967295|o>>>10))+((o=e+(s^t&(i^s))+r[8]+1770035416&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^e&(t^i))+r[9]+2336552879&4294967295)<<12&4294967295|o>>>20))+((o=i+(t^s&(e^t))+r[10]+4294925233&4294967295)<<17&4294967295|o>>>15))+((o=t+(e^i&(s^e))+r[11]+2304563134&4294967295)<<22&4294967295|o>>>10))+((o=e+(s^t&(i^s))+r[12]+1804603682&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^e&(t^i))+r[13]+4254626195&4294967295)<<12&4294967295|o>>>20))+((o=i+(t^s&(e^t))+r[14]+2792965006&4294967295)<<17&4294967295|o>>>15))+((o=t+(e^i&(s^e))+r[15]+1236535329&4294967295)<<22&4294967295|o>>>10))+((o=e+(i^s&(t^i))+r[1]+4129170786&4294967295)<<5&4294967295|o>>>27))+((o=s+(t^i&(e^t))+r[6]+3225465664&4294967295)<<9&4294967295|o>>>23))+((o=i+(e^t&(s^e))+r[11]+643717713&4294967295)<<14&4294967295|o>>>18))+((o=t+(s^e&(i^s))+r[0]+3921069994&4294967295)<<20&4294967295|o>>>12))+((o=e+(i^s&(t^i))+r[5]+3593408605&4294967295)<<5&4294967295|o>>>27))+((o=s+(t^i&(e^t))+r[10]+38016083&4294967295)<<9&4294967295|o>>>23))+((o=i+(e^t&(s^e))+r[15]+3634488961&4294967295)<<14&4294967295|o>>>18))+((o=t+(s^e&(i^s))+r[4]+3889429448&4294967295)<<20&4294967295|o>>>12))+((o=e+(i^s&(t^i))+r[9]+568446438&4294967295)<<5&4294967295|o>>>27))+((o=s+(t^i&(e^t))+r[14]+3275163606&4294967295)<<9&4294967295|o>>>23))+((o=i+(e^t&(s^e))+r[3]+4107603335&4294967295)<<14&4294967295|o>>>18))+((o=t+(s^e&(i^s))+r[8]+1163531501&4294967295)<<20&4294967295|o>>>12))+((o=e+(i^s&(t^i))+r[13]+2850285829&4294967295)<<5&4294967295|o>>>27))+((o=s+(t^i&(e^t))+r[2]+4243563512&4294967295)<<9&4294967295|o>>>23))+((o=i+(e^t&(s^e))+r[7]+1735328473&4294967295)<<14&4294967295|o>>>18))+((o=t+(s^e&(i^s))+r[12]+2368359562&4294967295)<<20&4294967295|o>>>12))+((o=e+(t^i^s)+r[5]+4294588738&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^t^i)+r[8]+2272392833&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^e^t)+r[11]+1839030562&4294967295)<<16&4294967295|o>>>16))+((o=t+(i^s^e)+r[14]+4259657740&4294967295)<<23&4294967295|o>>>9))+((o=e+(t^i^s)+r[1]+2763975236&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^t^i)+r[4]+1272893353&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^e^t)+r[7]+4139469664&4294967295)<<16&4294967295|o>>>16))+((o=t+(i^s^e)+r[10]+3200236656&4294967295)<<23&4294967295|o>>>9))+((o=e+(t^i^s)+r[13]+681279174&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^t^i)+r[0]+3936430074&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^e^t)+r[3]+3572445317&4294967295)<<16&4294967295|o>>>16))+((o=t+(i^s^e)+r[6]+76029189&4294967295)<<23&4294967295|o>>>9))+((o=e+(t^i^s)+r[9]+3654602809&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^t^i)+r[12]+3873151461&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^e^t)+r[15]+530742520&4294967295)<<16&4294967295|o>>>16))+((o=t+(i^s^e)+r[2]+3299628645&4294967295)<<23&4294967295|o>>>9))+((o=e+(i^(t|~s))+r[0]+4096336452&4294967295)<<6&4294967295|o>>>26))+((o=s+(t^(e|~i))+r[7]+1126891415&4294967295)<<10&4294967295|o>>>22))+((o=i+(e^(s|~t))+r[14]+2878612391&4294967295)<<15&4294967295|o>>>17))+((o=t+(s^(i|~e))+r[5]+4237533241&4294967295)<<21&4294967295|o>>>11))+((o=e+(i^(t|~s))+r[12]+1700485571&4294967295)<<6&4294967295|o>>>26))+((o=s+(t^(e|~i))+r[3]+2399980690&4294967295)<<10&4294967295|o>>>22))+((o=i+(e^(s|~t))+r[10]+4293915773&4294967295)<<15&4294967295|o>>>17))+((o=t+(s^(i|~e))+r[1]+2240044497&4294967295)<<21&4294967295|o>>>11))+((o=e+(i^(t|~s))+r[8]+1873313359&4294967295)<<6&4294967295|o>>>26))+((o=s+(t^(e|~i))+r[15]+4264355552&4294967295)<<10&4294967295|o>>>22))+((o=i+(e^(s|~t))+r[6]+2734768916&4294967295)<<15&4294967295|o>>>17))+((o=t+(s^(i|~e))+r[13]+1309151649&4294967295)<<21&4294967295|o>>>11))+((s=(e=t+((o=e+(i^(t|~s))+r[4]+4149444226&4294967295)<<6&4294967295|o>>>26))+((o=s+(t^(e|~i))+r[11]+3174756917&4294967295)<<10&4294967295|o>>>22))^((i=s+((o=i+(e^(s|~t))+r[2]+718787259&4294967295)<<15&4294967295|o>>>17))|~e))+r[9]+3951481745&4294967295,n.g[0]=n.g[0]+e&4294967295,n.g[1]=n.g[1]+(i+(o<<21&4294967295|o>>>11))&4294967295,n.g[2]=n.g[2]+i&4294967295,n.g[3]=n.g[3]+s&4294967295}function z(n,e){this.h=e;for(var t=[],r=!0,i=n.length-1;0<=i;i--){var s=0|n[i];r&&s==e||(t[i]=s,r=!1)}this.g=t}(w=te.prototype).Oa=function(n){this.M=n},w.ha=function(n,e,t,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+n);e=e?e.toUpperCase():"GET",this.I=n,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():co.g(),this.C=function Tc(n){return n.h||(n.h=n.i())}(this.u?this.u:co),this.g.onreadystatechange=Ie(this.La,this);try{this.G=!0,this.g.open(e,String(n),!0),this.G=!1}catch(s){return void zc(this,s)}if(n=t||"",t=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)t.set(i,r[i]);else{if("function"!=typeof r.keys||"function"!=typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(const s of r.keys())t.set(s,r.get(s))}r=Array.from(t.keys()).find(s=>"content-type"==s.toLowerCase()),i=N.FormData&&n instanceof N.FormData,!(0<=Zu(Jf,e))||r||i||t.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[s,o]of t)this.g.setRequestHeader(s,o);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{$c(this),0<this.B&&((this.L=function e0(n){return on&&"number"==typeof n.timeout&&void 0!==n.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Ie(this.ua,this)):this.A=so(this.ua,this.B,this)),this.v=!0,this.g.send(n),this.v=!1}catch(s){zc(this,s)}},w.ua=function(){typeof Os<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,me(this,"timeout"),this.abort(8))},w.abort=function(n){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=n||7,me(this,"complete"),me(this,"abort"),Ri(this))},w.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Ri(this,!0)),te.$.N.call(this)},w.La=function(){this.s||(this.G||this.v||this.l?Kc(this):this.kb())},w.kb=function(){Kc(this)},w.isActive=function(){return!!this.g},w.da=function(){try{return 2<Qe(this)?this.g.status:-1}catch{return-1}},w.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}},w.Wa=function(n){if(this.g){var e=this.g.responseText;return n&&0==e.indexOf(n)&&(e=e.substring(n.length)),Yf(e)}},w.Ia=function(){return this.m},w.Sa=function(){return"string"==typeof this.j?this.j:String(this.j)},(w=Hc.prototype).ra=8,w.H=1,w.Na=function(n){if(this.m)if(this.m=null,1==this.H){if(!n){this.W=Math.floor(1e5*Math.random()),n=this.W++;const i=new sr(this,this.l,n);let s=this.s;if(this.U&&(s?(s=nc(s),ic(s,this.U)):s=this.U),null!==this.o||this.O||(i.I=s,s=null),this.P)e:{for(var e=0,t=0;t<this.j.length;t++){var r=this.j[t];if(void 0===(r="__data__"in r.map&&"string"==typeof(r=r.map.__data__)?r.length:void 0))break;if(4096<(e+=r)){e=t;break e}if(4096===e||t===this.j.length-1){e=t+1;break e}}e=1e3}else e=1e3;e=Xc(this,i,e),H(t=tt(this.I),"RID",n),H(t,"CVER",22),this.F&&H(t,"X-HTTP-Session-Id",this.F),mr(this,t),s&&(this.O?e="headers="+encodeURIComponent(String(Wc(s)))+"&"+e:this.o&&po(t,this.o,s)),mo(this.i,i),this.bb&&H(t,"TYPE","init"),this.P?(H(t,"$req",e),H(t,"SID","null"),i.aa=!0,ho(i,t,null)):ho(i,t,e),this.H=2}}else 3==this.H&&(n?Yc(this,n):0==this.j.length||Oc(this.i)||Yc(this))},w.Ma=function(){if(this.u=null,el(this),this.ca&&!(this.M||null==this.g||0>=this.S)){var n=2*this.S;this.l.info("BP detection timer enabled: "+n),this.B=rr(Ie(this.jb,this),n)}},w.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,Ae(10),Pi(this),el(this))},w.ib=function(){null!=this.v&&(this.v=null,Pi(this),yo(this),Ae(19))},w.pb=function(n){n?(this.l.info("Successfully pinged google.com"),Ae(2)):(this.l.info("Failed to ping google.com"),Ae(1))},w.isActive=function(){return!!this.h&&this.h.isActive(this)},(w=ol.prototype).Ba=function(){},w.Aa=function(){},w.za=function(){},w.ya=function(){},w.isActive=function(){return!0},w.Va=function(){},Ci.prototype.g=function(n,e){return new ke(n,e)},le(ke,he),ke.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var n=this.g,e=this.l,t=this.h||void 0;Ae(0),n.Y=e,n.na=t||{},n.G=n.aa,n.I=il(n,null,n.Y),Si(n)},ke.prototype.close=function(){xo(this.g)},ke.prototype.u=function(n){var e=this.g;if("string"==typeof n){var t={};t.__data__=n,n=t}else this.v&&((t={}).__data__=no(n),n=t);e.j.push(new Kf(e.fb++,n)),3==e.H&&Si(e)},ke.prototype.N=function(){this.g.h=null,delete this.j,xo(this.g),delete this.g,ke.$.N.call(this)},le(al,ao),le(ul,uo),le(cn,ol),cn.prototype.Ba=function(){me(this.g,"a")},cn.prototype.Aa=function(n){me(this.g,new al(n))},cn.prototype.za=function(n){me(this.g,new ul)},cn.prototype.ya=function(){me(this.g,"b")},le(Ge,function r0(){this.blockSize=-1}),Ge.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0},Ge.prototype.j=function(n,e){void 0===e&&(e=n.length);for(var t=e-this.blockSize,r=this.m,i=this.h,s=0;s<e;){if(0==i)for(;s<=t;)To(this,n,s),s+=this.blockSize;if("string"==typeof n){for(;s<e;)if(r[i++]=n.charCodeAt(s++),i==this.blockSize){To(this,r),i=0;break}}else for(;s<e;)if(r[i++]=n[s++],i==this.blockSize){To(this,r),i=0;break}}this.h=i,this.i+=e},Ge.prototype.l=function(){var n=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);n[0]=128;for(var e=1;e<n.length-8;++e)n[e]=0;var t=8*this.i;for(e=n.length-8;e<n.length;++e)n[e]=255&t,t/=256;for(this.j(n),n=Array(16),e=t=0;4>e;++e)for(var r=0;32>r;r+=8)n[t++]=this.g[e]>>>r&255;return n};var s0={};function Eo(n){return-128<=n&&128>n?function df(n,e){var t=s0;return Object.prototype.hasOwnProperty.call(t,n)?t[n]:t[n]=e(n)}(n,function(e){return new z([0|e],0>e?-1:0)}):new z([0|n],0>n?-1:0)}function We(n){if(isNaN(n)||!isFinite(n))return ln;if(0>n)return ge(We(-n));for(var e=[],t=1,r=0;n>=t;r++)e[r]=n/t|0,t*=vo;return new z(e,0)}var vo=4294967296,ln=Eo(0),wo=Eo(1),ll=Eo(16777216);function nt(n){if(0!=n.h)return!1;for(var e=0;e<n.g.length;e++)if(0!=n.g[e])return!1;return!0}function Le(n){return-1==n.h}function ge(n){for(var e=n.g.length,t=[],r=0;r<e;r++)t[r]=~n.g[r];return new z(t,~n.h).add(wo)}function Di(n,e){return n.add(ge(e))}function Ni(n,e){for(;(65535&n[e])!=n[e];)n[e+1]+=n[e]>>>16,n[e]&=65535,e++}function gr(n,e){this.g=n,this.h=e}function ki(n,e){if(nt(e))throw Error("division by zero");if(nt(n))return new gr(ln,ln);if(Le(n))return e=ki(ge(n),e),new gr(ge(e.g),ge(e.h));if(Le(e))return e=ki(n,ge(e)),new gr(ge(e.g),e.h);if(30<n.g.length){if(Le(n)||Le(e))throw Error("slowDivide_ only works with positive integers.");for(var t=wo,r=e;0>=r.X(n);)t=hl(t),r=hl(r);var i=hn(t,1),s=hn(r,1);for(r=hn(r,2),t=hn(t,2);!nt(r);){var o=s.add(r);0>=o.X(n)&&(i=i.add(t),s=o),r=hn(r,1),t=hn(t,1)}return e=Di(n,i.R(e)),new gr(i,e)}for(i=ln;0<=n.X(e);){for(t=Math.max(1,Math.floor(n.ea()/e.ea())),r=48>=(r=Math.ceil(Math.log(t)/Math.LN2))?1:Math.pow(2,r-48),o=(s=We(t)).R(e);Le(o)||0<o.X(n);)o=(s=We(t-=r)).R(e);nt(s)&&(s=wo),i=i.add(s),n=Di(n,o)}return new gr(i,n)}function hl(n){for(var e=n.g.length+1,t=[],r=0;r<e;r++)t[r]=n.D(r)<<1|n.D(r-1)>>>31;return new z(t,n.h)}function hn(n,e){var t=e>>5;e%=32;for(var r=n.g.length-t,i=[],s=0;s<r;s++)i[s]=0<e?n.D(s+t)>>>e|n.D(s+t+1)<<32-e:n.D(s+t);return new z(i,n.h)}(w=z.prototype).ea=function(){if(Le(this))return-ge(this).ea();for(var n=0,e=1,t=0;t<this.g.length;t++){var r=this.D(t);n+=(0<=r?r:vo+r)*e,e*=vo}return n},w.toString=function(n){if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if(nt(this))return"0";if(Le(this))return"-"+ge(this).toString(n);for(var e=We(Math.pow(n,6)),t=this,r="";;){var i=ki(t,e).g,s=((0<(t=Di(t,i.R(e))).g.length?t.g[0]:t.h)>>>0).toString(n);if(nt(t=i))return s+r;for(;6>s.length;)s="0"+s;r=s+r}},w.D=function(n){return 0>n?0:n<this.g.length?this.g[n]:this.h},w.X=function(n){return Le(n=Di(this,n))?-1:nt(n)?0:1},w.abs=function(){return Le(this)?ge(this):this},w.add=function(n){for(var e=Math.max(this.g.length,n.g.length),t=[],r=0,i=0;i<=e;i++){var s=r+(65535&this.D(i))+(65535&n.D(i)),o=(s>>>16)+(this.D(i)>>>16)+(n.D(i)>>>16);r=o>>>16,t[i]=(o&=65535)<<16|(s&=65535)}return new z(t,-2147483648&t[t.length-1]?-1:0)},w.R=function(n){if(nt(this)||nt(n))return ln;if(Le(this))return Le(n)?ge(this).R(ge(n)):ge(ge(this).R(n));if(Le(n))return ge(this.R(ge(n)));if(0>this.X(ll)&&0>n.X(ll))return We(this.ea()*n.ea());for(var e=this.g.length+n.g.length,t=[],r=0;r<2*e;r++)t[r]=0;for(r=0;r<this.g.length;r++)for(var i=0;i<n.g.length;i++){var s=this.D(r)>>>16,o=65535&this.D(r),a=n.D(i)>>>16,u=65535&n.D(i);t[2*r+2*i]+=o*u,Ni(t,2*r+2*i),t[2*r+2*i+1]+=s*u,Ni(t,2*r+2*i+1),t[2*r+2*i+1]+=o*a,Ni(t,2*r+2*i+1),t[2*r+2*i+2]+=s*a,Ni(t,2*r+2*i+2)}for(r=0;r<e;r++)t[r]=t[2*r+1]<<16|t[2*r];for(r=e;r<2*e;r++)t[r]=0;return new z(t,0)},w.gb=function(n){return ki(this,n).h},w.and=function(n){for(var e=Math.max(this.g.length,n.g.length),t=[],r=0;r<e;r++)t[r]=this.D(r)&n.D(r);return new z(t,this.h&n.h)},w.or=function(n){for(var e=Math.max(this.g.length,n.g.length),t=[],r=0;r<e;r++)t[r]=this.D(r)|n.D(r);return new z(t,this.h|n.h)},w.xor=function(n){for(var e=Math.max(this.g.length,n.g.length),t=[],r=0;r<e;r++)t[r]=this.D(r)^n.D(r);return new z(t,this.h^n.h)},Ci.prototype.createWebChannel=Ci.prototype.g,ke.prototype.send=ke.prototype.u,ke.prototype.open=ke.prototype.m,ke.prototype.close=ke.prototype.close,yi.NO_ERROR=0,yi.TIMEOUT=8,yi.HTTP_ERROR=6,Ic.COMPLETE="complete",Ec.EventType=ir,ir.OPEN="a",ir.CLOSE="b",ir.ERROR="c",ir.MESSAGE="d",he.prototype.listen=he.prototype.O,te.prototype.listenOnce=te.prototype.P,te.prototype.getLastError=te.prototype.Sa,te.prototype.getLastErrorCode=te.prototype.Ia,te.prototype.getStatus=te.prototype.da,te.prototype.getResponseJson=te.prototype.Wa,te.prototype.getResponseText=te.prototype.ja,te.prototype.send=te.prototype.ha,te.prototype.setWithCredentials=te.prototype.Oa,Ge.prototype.digest=Ge.prototype.l,Ge.prototype.reset=Ge.prototype.reset,Ge.prototype.update=Ge.prototype.j,z.prototype.add=z.prototype.add,z.prototype.multiply=z.prototype.R,z.prototype.modulo=z.prototype.gb,z.prototype.compare=z.prototype.X,z.prototype.toNumber=z.prototype.ea,z.prototype.toString=z.prototype.toString,z.prototype.getBits=z.prototype.D,z.fromNumber=We,z.fromString=function cl(n,e){if(0==n.length)throw Error("number format error: empty string");if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if("-"==n.charAt(0))return ge(cl(n.substring(1),e));if(0<=n.indexOf("-"))throw Error('number format error: interior "-" character');for(var t=We(Math.pow(e,8)),r=ln,i=0;i<n.length;i+=8){var s=Math.min(8,n.length-i),o=parseInt(n.substring(i,i+s),e);8>s?(s=We(Math.pow(e,s)),r=r.R(s).add(We(o))):r=(r=r.R(t)).add(We(o))}return r};var o0=Ue.createWebChannelTransport=function(){return new Ci},a0=Ue.getStatEventTarget=function(){return xi()},Ao=Ue.ErrorCode=yi,u0=Ue.EventType=Ic,c0=Ue.Event=kt,dl=Ue.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},Fi=(Ue.FetchXmlHttpFactory=hr,Ue.WebChannel=Ec),l0=Ue.XhrIo=te,h0=Ue.Md5=Ge,dn=Ue.Integer=z;const _l="@firebase/firestore";class de{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}de.UNAUTHENTICATED=new de(null),de.GOOGLE_CREDENTIALS=new de("google-credentials-uid"),de.FIRST_PARTY=new de("first-party-uid"),de.MOCK_USER=new de("mock-user");let _n="10.7.0";const ft=new Ke.Yd("@firebase/firestore");function fn(){return ft.logLevel}function x(n,...e){if(ft.logLevel<=Ke.in.DEBUG){const t=e.map(bo);ft.debug(`Firestore (${_n}): ${n}`,...t)}}function ie(n,...e){if(ft.logLevel<=Ke.in.ERROR){const t=e.map(bo);ft.error(`Firestore (${_n}): ${n}`,...t)}}function Se(n,...e){if(ft.logLevel<=Ke.in.WARN){const t=e.map(bo);ft.warn(`Firestore (${_n}): ${n}`,...t)}}function bo(n){if("string"==typeof n)return n;try{return JSON.stringify(n)}catch{return n}}function A(n="Unexpected state"){const e=`FIRESTORE (${_n}) INTERNAL ASSERTION FAILED: `+n;throw ie(e),new Error(e)}function R(n,e){n||A()}function E(n,e){return n}const m={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class p extends $.ZR{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class ue{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class fl{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class f0{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(de.UNAUTHENTICATED))}shutdown(){}}class m0{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class g0{constructor(e){this.t=e,this.currentUser=de.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){var r=this;let i=this.i;const s=c=>this.i!==i?(i=this.i,t(c)):Promise.resolve();let o=new ue;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new ue,e.enqueueRetryable(()=>s(this.currentUser))};const a=()=>{const c=o;e.enqueueRetryable((0,g.Z)(function*(){yield c.promise,yield s(r.currentUser)}))},u=c=>{x("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.auth.addAuthTokenListener(this.o),a()};this.t.onInit(c=>u(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?u(c):(x("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new ue)}},0),a()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(x("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(R("string"==typeof r.accessToken),new fl(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return R(null===e||"string"==typeof e),new de(e)}}class p0{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=de.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class x0{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new p0(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(de.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class ml{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class y0{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){const r=s=>{null!=s.error&&x("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.R;return this.R=s.token,x("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const i=s=>{x("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?i(s):x("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(R("string"==typeof t.token),this.R=t.token,new ml(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function I0(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}class gl{static newId(){const t=62*Math.floor(256/62);let r="";for(;r.length<20;){const i=I0(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<t&&(r+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(i[s]%62))}return r}}function D(n,e){return n<e?-1:n>e?1:0}function mn(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}function pl(n){return n+"\0"}class J{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new p(m.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new p(m.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new p(m.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new p(m.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return J.fromMillis(Date.now())}static fromDate(e){return J.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new J(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?D(this.nanoseconds,e.nanoseconds):D(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class P{constructor(e){this.timestamp=e}static fromTimestamp(e){return new P(e)}static min(){return new P(new J(0,0))}static max(){return new P(new J(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class pr{constructor(e,t,r){void 0===t?t=0:t>e.length&&A(),void 0===r?r=e.length-t:r>e.length-t&&A(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return 0===pr.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof pr?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return this.construct(this.segments,this.offset+(e=void 0===e?1:e),this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let i=0;i<r;i++){const s=e.get(i),o=t.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class B extends pr{construct(e,t,r){return new B(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new p(m.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new B(t)}static emptyPath(){return new B([])}}const T0=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Z extends pr{construct(e,t,r){return new Z(e,t,r)}static isValidIdentifier(e){return T0.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Z.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new Z(["__name__"])}static fromServerFormat(e){const t=[];let r="",i=0;const s=()=>{if(0===r.length)throw new p(m.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let o=!1;for(;i<e.length;){const a=e[i];if("\\"===a){if(i+1===e.length)throw new p(m.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new p(m.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,i+=2}else"`"===a?(o=!o,i++):"."!==a||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new p(m.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Z(t)}static emptyPath(){return new Z([])}}class v{constructor(e){this.path=e}static fromPath(e){return new v(B.fromString(e))}static fromName(e){return new v(B.fromString(e).popFirst(5))}static empty(){return new v(B.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===B.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return B.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new v(new B(e.slice()))}}class gn{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}}function Ro(n){return n.fields.find(e=>2===e.kind)}function Lt(n){return n.fields.filter(e=>2!==e.kind)}gn.UNKNOWN_ID=-1;class Bt{constructor(e,t){this.fieldPath=e,this.kind=t}}class pn{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new pn(0,Fe.min())}}function xl(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=P.fromTimestamp(1e9===r?new J(t+1,0):new J(t,r));return new Fe(i,v.empty(),e)}function yl(n){return new Fe(n.readTime,n.key,-1)}class Fe{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new Fe(P.min(),v.empty(),-1)}static max(){return new Fe(P.max(),v.empty(),-1)}}function Po(n,e){let t=n.readTime.compareTo(e.readTime);return 0!==t?t:(t=v.comparator(n.documentKey,e.documentKey),0!==t?t:D(n.largestBatchId,e.largestBatchId))}const Il="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Tl{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}function mt(n){return So.apply(this,arguments)}function So(){return So=(0,g.Z)(function*(n){if(n.code!==m.FAILED_PRECONDITION||n.message!==Il)throw n;x("LocalStore","Unexpectedly lost primary lease")}),So.apply(this,arguments)}class _{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&A(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new _((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof _?t:_.resolve(t)}catch(t){return _.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):_.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):_.reject(t)}static resolve(e){return new _((t,r)=>{t(e)})}static reject(e){return new _((t,r)=>{r(e)})}static waitFor(e){return new _((t,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&t()},u=>r(u))}),o=!0,s===i&&t()})}static or(e){let t=_.resolve(!1);for(const r of e)t=t.next(i=>i?_.resolve(i):r());return t}static forEach(e,t){const r=[];return e.forEach((i,s)=>{r.push(t.call(this,i,s))}),this.waitFor(r)}static mapArray(e,t){return new _((r,i)=>{const s=e.length,o=new Array(s);let a=0;for(let u=0;u<s;u++){const c=u;t(e[c]).next(l=>{o[c]=l,++a,a===s&&r(o)},l=>i(l))}})}static doWhile(e,t){return new _((r,i)=>{const s=()=>{!0===e()?t().next(()=>{s()},i):r()};s()})}}class Mi{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.V=new ue,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{t.error?this.V.reject(new xr(e,t.error)):this.V.resolve()},this.transaction.onerror=r=>{const i=Vo(r.target.error);this.V.reject(new xr(e,i))}}static open(e,t,r,i){try{return new Mi(t,e.transaction(i,r))}catch(s){throw new xr(t,s)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(x("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||"function"!=typeof e.commit||e.commit()}store(e){const t=this.transaction.objectStore(e);return new A0(t)}}class ze{constructor(e,t,r){this.name=e,this.version=t,this.p=r,12.2===ze.S((0,$.z$)())&&ie("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return x("SimpleDb","Removing database:",e),qt(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!(0,$.hl)())return!1;if(ze.C())return!0;const e=(0,$.z$)(),t=ze.S(e),r=0<t&&t<10,i=ze.v(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static C(){var e;return typeof process<"u"&&"YES"===(null===(e=process.env)||void 0===e?void 0:e.F)}static M(e,t){return e.store(t)}static S(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}static v(e){const t=e.match(/Android ([\d.]+)/i),r=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(r)}O(e){var t=this;return(0,g.Z)(function*(){return t.db||(x("SimpleDb","Opening database:",t.name),t.db=yield new Promise((r,i)=>{const s=indexedDB.open(t.name,t.version);s.onsuccess=o=>{r(o.target.result)},s.onblocked=()=>{i(new xr(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=o=>{const a=o.target.error;i("VersionError"===a.name?new p(m.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh."):"InvalidStateError"===a.name?new p(m.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+a):new xr(e,a))},s.onupgradeneeded=o=>{x("SimpleDb",'Database "'+t.name+'" requires upgrade from version:',o.oldVersion),t.p.N(o.target.result,s.transaction,o.oldVersion,t.version).next(()=>{x("SimpleDb","Database upgrade to version "+t.version+" complete")})}})),t.B&&(t.db.onversionchange=r=>t.B(r)),t.db})()}L(e){this.B=e,this.db&&(this.db.onversionchange=t=>e(t))}runTransaction(e,t,r,i){var s=this;return(0,g.Z)(function*(){const o="readonly"===t;let a=0;for(;;){++a;try{s.db=yield s.O(e);const u=Mi.open(s.db,e,o?"readonly":"readwrite",r),c=i(u).next(l=>(u.g(),l)).catch(l=>(u.abort(l),_.reject(l))).toPromise();return c.catch(()=>{}),yield u.m,c}catch(u){const c=u,l="FirebaseError"!==c.name&&a<3;if(x("SimpleDb","Transaction failed with error:",c.message,"Retrying:",l),s.close(),!l)return Promise.reject(c)}}})()}close(){this.db&&this.db.close(),this.db=void 0}}class w0{constructor(e){this.k=e,this.q=!1,this.K=null}get isDone(){return this.q}get $(){return this.K}set cursor(e){this.k=e}done(){this.q=!0}U(e){this.K=e}delete(){return qt(this.k.delete())}}class xr extends p{constructor(e,t){super(m.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function gt(n){return"IndexedDbTransactionError"===n.name}class A0{constructor(e){this.store=e}put(e,t){let r;return void 0!==t?(x("SimpleDb","PUT",this.store.name,e,t),r=this.store.put(t,e)):(x("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),qt(r)}add(e){return x("SimpleDb","ADD",this.store.name,e,e),qt(this.store.add(e))}get(e){return qt(this.store.get(e)).next(t=>(void 0===t&&(t=null),x("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return x("SimpleDb","DELETE",this.store.name,e),qt(this.store.delete(e))}count(){return x("SimpleDb","COUNT",this.store.name),qt(this.store.count())}W(e,t){const r=this.options(e,t);if(r.index||"function"!=typeof this.store.getAll){const i=this.cursor(r),s=[];return this.G(i,(o,a)=>{s.push(a)}).next(()=>s)}{const i=this.store.getAll(r.range);return new _((s,o)=>{i.onerror=a=>{o(a.target.error)},i.onsuccess=a=>{s(a.target.result)}})}}j(e,t){const r=this.store.getAll(e,null===t?void 0:t);return new _((i,s)=>{r.onerror=o=>{s(o.target.error)},r.onsuccess=o=>{i(o.target.result)}})}H(e,t){x("SimpleDb","DELETE ALL",this.store.name);const r=this.options(e,t);r.J=!1;const i=this.cursor(r);return this.G(i,(s,o,a)=>a.delete())}Y(e,t){let r;t?r=e:(r={},t=e);const i=this.cursor(r);return this.G(i,t)}Z(e){const t=this.cursor({});return new _((r,i)=>{t.onerror=s=>{const o=Vo(s.target.error);i(o)},t.onsuccess=s=>{const o=s.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}G(e,t){const r=[];return new _((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void i();const u=new w0(a),c=t(a.primaryKey,a.value,u);if(c instanceof _){const l=c.catch(h=>(u.done(),_.reject(h)));r.push(l)}u.isDone?i():null===u.$?a.continue():a.continue(u.$)}}).next(()=>_.waitFor(r))}options(e,t){let r;return void 0!==e&&("string"==typeof e?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const r=this.store.index(e.index);return e.J?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function qt(n){return new _((e,t)=>{n.onsuccess=r=>{e(r.target.result)},n.onerror=r=>{const i=Vo(r.target.error);t(i)}})}let El=!1;function Vo(n){const e=ze.S((0,$.z$)());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const r=new p("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return El||(El=!0,setTimeout(()=>{throw r},0)),r}}return n}class b0{constructor(e,t){this.asyncQueue=e,this.X=t,this.task=null}start(){this.ee(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return null!==this.task}ee(e){var t=this;x("IndexBackiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(0,g.Z)(function*(){t.task=null;try{x("IndexBackiller",`Documents written: ${yield t.X.te()}`)}catch(r){gt(r)?x("IndexBackiller","Ignoring IndexedDB error during index backfill: ",r):yield mt(r)}yield t.ee(6e4)}))}}class R0{constructor(e,t){this.localStore=e,this.persistence=t}te(e=50){var t=this;return(0,g.Z)(function*(){return t.persistence.runTransaction("Backfill Indexes","readwrite-primary",r=>t.ne(r,e))})()}ne(e,t){const r=new Set;let i=t,s=!0;return _.doWhile(()=>!0===s&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(null!==o&&!r.has(o))return x("IndexBackiller",`Processing collection: ${o}`),this.re(e,o,i).next(a=>{i-=a,r.add(o)});s=!1})).next(()=>t-i)}re(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(i=>this.localStore.localDocuments.getNextDocuments(e,t,i,r).next(s=>{const o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.ie(i,s)).next(a=>(x("IndexBackiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,t,a))).next(()=>o.size)}))}ie(e,t){let r=e;return t.changes.forEach((i,s)=>{const o=yl(s);Po(o,r)>0&&(r=o)}),new Fe(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}}let Me=(()=>{class n{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=i=>this.se(i),this.oe=i=>r.writeSequenceNumber(i))}se(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.oe&&this.oe(t),t}}return n._e=-1,n})();function yr(n){return null==n}function Ir(n){return 0===n&&1/n==-1/0}function vl(n){return"number"==typeof n&&Number.isInteger(n)&&!Ir(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}function Ee(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=wl(e)),e=P0(n.get(t),e);return wl(e)}function P0(n,e){let t=e;const r=n.length;for(let i=0;i<r;i++){const s=n.charAt(i);switch(s){case"\0":t+="\x01\x10";break;case"\x01":t+="\x01\x11";break;default:t+=s}}return t}function wl(n){return n+"\x01\x01"}function He(n){const e=n.length;if(R(e>=2),2===e)return R("\x01"===n.charAt(0)&&"\x01"===n.charAt(1)),B.emptyPath();const t=e-2,r=[];let i="";for(let s=0;s<e;){const o=n.indexOf("\x01",s);switch((o<0||o>t)&&A(),n.charAt(o+1)){case"\x01":const a=n.substring(s,o);let u;0===i.length?u=a:(i+=a,u=i,i=""),r.push(u);break;case"\x10":i+=n.substring(s,o),i+="\0";break;case"\x11":i+=n.substring(s,o+1);break;default:A()}s=o+2}return new B(r)}const Al=["userId","batchId"];function Oi(n,e){return[n,Ee(e)]}function bl(n,e,t){return[n,Ee(e),t]}const S0={},V0=["prefixPath","collectionGroup","readTime","documentId"],C0=["prefixPath","collectionGroup","documentId"],D0=["collectionGroup","readTime","prefixPath","documentId"],N0=["canonicalId","targetId"],k0=["targetId","path"],F0=["path","targetId"],M0=["collectionId","parent"],O0=["indexId","uid"],L0=["uid","sequenceNumber"],B0=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],q0=["indexId","uid","orderedDocumentKey"],U0=["userId","collectionPath","documentId"],G0=["userId","collectionPath","largestBatchId"],z0=["userId","collectionGroup","largestBatchId"],Rl=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],j0=[...Rl,"documentOverlays"],Pl=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],Sl=Pl,K0=[...Sl,"indexConfiguration","indexState","indexEntries"];class Co extends Tl{constructor(e,t){super(),this.ae=e,this.currentSequenceNumber=t}}function _e(n,e){const t=E(n);return ze.M(t.ae,e)}function Vl(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function pt(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function Cl(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class Q{constructor(e,t){this.comparator=e,this.root=t||pe.EMPTY}insert(e,t){return new Q(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,pe.BLACK,null,null))}remove(e){return new Q(this.comparator,this.root.remove(e,this.comparator).copy(null,null,pe.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(0===r)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(0===i)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){const e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Li(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Li(this.root,e,this.comparator,!1)}getReverseIterator(){return new Li(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Li(this.root,e,this.comparator,!0)}}class Li{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(0===s){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class pe{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=null!=r?r:pe.RED,this.left=null!=i?i:pe.EMPTY,this.right=null!=s?s:pe.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,s){return new pe(null!=e?e:this.key,null!=t?t:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=s?s:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,r),null):0===s?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return pe.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===t(e,i.key)){if(i.right.isEmpty())return pe.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,pe.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,pe.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw A();const e=this.left.check();if(e!==this.right.check())throw A();return e+(this.isRed()?0:1)}}pe.EMPTY=null,pe.RED=!0,pe.BLACK=!1,pe.EMPTY=new class{constructor(){this.size=0}get key(){throw A()}get value(){throw A()}get color(){throw A()}get left(){throw A()}get right(){throw A()}copy(e,t,r,i,s){return this}insert(e,t,r){return new pe(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class K{constructor(e){this.comparator=e,this.data=new Q(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Dl(this.data.getIterator())}getIteratorFrom(e){return new Dl(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof K)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=r.getNext().key;if(0!==this.comparator(i,s))return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new K(this.comparator);return t.data=e,t}}class Dl{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function xn(n){return n.hasNext()?n.getNext():void 0}class Ve{constructor(e){this.fields=e,e.sort(Z.comparator)}static empty(){return new Ve([])}unionWith(e){let t=new K(Z.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new Ve(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return mn(this.fields,e.fields,(t,r)=>t.isEqual(r))}}class Nl extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class ce{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new Nl("Invalid base64 string: "+s):s}}(e);return new ce(t)}static fromUint8Array(e){const t=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new ce(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return btoa(this.binaryString)}toUint8Array(){return function(t){const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return D(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}ce.EMPTY_BYTE_STRING=new ce("");const Q0=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function xt(n){if(R(!!n),"string"==typeof n){let e=0;const t=Q0.exec(n);if(R(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:ne(n.seconds),nanos:ne(n.nanos)}}function ne(n){return"number"==typeof n?n:"string"==typeof n?Number(n):0}function rt(n){return"string"==typeof n?ce.fromBase64String(n):ce.fromUint8Array(n)}function Bi(n){var e,t;return"server_timestamp"===(null===(t=((null===(e=null==n?void 0:n.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function qi(n){const e=n.mapValue.fields.__previous_value__;return Bi(e)?qi(e):e}function Tr(n){const e=xt(n.mapValue.fields.__local_write_time__.timestampValue);return new J(e.seconds,e.nanos)}class W0{constructor(e,t,r,i,s,o,a,u,c){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=u,this.useFetchStreams=c}}class yt{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new yt("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof yt&&e.projectId===this.projectId&&e.database===this.database}}const It={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},Ui={nullValue:"NULL_VALUE"};function Tt(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Bi(n)?4:Ol(n)?9007199254740991:10:A()}function Ze(n,e){if(n===e)return!0;const t=Tt(n);if(t!==Tt(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Tr(n).isEqual(Tr(e));case 3:return function(i,s){if("string"==typeof i.timestampValue&&"string"==typeof s.timestampValue&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const o=xt(i.timestampValue),a=xt(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return s=e,rt(n.bytesValue).isEqual(rt(s.bytesValue));case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,s){return ne(i.geoPointValue.latitude)===ne(s.geoPointValue.latitude)&&ne(i.geoPointValue.longitude)===ne(s.geoPointValue.longitude)}(n,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return ne(i.integerValue)===ne(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const o=ne(i.doubleValue),a=ne(s.doubleValue);return o===a?Ir(o)===Ir(a):isNaN(o)&&isNaN(a)}return!1}(n,e);case 9:return mn(n.arrayValue.values||[],e.arrayValue.values||[],Ze);case 10:return function(i,s){const o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(Vl(o)!==Vl(a))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(void 0===a[u]||!Ze(o[u],a[u])))return!1;return!0}(n,e);default:return A()}var s}function Er(n,e){return void 0!==(n.values||[]).find(t=>Ze(t,e))}function Et(n,e){if(n===e)return 0;const t=Tt(n),r=Tt(e);if(t!==r)return D(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return D(n.booleanValue,e.booleanValue);case 2:return function(s,o){const a=ne(s.integerValue||s.doubleValue),u=ne(o.integerValue||o.doubleValue);return a<u?-1:a>u?1:a===u?0:isNaN(a)?isNaN(u)?0:-1:1}(n,e);case 3:return kl(n.timestampValue,e.timestampValue);case 4:return kl(Tr(n),Tr(e));case 5:return D(n.stringValue,e.stringValue);case 6:return function(s,o){const a=rt(s),u=rt(o);return a.compareTo(u)}(n.bytesValue,e.bytesValue);case 7:return function(s,o){const a=s.split("/"),u=o.split("/");for(let c=0;c<a.length&&c<u.length;c++){const l=D(a[c],u[c]);if(0!==l)return l}return D(a.length,u.length)}(n.referenceValue,e.referenceValue);case 8:return function(s,o){const a=D(ne(s.latitude),ne(o.latitude));return 0!==a?a:D(ne(s.longitude),ne(o.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return function(s,o){const a=s.values||[],u=o.values||[];for(let c=0;c<a.length&&c<u.length;++c){const l=Et(a[c],u[c]);if(l)return l}return D(a.length,u.length)}(n.arrayValue,e.arrayValue);case 10:return function(s,o){if(s===It.mapValue&&o===It.mapValue)return 0;if(s===It.mapValue)return 1;if(o===It.mapValue)return-1;const a=s.fields||{},u=Object.keys(a),c=o.fields||{},l=Object.keys(c);u.sort(),l.sort();for(let h=0;h<u.length&&h<l.length;++h){const d=D(u[h],l[h]);if(0!==d)return d;const f=Et(a[u[h]],c[l[h]]);if(0!==f)return f}return D(u.length,l.length)}(n.mapValue,e.mapValue);default:throw A()}}function kl(n,e){if("string"==typeof n&&"string"==typeof e&&n.length===e.length)return D(n,e);const t=xt(n),r=xt(e),i=D(t.seconds,r.seconds);return 0!==i?i:D(t.nanos,r.nanos)}function yn(n){return Do(n)}function Do(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){const r=xt(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?rt(n.bytesValue).toBase64():"referenceValue"in n?v.fromName(n.referenceValue).toString():"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",i=!0;for(const s of t.values||[])i?i=!1:r+=",",r+=Do(s);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){const r=Object.keys(t.fields||{}).sort();let i="{",s=!0;for(const o of r)s?s=!1:i+=",",i+=`${o}:${Do(t.fields[o])}`;return i+"}"}(n.mapValue):A()}function Ut(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function No(n){return!!n&&"integerValue"in n}function vr(n){return!!n&&"arrayValue"in n}function Fl(n){return!!n&&"nullValue"in n}function Ml(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function zi(n){return!!n&&"mapValue"in n}function wr(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&"object"==typeof n.timestampValue)return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return pt(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=wr(r)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=wr(n.arrayValue.values[t]);return e}return Object.assign({},n)}function Ol(n){return"__max__"===(((n.mapValue||{}).fields||{}).__type__||{}).stringValue}function H0(n){return"nullValue"in n?Ui:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?Ut(yt.empty(),v.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?{mapValue:{}}:A()}function Z0(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?Ut(yt.empty(),v.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?{mapValue:{}}:"mapValue"in n?It:A()}function Ll(n,e){const t=Et(n.value,e.value);return 0!==t?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function Bl(n,e){const t=Et(n.value,e.value);return 0!==t?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}class xe{constructor(e){this.value=e}static empty(){return new xe({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!zi(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=wr(t)}setAll(e){let t=Z.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!t.isImmediateParentOf(a)){const u=this.getFieldsMap(t);this.applyChanges(u,r,i),r={},i=[],t=a.popLast()}o?r[a.lastSegment()]=wr(o):i.push(a.lastSegment())});const s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){const t=this.field(e.popLast());zi(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Ze(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];zi(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){pt(t,(i,s)=>e[i]=s);for(const i of r)delete e[i]}clone(){return new xe(wr(this.value))}}function ql(n){const e=[];return pt(n.fields,(t,r)=>{const i=new Z([t]);if(zi(r)){const s=ql(r.mapValue).fields;if(0===s.length)e.push(i);else for(const o of s)e.push(i.child(o))}else e.push(i)}),new Ve(e)}class Y{constructor(e,t,r,i,s,o,a){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new Y(e,0,P.min(),P.min(),P.min(),xe.empty(),0)}static newFoundDocument(e,t,r,i){return new Y(e,1,t,P.min(),r,i,0)}static newNoDocument(e,t){return new Y(e,2,t,P.min(),P.min(),xe.empty(),0)}static newUnknownDocument(e,t){return new Y(e,3,t,P.min(),P.min(),xe.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(P.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=xe.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=xe.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=P.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof Y&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Y(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class vt{constructor(e,t){this.position=e,this.inclusive=t}}function Ul(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){const s=e[i],o=n.position[i];if(r=s.field.isKeyField()?v.comparator(v.fromName(o.referenceValue),t.key):Et(o,t.data.field(s.field)),"desc"===s.dir&&(r*=-1),0!==r)break}return r}function Gl(n,e){if(null===n)return null===e;if(null===e||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Ze(n.position[t],e.position[t]))return!1;return!0}class Ar{constructor(e,t="asc"){this.field=e,this.dir=t}}function Y0(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class zl{}class O extends zl{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,r):new X0(e,t,r):"array-contains"===t?new tm(e,r):"in"===t?new Hl(e,r):"not-in"===t?new nm(e,r):"array-contains-any"===t?new rm(e,r):new O(e,t,r)}static createKeyFieldInFilter(e,t,r){return"in"===t?new J0(e,r):new em(e,r)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison(Et(t,this.value)):null!==t&&Tt(this.value)===Tt(t)&&this.matchesComparison(Et(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return A()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class j extends zl{constructor(e,t){super(),this.filters=e,this.op=t,this.ue=null}static create(e,t){return new j(e,t)}matches(e){return In(this)?void 0===this.filters.find(t=>!t.matches(e)):void 0!==this.filters.find(t=>t.matches(e))}getFlattenedFilters(){return null!==this.ue||(this.ue=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ue}getFilters(){return Object.assign([],this.filters)}}function In(n){return"and"===n.op}function ko(n){return"or"===n.op}function Fo(n){return jl(n)&&In(n)}function jl(n){for(const e of n.filters)if(e instanceof j)return!1;return!0}function Mo(n){if(n instanceof O)return n.field.canonicalString()+n.op.toString()+yn(n.value);if(Fo(n))return n.filters.map(e=>Mo(e)).join(",");{const e=n.filters.map(t=>Mo(t)).join(",");return`${n.op}(${e})`}}function Kl(n,e){return n instanceof O?(r=n,(i=e)instanceof O&&r.op===i.op&&r.field.isEqual(i.field)&&Ze(r.value,i.value)):n instanceof j?function(r,i){return i instanceof j&&r.op===i.op&&r.filters.length===i.filters.length&&r.filters.reduce((s,o,a)=>s&&Kl(o,i.filters[a]),!0)}(n,e):void A();var r,i}function $l(n,e){const t=n.filters.concat(e);return j.create(t,n.op)}function Ql(n){return n instanceof O?`${(t=n).field.canonicalString()} ${t.op} ${yn(t.value)}`:n instanceof j?function(t){return t.op.toString()+" {"+t.getFilters().map(Ql).join(" ,")+"}"}(n):"Filter";var t}class X0 extends O{constructor(e,t,r){super(e,t,r),this.key=v.fromName(r.referenceValue)}matches(e){const t=v.comparator(e.key,this.key);return this.matchesComparison(t)}}class J0 extends O{constructor(e,t){super(e,"in",t),this.keys=Wl(0,t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class em extends O{constructor(e,t){super(e,"not-in",t),this.keys=Wl(0,t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function Wl(n,e){var t;return((null===(t=e.arrayValue)||void 0===t?void 0:t.values)||[]).map(r=>v.fromName(r.referenceValue))}class tm extends O{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return vr(t)&&Er(t.arrayValue,this.value)}}class Hl extends O{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&Er(this.value.arrayValue,t)}}class nm extends O{constructor(e,t){super(e,"not-in",t)}matches(e){if(Er(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!Er(this.value.arrayValue,t)}}class rm extends O{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!vr(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>Er(this.value.arrayValue,r))}}class im{constructor(e,t=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.ce=null}}function Oo(n,e=null,t=[],r=[],i=null,s=null,o=null){return new im(n,e,t,r,i,s,o)}function Gt(n){const e=E(n);if(null===e.ce){let t=e.path.canonicalString();null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>Mo(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>{return(s=r).field.canonicalString()+s.dir;var s}).join(","),yr(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>yn(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>yn(r)).join(",")),e.ce=t}return e.ce}function br(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!Y0(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!Kl(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Gl(n.startAt,e.startAt)&&Gl(n.endAt,e.endAt)}function ji(n){return v.isDocumentKey(n.path)&&null===n.collectionGroup&&0===n.filters.length}function Ki(n,e){return n.filters.filter(t=>t instanceof O&&t.field.isEqual(e))}function Zl(n,e,t){let r=Ui,i=!0;for(const s of Ki(n,e)){let o=Ui,a=!0;switch(s.op){case"<":case"<=":o=H0(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=Ui}Ll({value:r,inclusive:i},{value:o,inclusive:a})<0&&(r=o,i=a)}if(null!==t)for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const o=t.position[s];Ll({value:r,inclusive:i},{value:o,inclusive:t.inclusive})<0&&(r=o,i=t.inclusive);break}return{value:r,inclusive:i}}function Yl(n,e,t){let r=It,i=!0;for(const s of Ki(n,e)){let o=It,a=!0;switch(s.op){case">=":case">":o=Z0(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=It}Bl({value:r,inclusive:i},{value:o,inclusive:a})>0&&(r=o,i=a)}if(null!==t)for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const o=t.position[s];Bl({value:r,inclusive:i},{value:o,inclusive:t.inclusive})>0&&(r=o,i=t.inclusive);break}return{value:r,inclusive:i}}class it{constructor(e,t=null,r=[],i=[],s=null,o="F",a=null,u=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=u,this.le=null,this.he=null,this.Pe=null}}function Xl(n,e,t,r,i,s,o,a){return new it(n,e,t,r,i,s,o,a)}function Tn(n){return new it(n)}function Jl(n){return 0===n.filters.length&&null===n.limit&&null==n.startAt&&null==n.endAt&&(0===n.explicitOrderBy.length||1===n.explicitOrderBy.length&&n.explicitOrderBy[0].field.isKeyField())}function Lo(n){return null!==n.collectionGroup}function En(n){const e=E(n);if(null===e.le){e.le=[];const t=new Set;for(const s of e.explicitOrderBy)e.le.push(s),t.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new K(Z.comparator);return o.filters.forEach(u=>{u.getFlattenedFilters().forEach(c=>{c.isInequality()&&(a=a.add(c.field))})}),a})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.le.push(new Ar(s,r))}),t.has(Z.keyField().canonicalString())||e.le.push(new Ar(Z.keyField(),r))}return e.le}function be(n){const e=E(n);return e.he||(e.he=function eh(n,e){if("F"===n.limitType)return Oo(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>new Ar(i.field,"desc"===i.dir?"asc":"desc"));const t=n.endAt?new vt(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new vt(n.startAt.position,n.startAt.inclusive):null;return Oo(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}(e,En(n))),e.he}function Bo(n,e){const t=n.filters.concat([e]);return new it(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function $i(n,e,t){return new it(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Rr(n,e){return br(be(n),be(e))&&n.limitType===e.limitType}function th(n){return`${Gt(be(n))}|lt:${n.limitType}`}function vn(n){return`Query(target=${function(t){let r=t.path.canonicalString();return null!==t.collectionGroup&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>Ql(i)).join(", ")}]`),yr(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>{return`${(o=i).field.canonicalString()} (${o.dir})`;var o}).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>yn(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>yn(i)).join(",")),`Target(${r})`}(be(n))}; limitType=${n.limitType})`}function Pr(n,e){return e.isFoundDocument()&&function(r,i){const s=i.key.path;return null!==r.collectionGroup?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):v.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(n,e)&&function(r,i){for(const s of En(r))if(!s.field.isKeyField()&&null===i.data.field(s.field))return!1;return!0}(n,e)&&function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0}(n,e)&&(i=e,!((r=n).startAt&&!function(o,a,u){const c=Ul(o,a,u);return o.inclusive?c<=0:c<0}(r.startAt,En(r),i)||r.endAt&&!function(o,a,u){const c=Ul(o,a,u);return o.inclusive?c>=0:c>0}(r.endAt,En(r),i)));var r,i}function nh(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function rh(n){return(e,t)=>{let r=!1;for(const i of En(n)){const s=sm(i,e,t);if(0!==s)return s;r=r||i.field.isKeyField()}return 0}}function sm(n,e,t){const r=n.field.isKeyField()?v.comparator(e.key,t.key):function(s,o,a){const u=o.data.field(s),c=a.data.field(s);return null!==u&&null!==c?Et(u,c):A()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return A()}}class st{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(void 0!==r)for(const[i,s]of r)if(this.equalsFn(i,e))return s}has(e){return void 0!==this.get(e)}set(e,t){const r=this.mapKeyFn(e),i=this.inner[r];if(void 0===i)return this.inner[r]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(void 0===r)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return 1===r.length?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){pt(this.inner,(t,r)=>{for(const[i,s]of r)e(i,s)})}isEmpty(){return Cl(this.inner)}size(){return this.innerSize}}const om=new Q(v.comparator);function Ce(){return om}const ih=new Q(v.comparator);function Sr(...n){let e=ih;for(const t of n)e=e.insert(t.key,t);return e}function sh(n){let e=ih;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function Ye(){return Vr()}function oh(){return Vr()}function Vr(){return new st(n=>n.toString(),(n,e)=>n.isEqual(e))}const am=new Q(v.comparator),um=new K(v.comparator);function k(...n){let e=um;for(const t of n)e=e.add(t);return e}const cm=new K(D);function qo(){return cm}function ah(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ir(e)?"-0":e}}function uh(n){return{integerValue:""+n}}function ch(n,e){return vl(e)?uh(e):ah(n,e)}class Qi{constructor(){this._=void 0}}function lm(n,e,t){return n instanceof wn?function(i,s){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&Bi(s)&&(s=qi(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(t,e):n instanceof zt?hh(n,e):n instanceof jt?dh(n,e):function(i,s){const o=lh(i,s),a=_h(o)+_h(i.Ie);return No(o)&&No(i.Ie)?uh(a):ah(i.serializer,a)}(n,e)}function hm(n,e,t){return n instanceof zt?hh(n,e):n instanceof jt?dh(n,e):t}function lh(n,e){return n instanceof An?No(r=e)||(s=r)&&"doubleValue"in s?e:{integerValue:0}:null;var r,s}class wn extends Qi{}class zt extends Qi{constructor(e){super(),this.elements=e}}function hh(n,e){const t=fh(e);for(const r of n.elements)t.some(i=>Ze(i,r))||t.push(r);return{arrayValue:{values:t}}}class jt extends Qi{constructor(e){super(),this.elements=e}}function dh(n,e){let t=fh(e);for(const r of n.elements)t=t.filter(i=>!Ze(i,r));return{arrayValue:{values:t}}}class An extends Qi{constructor(e,t){super(),this.serializer=e,this.Ie=t}}function _h(n){return ne(n.integerValue||n.doubleValue)}function fh(n){return vr(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class Cr{constructor(e,t){this.field=e,this.transform=t}}class _m{constructor(e,t){this.version=e,this.transformResults=t}}class ee{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new ee}static exists(e){return new ee(void 0,e)}static updateTime(e){return new ee(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Wi(n,e){return void 0!==n.updateTime?e.isFoundDocument()&&e.version.isEqual(n.updateTime):void 0===n.exists||n.exists===e.isFoundDocument()}class Hi{}function mh(n,e){if(!n.hasLocalMutations||e&&0===e.fields.length)return null;if(null===e)return n.isNoDocument()?new Rn(n.key,ee.none()):new bn(n.key,n.data,ee.none());{const t=n.data,r=xe.empty();let i=new K(Z.comparator);for(let s of e.fields)if(!i.has(s)){let o=t.field(s);null===o&&s.length>1&&(s=s.popLast(),o=t.field(s)),null===o?r.delete(s):r.set(s,o),i=i.add(s)}return new ot(n.key,r,new Ve(i.toArray()),ee.none())}}function fm(n,e,t){n instanceof bn?function(i,s,o){const a=i.value.clone(),u=xh(i.fieldTransforms,s,o.transformResults);a.setAll(u),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(n,e,t):n instanceof ot?function(i,s,o){if(!Wi(i.precondition,s))return void s.convertToUnknownDocument(o.version);const a=xh(i.fieldTransforms,s,o.transformResults),u=s.data;u.setAll(ph(i)),u.setAll(a),s.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(n,e,t):e.convertToNoDocument(t.version).setHasCommittedMutations()}function Dr(n,e,t,r){return n instanceof bn?function(s,o,a,u){if(!Wi(s.precondition,o))return a;const c=s.value.clone(),l=yh(s.fieldTransforms,u,o);return c.setAll(l),o.convertToFoundDocument(o.version,c).setHasLocalMutations(),null}(n,e,t,r):n instanceof ot?function(s,o,a,u){if(!Wi(s.precondition,o))return a;const c=yh(s.fieldTransforms,u,o),l=o.data;return l.setAll(ph(s)),l.setAll(c),o.convertToFoundDocument(o.version,l).setHasLocalMutations(),null===a?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(h=>h.field))}(n,e,t,r):(a=t,Wi(n.precondition,o=e)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a);var o,a}function mm(n,e){let t=null;for(const r of n.fieldTransforms){const i=e.data.field(r.field),s=lh(r.transform,i||null);null!=s&&(null===t&&(t=xe.empty()),t.set(r.field,s))}return t||null}function gh(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&(i=e.fieldTransforms,!!(void 0===(r=n.fieldTransforms)&&void 0===i||r&&i&&mn(r,i,(s,o)=>function dm(n,e){return n.field.isEqual(e.field)&&(i=e.transform,(r=n.transform)instanceof zt&&i instanceof zt||r instanceof jt&&i instanceof jt?mn(r.elements,i.elements,Ze):r instanceof An&&i instanceof An?Ze(r.Ie,i.Ie):r instanceof wn&&i instanceof wn);var r,i}(s,o))))&&(0===n.type?n.value.isEqual(e.value):1!==n.type||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask));var r,i}class bn extends Hi{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class ot extends Hi{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function ph(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}}),e}function xh(n,e,t){const r=new Map;R(n.length===t.length);for(let i=0;i<t.length;i++){const s=n[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,hm(o,a,t[i]))}return r}function yh(n,e,t){const r=new Map;for(const i of n){const s=i.transform,o=t.data.field(i.field);r.set(i.field,lm(s,o,e))}return r}class Rn extends Hi{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Uo extends Hi{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class Go{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&fm(s,e,r[i])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=Dr(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=Dr(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=oh();return this.mutations.forEach(i=>{const s=e.get(i.key),o=s.overlayedDocument;let a=this.applyToLocalView(o,s.mutatedFields);a=t.has(i.key)?null:a;const u=mh(o,a);null!==u&&r.set(i.key,u),o.isValidDocument()||o.convertToNoDocument(P.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),k())}isEqual(e){return this.batchId===e.batchId&&mn(this.mutations,e.mutations,(t,r)=>gh(t,r))&&mn(this.baseMutations,e.baseMutations,(t,r)=>gh(t,r))}}class zo{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){R(e.mutations.length===r.length);let i=am;const s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new zo(e,t,r,i)}}class jo{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class pm{constructor(e,t){this.count=e,this.unchangedNames=t}}var ae,q;function Ih(n){switch(n){default:return A();case m.CANCELLED:case m.UNKNOWN:case m.DEADLINE_EXCEEDED:case m.RESOURCE_EXHAUSTED:case m.INTERNAL:case m.UNAVAILABLE:case m.UNAUTHENTICATED:return!1;case m.INVALID_ARGUMENT:case m.NOT_FOUND:case m.ALREADY_EXISTS:case m.PERMISSION_DENIED:case m.FAILED_PRECONDITION:case m.ABORTED:case m.OUT_OF_RANGE:case m.UNIMPLEMENTED:case m.DATA_LOSS:return!0}}function Th(n){if(void 0===n)return ie("GRPC error has no .code"),m.UNKNOWN;switch(n){case ae.OK:return m.OK;case ae.CANCELLED:return m.CANCELLED;case ae.UNKNOWN:return m.UNKNOWN;case ae.DEADLINE_EXCEEDED:return m.DEADLINE_EXCEEDED;case ae.RESOURCE_EXHAUSTED:return m.RESOURCE_EXHAUSTED;case ae.INTERNAL:return m.INTERNAL;case ae.UNAVAILABLE:return m.UNAVAILABLE;case ae.UNAUTHENTICATED:return m.UNAUTHENTICATED;case ae.INVALID_ARGUMENT:return m.INVALID_ARGUMENT;case ae.NOT_FOUND:return m.NOT_FOUND;case ae.ALREADY_EXISTS:return m.ALREADY_EXISTS;case ae.PERMISSION_DENIED:return m.PERMISSION_DENIED;case ae.FAILED_PRECONDITION:return m.FAILED_PRECONDITION;case ae.ABORTED:return m.ABORTED;case ae.OUT_OF_RANGE:return m.OUT_OF_RANGE;case ae.UNIMPLEMENTED:return m.UNIMPLEMENTED;case ae.DATA_LOSS:return m.DATA_LOSS;default:return A()}}(q=ae||(ae={}))[q.OK=0]="OK",q[q.CANCELLED=1]="CANCELLED",q[q.UNKNOWN=2]="UNKNOWN",q[q.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",q[q.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",q[q.NOT_FOUND=5]="NOT_FOUND",q[q.ALREADY_EXISTS=6]="ALREADY_EXISTS",q[q.PERMISSION_DENIED=7]="PERMISSION_DENIED",q[q.UNAUTHENTICATED=16]="UNAUTHENTICATED",q[q.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",q[q.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",q[q.ABORTED=10]="ABORTED",q[q.OUT_OF_RANGE=11]="OUT_OF_RANGE",q[q.UNIMPLEMENTED=12]="UNIMPLEMENTED",q[q.INTERNAL=13]="INTERNAL",q[q.UNAVAILABLE=14]="UNAVAILABLE",q[q.DATA_LOSS=15]="DATA_LOSS";function Eh(){return new TextEncoder}const xm=new dn([4294967295,4294967295],0);function vh(n){const e=Eh().encode(n),t=new h0;return t.update(e),new Uint8Array(t.digest())}function wh(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new dn([t,r],0),new dn([i,s],0)]}class Ko{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new Nr(`Invalid padding: ${t}`);if(r<0)throw new Nr(`Invalid hash count: ${r}`);if(e.length>0&&0===this.hashCount)throw new Nr(`Invalid hash count: ${r}`);if(0===e.length&&0!==t)throw new Nr(`Invalid padding when bitmap length is 0: ${t}`);this.Te=8*e.length-t,this.Ee=dn.fromNumber(this.Te)}de(e,t,r){let i=e.add(t.multiply(dn.fromNumber(r)));return 1===i.compare(xm)&&(i=new dn([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Ee).toNumber()}Ae(e){return 0!=(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(0===this.Te)return!1;const t=vh(e),[r,i]=wh(t);for(let s=0;s<this.hashCount;s++){const o=this.de(r,i,s);if(!this.Ae(o))return!1}return!0}static create(e,t,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new Ko(s,i,t);return r.forEach(a=>o.insert(a)),o}insert(e){if(0===this.Te)return;const t=vh(e),[r,i]=wh(t);for(let s=0;s<this.hashCount;s++){const o=this.de(r,i,s);this.Re(o)}}Re(e){const t=Math.floor(e/8);this.bitmap[t]|=1<<e%8}}class Nr extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class kr{constructor(e,t,r,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const i=new Map;return i.set(e,Fr.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new kr(P.min(),i,new Q(D),Ce(),k())}}class Fr{constructor(e,t,r,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new Fr(r,t,k(),k(),k())}}class Yi{constructor(e,t,r,i){this.Ve=e,this.removedTargetIds=t,this.key=r,this.me=i}}class Ah{constructor(e,t){this.targetId=e,this.fe=t}}class bh{constructor(e,t,r=ce.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}}class Rh{constructor(){this.ge=0,this.pe=Sh(),this.ye=ce.EMPTY_BYTE_STRING,this.we=!1,this.Se=!0}get current(){return this.we}get resumeToken(){return this.ye}get be(){return 0!==this.ge}get De(){return this.Se}Ce(e){e.approximateByteSize()>0&&(this.Se=!0,this.ye=e)}ve(){let e=k(),t=k(),r=k();return this.pe.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:A()}}),new Fr(this.ye,this.we,e,t,r)}Fe(){this.Se=!1,this.pe=Sh()}Me(e,t){this.Se=!0,this.pe=this.pe.insert(e,t)}xe(e){this.Se=!0,this.pe=this.pe.remove(e)}Oe(){this.ge+=1}Ne(){this.ge-=1,R(this.ge>=0)}Be(){this.Se=!0,this.we=!0}}class ym{constructor(e){this.Le=e,this.ke=new Map,this.qe=Ce(),this.Qe=Ph(),this.Ke=new Q(D)}$e(e){for(const t of e.Ve)e.me&&e.me.isFoundDocument()?this.Ue(t,e.me):this.We(t,e.key,e.me);for(const t of e.removedTargetIds)this.We(t,e.key,e.me)}Ge(e){this.forEachTarget(e,t=>{const r=this.ze(t);switch(e.state){case 0:this.je(t)&&r.Ce(e.resumeToken);break;case 1:r.Ne(),r.be||r.Fe(),r.Ce(e.resumeToken);break;case 2:r.Ne(),r.be||this.removeTarget(t);break;case 3:this.je(t)&&(r.Be(),r.Ce(e.resumeToken));break;case 4:this.je(t)&&(this.He(t),r.Ce(e.resumeToken));break;default:A()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ke.forEach((r,i)=>{this.je(i)&&t(i)})}Je(e){const t=e.targetId,r=e.fe.count,i=this.Ye(t);if(i){const s=i.target;if(ji(s))if(0===r){const o=new v(s.path);this.We(t,o,Y.newNoDocument(o,P.min()))}else R(1===r);else{const o=this.Ze(t);if(o!==r){const a=this.Xe(e),u=a?this.et(a,e,o):1;0!==u&&(this.He(t),this.Ke=this.Ke.insert(t,2===u?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch"))}}}}Xe(e){const t=e.fe.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=t;let o,a;try{o=rt(r).toUint8Array()}catch(u){if(u instanceof Nl)return Se("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{a=new Ko(o,i,s)}catch(u){return Se(u instanceof Nr?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return 0===a.Te?null:a}et(e,t,r){return t.fe.count===r-this.rt(e,t.targetId)?0:2}rt(e,t){const r=this.Le.getRemoteKeysForTarget(t);let i=0;return r.forEach(s=>{const o=this.Le.nt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.We(t,s,null),i++)}),i}it(e){const t=new Map;this.ke.forEach((s,o)=>{const a=this.Ye(o);if(a){if(s.current&&ji(a.target)){const u=new v(a.target.path);null!==this.qe.get(u)||this.st(o,u)||this.We(o,u,Y.newNoDocument(u,e))}s.De&&(t.set(o,s.ve()),s.Fe())}});let r=k();this.Qe.forEach((s,o)=>{let a=!0;o.forEachWhile(u=>{const c=this.Ye(u);return!c||"TargetPurposeLimboResolution"===c.purpose||(a=!1,!1)}),a&&(r=r.add(s))}),this.qe.forEach((s,o)=>o.setReadTime(e));const i=new kr(e,t,this.Ke,this.qe,r);return this.qe=Ce(),this.Qe=Ph(),this.Ke=new Q(D),i}Ue(e,t){if(!this.je(e))return;const r=this.st(e,t.key)?2:0;this.ze(e).Me(t.key,r),this.qe=this.qe.insert(t.key,t),this.Qe=this.Qe.insert(t.key,this.ot(t.key).add(e))}We(e,t,r){if(!this.je(e))return;const i=this.ze(e);this.st(e,t)?i.Me(t,1):i.xe(t),this.Qe=this.Qe.insert(t,this.ot(t).delete(e)),r&&(this.qe=this.qe.insert(t,r))}removeTarget(e){this.ke.delete(e)}Ze(e){const t=this.ze(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Oe(e){this.ze(e).Oe()}ze(e){let t=this.ke.get(e);return t||(t=new Rh,this.ke.set(e,t)),t}ot(e){let t=this.Qe.get(e);return t||(t=new K(D),this.Qe=this.Qe.insert(e,t)),t}je(e){const t=null!==this.Ye(e);return t||x("WatchChangeAggregator","Detected inactive target",e),t}Ye(e){const t=this.ke.get(e);return t&&t.be?null:this.Le._t(e)}He(e){this.ke.set(e,new Rh),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.We(e,t,null)})}st(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}}function Ph(){return new Q(v.comparator)}function Sh(){return new Q(v.comparator)}const Im={asc:"ASCENDING",desc:"DESCENDING"},Tm={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Em={and:"AND",or:"OR"};class vm{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function $o(n,e){return n.useProto3Json||yr(e)?e:{value:e}}function Pn(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Vh(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function wm(n,e){return Pn(n,e.toTimestamp())}function se(n){return R(!!n),P.fromTimestamp(function(t){const r=xt(t);return new J(r.seconds,r.nanos)}(n))}function Qo(n,e){return(r=n,new B(["projects",r.projectId,"databases",r.database])).child("documents").child(e).canonicalString();var r}function Ch(n){const e=B.fromString(n);return R(qh(e)),e}function Mr(n,e){return Qo(n.databaseId,e.path)}function Xe(n,e){const t=Ch(e);if(t.get(1)!==n.databaseId.projectId)throw new p(m.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new p(m.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new v(Nh(t))}function Wo(n,e){return Qo(n.databaseId,e)}function Dh(n){const e=Ch(n);return 4===e.length?B.emptyPath():Nh(e)}function Or(n){return new B(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function Nh(n){return R(n.length>4&&"documents"===n.get(4)),n.popFirst(5)}function kh(n,e,t){return{name:Mr(n,e),fields:t.value.mapValue.fields}}function Fh(n,e,t){const r=Xe(n,e.name),i=se(e.updateTime),s=e.createTime?se(e.createTime):P.min(),o=new xe({mapValue:{fields:e.fields}}),a=Y.newFoundDocument(r,i,s,o);return t&&a.setHasCommittedMutations(),t?a.setHasCommittedMutations():a}function Lr(n,e){let t;if(e instanceof bn)t={update:kh(n,e.key,e.value)};else if(e instanceof Rn)t={delete:Mr(n,e.key)};else if(e instanceof ot)t={update:kh(n,e.key,e.data),updateMask:Dm(e.fieldMask)};else{if(!(e instanceof Uo))return A();t={verify:Mr(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(s,o){const a=o.transform;if(a instanceof wn)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof zt)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof jt)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof An)return{fieldPath:o.field.canonicalString(),increment:a.Ie};throw A()}(0,r))),e.precondition.isNone||(t.currentDocument=void 0!==(s=e.precondition).updateTime?{updateTime:wm(n,s.updateTime)}:void 0!==s.exists?{exists:s.exists}:A()),t;var s}function Ho(n,e){const t=e.currentDocument?void 0!==(s=e.currentDocument).updateTime?ee.updateTime(se(s.updateTime)):void 0!==s.exists?ee.exists(s.exists):ee.none():ee.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(o,a){let u=null;"setToServerValue"in a?(R("REQUEST_TIME"===a.setToServerValue),u=new wn):"appendMissingElements"in a?u=new zt(a.appendMissingElements.values||[]):"removeAllFromArray"in a?u=new jt(a.removeAllFromArray.values||[]):"increment"in a?u=new An(o,a.increment):A();const c=Z.fromServerFormat(a.fieldPath);return new Cr(c,u)}(n,i)):[];var s;if(e.update){const i=Xe(n,e.update.name),s=new xe({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=new Ve((e.updateMask.fieldPaths||[]).map(l=>Z.fromServerFormat(l)));return new ot(i,s,o,t,r)}return new bn(i,s,t,r)}if(e.delete){const i=Xe(n,e.delete);return new Rn(i,t)}if(e.verify){const i=Xe(n,e.verify);return new Uo(i,t)}return A()}function Mh(n,e){return{documents:[Wo(n,e.path)]}}function Zo(n,e){const t={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(t.parent=Wo(n,r),t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(t.parent=Wo(n,r.popLast()),t.structuredQuery.from=[{collectionId:r.lastSegment()}]);const i=function(u){if(0!==u.length)return Bh(j.create(u,"and"))}(e.filters);i&&(t.structuredQuery.where=i);const s=function(u){if(0!==u.length)return u.map(c=>{return{field:wt((h=c).field),direction:Sm(h.dir)};var h})}(e.orderBy);s&&(t.structuredQuery.orderBy=s);const o=$o(n,e.limit);return null!==o&&(t.structuredQuery.limit=o),e.startAt&&(t.structuredQuery.startAt={before:(u=e.startAt).inclusive,values:u.position}),e.endAt&&(t.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),t;var u}function Oh(n){let e=Dh(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let i=null;if(r>0){R(1===r);const l=t.from[0];l.allDescendants?i=l.collectionId:e=e.child(l.collectionId)}let s=[];t.where&&(s=function(h){const d=Lh(h);return d instanceof j&&Fo(d)?d.getFilters():[d]}(t.where));let o=[];t.orderBy&&(o=t.orderBy.map(d=>{return new Ar(Sn((y=d).field),function(T){switch(T){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(y.direction));var y}));let a=null;t.limit&&(a=function(h){let d;return d="object"==typeof h?h.value:h,yr(d)?null:d}(t.limit));let u=null;var h;t.startAt&&(u=new vt((h=t.startAt).values||[],!!h.before));let c=null;return t.endAt&&(c=function(h){return new vt(h.values||[],!h.before)}(t.endAt)),Xl(e,i,o,s,a,"F",u,c)}function Lh(n){return void 0!==n.unaryFilter?function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=Sn(t.unaryFilter.field);return O.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=Sn(t.unaryFilter.field);return O.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Sn(t.unaryFilter.field);return O.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Sn(t.unaryFilter.field);return O.create(o,"!=",{nullValue:"NULL_VALUE"});default:return A()}}(n):void 0!==n.fieldFilter?O.create(Sn((t=n).fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return A()}}(t.fieldFilter.op),t.fieldFilter.value):void 0!==n.compositeFilter?function(t){return j.create(t.compositeFilter.filters.map(r=>Lh(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return A()}}(t.compositeFilter.op))}(n):A();var t}function Sm(n){return Im[n]}function Vm(n){return Tm[n]}function Cm(n){return Em[n]}function wt(n){return{fieldPath:n.canonicalString()}}function Sn(n){return Z.fromServerFormat(n.fieldPath)}function Bh(n){return n instanceof O?function(t){if("=="===t.op){if(Ml(t.value))return{unaryFilter:{field:wt(t.field),op:"IS_NAN"}};if(Fl(t.value))return{unaryFilter:{field:wt(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Ml(t.value))return{unaryFilter:{field:wt(t.field),op:"IS_NOT_NAN"}};if(Fl(t.value))return{unaryFilter:{field:wt(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:wt(t.field),op:Vm(t.op),value:t.value}}}(n):n instanceof j?function(t){const r=t.getFilters().map(i=>Bh(i));return 1===r.length?r[0]:{compositeFilter:{op:Cm(t.op),filters:r}}}(n):A()}function Dm(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function qh(n){return n.length>=4&&"projects"===n.get(0)&&"databases"===n.get(2)}class at{constructor(e,t,r,i,s=P.min(),o=P.min(),a=ce.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=u}withSequenceNumber(e){return new at(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new at(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new at(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new at(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class Uh{constructor(e){this.ut=e}}function Gh(n,e){const t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:Xi(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document={name:Mr(s=n.ut,(o=e).key),fields:o.data.value.mapValue.fields,updateTime:Pn(s,o.version.toTimestamp()),createTime:Pn(s,o.createTime.toTimestamp())};else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:Kt(e.version)};else{if(!e.isUnknownDocument())return A();r.unknownDocument={path:t.path.toArray(),version:Kt(e.version)}}var s,o;return r}function Xi(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function Kt(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function $t(n){const e=new J(n.seconds,n.nanoseconds);return P.fromTimestamp(e)}function Qt(n,e){const t=(e.baseMutations||[]).map(s=>Ho(n.ut,s));for(let s=0;s<e.mutations.length-1;++s)s+1<e.mutations.length&&void 0!==e.mutations[s+1].transform&&(e.mutations[s].updateTransforms=e.mutations[s+1].transform.fieldTransforms,e.mutations.splice(s+1,1),++s);const r=e.mutations.map(s=>Ho(n.ut,s)),i=J.fromMillis(e.localWriteTimeMs);return new Go(e.batchId,i,t,r)}function Br(n){const e=$t(n.readTime),t=void 0!==n.lastLimboFreeSnapshotVersion?$t(n.lastLimboFreeSnapshotVersion):P.min();let r;return r=void 0!==n.query.documents?(R(1===(s=n.query).documents.length),be(Tn(Dh(s.documents[0])))):function(s){return be(Oh(s))}(n.query),new at(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,ce.fromBase64String(n.resumeToken));var s}function zh(n,e){const t=Kt(e.snapshotVersion),r=Kt(e.lastLimboFreeSnapshotVersion);let i;i=ji(e.target)?Mh(n.ut,e.target):Zo(n.ut,e.target);const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Gt(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function Yo(n){const e=Oh({parent:n.parent,structuredQuery:n.structuredQuery});return"LAST"===n.limitType?$i(e,e.limit,"L"):e}function Xo(n,e){return new jo(e.largestBatchId,Ho(n.ut,e.overlayMutation))}function jh(n,e){const t=e.path.lastSegment();return[n,Ee(e.path.popLast()),t]}function Kh(n,e,t,r){return{indexId:n,uid:e.uid||"",sequenceNumber:t,readTime:Kt(r.readTime),documentKey:Ee(r.documentKey.path),largestBatchId:r.largestBatchId}}class km{getBundleMetadata(e,t){return $h(e).get(t).next(r=>{if(r)return{id:(s=r).bundleId,createTime:$t(s.createTime),version:s.version};var s})}saveBundleMetadata(e,t){return $h(e).put({bundleId:(i=t).id,createTime:Kt(se(i.createTime)),version:i.version});var i}getNamedQuery(e,t){return Qh(e).get(t).next(r=>{if(r)return{name:(s=r).name,query:Yo(s.bundledQuery),readTime:$t(s.readTime)};var s})}saveNamedQuery(e,t){return Qh(e).put({name:(i=t).name,readTime:Kt(se(i.readTime)),bundledQuery:i.bundledQuery});var i}}function $h(n){return _e(n,"bundles")}function Qh(n){return _e(n,"namedQueries")}class Ji{constructor(e,t){this.serializer=e,this.userId=t}static ct(e,t){return new Ji(e,t.uid||"")}getOverlay(e,t){return qr(e).get(jh(this.userId,t)).next(r=>r?Xo(this.serializer,r):null)}getOverlays(e,t){const r=Ye();return _.forEach(t,i=>this.getOverlay(e,i).next(s=>{null!==s&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){const i=[];return r.forEach((s,o)=>{const a=new jo(t,o);i.push(this.lt(e,a))}),_.waitFor(i)}removeOverlaysForBatchId(e,t,r){const i=new Set;t.forEach(o=>i.add(Ee(o.getCollectionPath())));const s=[];return i.forEach(o=>{const a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);s.push(qr(e).H("collectionPathOverlayIndex",a))}),_.waitFor(s)}getOverlaysForCollection(e,t,r){const i=Ye(),s=Ee(t),o=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return qr(e).W("collectionPathOverlayIndex",o).next(a=>{for(const u of a){const c=Xo(this.serializer,u);i.set(c.getKey(),c)}return i})}getOverlaysForCollectionGroup(e,t,r,i){const s=Ye();let o;const a=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return qr(e).Y({index:"collectionGroupOverlayIndex",range:a},(u,c,l)=>{const h=Xo(this.serializer,c);s.size()<i||h.largestBatchId===o?(s.set(h.getKey(),h),o=h.largestBatchId):l.done()}).next(()=>s)}lt(e,t){return qr(e).put(function(i,s,o){const[a,u,c]=jh(s,o.mutation.key);return{userId:s,collectionPath:u,documentId:c,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:Lr(i.ut,o.mutation)}}(this.serializer,this.userId,t))}}function qr(n){return _e(n,"documentOverlays")}class Wt{constructor(){}ht(e,t){this.Pt(e,t),t.It()}Pt(e,t){if("nullValue"in e)this.Tt(t,5);else if("booleanValue"in e)this.Tt(t,10),t.Et(e.booleanValue?1:0);else if("integerValue"in e)this.Tt(t,15),t.Et(ne(e.integerValue));else if("doubleValue"in e){const r=ne(e.doubleValue);isNaN(r)?this.Tt(t,13):(this.Tt(t,15),Ir(r)?t.Et(0):t.Et(r))}else if("timestampValue"in e){const r=e.timestampValue;this.Tt(t,20),"string"==typeof r?t.dt(r):(t.dt(`${r.seconds||""}`),t.Et(r.nanos||0))}else if("stringValue"in e)this.At(e.stringValue,t),this.Rt(t);else if("bytesValue"in e)this.Tt(t,30),t.Vt(rt(e.bytesValue)),this.Rt(t);else if("referenceValue"in e)this.ft(e.referenceValue,t);else if("geoPointValue"in e){const r=e.geoPointValue;this.Tt(t,45),t.Et(r.latitude||0),t.Et(r.longitude||0)}else"mapValue"in e?Ol(e)?this.Tt(t,Number.MAX_SAFE_INTEGER):(this.gt(e.mapValue,t),this.Rt(t)):"arrayValue"in e?(this.yt(e.arrayValue,t),this.Rt(t)):A()}At(e,t){this.Tt(t,25),this.wt(e,t)}wt(e,t){t.dt(e)}gt(e,t){const r=e.fields||{};this.Tt(t,55);for(const i of Object.keys(r))this.At(i,t),this.Pt(r[i],t)}yt(e,t){const r=e.values||[];this.Tt(t,50);for(const i of r)this.Pt(i,t)}ft(e,t){this.Tt(t,37),v.fromName(e).path.forEach(r=>{this.Tt(t,60),this.wt(r,t)})}Tt(e,t){e.Et(t)}Rt(e){e.Et(2)}}function Fm(n){if(0===n)return 8;let e=0;return!(n>>4)&&(e+=4,n<<=4),!(n>>6)&&(e+=2,n<<=2),!(n>>7)&&(e+=1),e}function Wh(n){const e=64-function(r){let i=0;for(let s=0;s<8;++s){const o=Fm(255&r[s]);if(i+=o,8!==o)break}return i}(n);return Math.ceil(e/8)}Wt.St=new Wt;class Mm{constructor(){this.buffer=new Uint8Array(1024),this.position=0}bt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Dt(r.value),r=t.next();this.Ct()}vt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Ft(r.value),r=t.next();this.Mt()}xt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Dt(r);else if(r<2048)this.Dt(960|r>>>6),this.Dt(128|63&r);else if(t<"\ud800"||"\udbff"<t)this.Dt(480|r>>>12),this.Dt(128|63&r>>>6),this.Dt(128|63&r);else{const i=t.codePointAt(0);this.Dt(240|i>>>18),this.Dt(128|63&i>>>12),this.Dt(128|63&i>>>6),this.Dt(128|63&i)}}this.Ct()}Ot(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Ft(r);else if(r<2048)this.Ft(960|r>>>6),this.Ft(128|63&r);else if(t<"\ud800"||"\udbff"<t)this.Ft(480|r>>>12),this.Ft(128|63&r>>>6),this.Ft(128|63&r);else{const i=t.codePointAt(0);this.Ft(240|i>>>18),this.Ft(128|63&i>>>12),this.Ft(128|63&i>>>6),this.Ft(128|63&i)}}this.Mt()}Nt(e){const t=this.Bt(e),r=Wh(t);this.Lt(1+r),this.buffer[this.position++]=255&r;for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=255&t[i]}kt(e){const t=this.Bt(e),r=Wh(t);this.Lt(1+r),this.buffer[this.position++]=~(255&r);for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}qt(){this.Qt(255),this.Qt(255)}Kt(){this.$t(255),this.$t(255)}reset(){this.position=0}seed(e){this.Lt(e.length),this.buffer.set(e,this.position),this.position+=e.length}Ut(){return this.buffer.slice(0,this.position)}Bt(e){const t=function(s){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)}(e),r=0!=(128&t[0]);t[0]^=r?255:128;for(let i=1;i<t.length;++i)t[i]^=r?255:0;return t}Dt(e){const t=255&e;0===t?(this.Qt(0),this.Qt(255)):255===t?(this.Qt(255),this.Qt(0)):this.Qt(t)}Ft(e){const t=255&e;0===t?(this.$t(0),this.$t(255)):255===t?(this.$t(255),this.$t(0)):this.$t(e)}Ct(){this.Qt(0),this.Qt(1)}Mt(){this.$t(0),this.$t(1)}Qt(e){this.Lt(1),this.buffer[this.position++]=e}$t(e){this.Lt(1),this.buffer[this.position++]=~e}Lt(e){const t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class Om{constructor(e){this.Wt=e}Vt(e){this.Wt.bt(e)}dt(e){this.Wt.xt(e)}Et(e){this.Wt.Nt(e)}It(){this.Wt.qt()}}class Lm{constructor(e){this.Wt=e}Vt(e){this.Wt.vt(e)}dt(e){this.Wt.Ot(e)}Et(e){this.Wt.kt(e)}It(){this.Wt.Kt()}}class Ur{constructor(){this.Wt=new Mm,this.Gt=new Om(this.Wt),this.zt=new Lm(this.Wt)}seed(e){this.Wt.seed(e)}jt(e){return 0===e?this.Gt:this.zt}Ut(){return this.Wt.Ut()}reset(){this.Wt.reset()}}class Ht{constructor(e,t,r,i){this.indexId=e,this.documentKey=t,this.arrayValue=r,this.directionalValue=i}Ht(){const e=this.directionalValue.length,t=0===e||255===this.directionalValue[e-1]?e+1:e,r=new Uint8Array(t);return r.set(this.directionalValue,0),t!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new Ht(this.indexId,this.documentKey,this.arrayValue,r)}}function At(n,e){let t=n.indexId-e.indexId;return 0!==t?t:(t=Hh(n.arrayValue,e.arrayValue),0!==t?t:(t=Hh(n.directionalValue,e.directionalValue),0!==t?t:v.comparator(n.documentKey,e.documentKey)))}function Hh(n,e){for(let t=0;t<n.length&&t<e.length;++t){const r=n[t]-e[t];if(0!==r)return r}return n.length-e.length}class Zh{constructor(e){this.Jt=new K((t,r)=>Z.comparator(t.field,r.field)),this.collectionId=null!=e.collectionGroup?e.collectionGroup:e.path.lastSegment(),this.Yt=e.orderBy,this.Zt=[];for(const t of e.filters){const r=t;r.isInequality()?this.Jt=this.Jt.add(r):this.Zt.push(r)}}get Xt(){return this.Jt.size>1}en(e){if(R(e.collectionGroup===this.collectionId),this.Xt)return!1;const t=Ro(e);if(void 0!==t&&!this.tn(t))return!1;const r=Lt(e);let i=new Set,s=0,o=0;for(;s<r.length&&this.tn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.Jt.size>0){const a=this.Jt.getIterator().getNext();if(!i.has(a.field.canonicalString())){const u=r[s];if(!this.nn(a,u)||!this.rn(this.Yt[o++],u))return!1}++s}for(;s<r.length;++s)if(o>=this.Yt.length||!this.rn(this.Yt[o++],r[s]))return!1;return!0}sn(){if(this.Xt)return null;let e=new K(Z.comparator);const t=[];for(const r of this.Zt)if(!r.field.isKeyField())if("array-contains"===r.op||"array-contains-any"===r.op)t.push(new Bt(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new Bt(r.field,0))}for(const r of this.Yt)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new Bt(r.field,"asc"===r.dir?0:1)));return new gn(gn.UNKNOWN_ID,this.collectionId,t,pn.empty())}tn(e){for(const t of this.Zt)if(this.nn(t,e))return!0;return!1}nn(e,t){return!(void 0===e||!e.field.isEqual(t.fieldPath))&&2===t.kind==("array-contains"===e.op||"array-contains-any"===e.op)}rn(e,t){return!!e.field.isEqual(t.fieldPath)&&(0===t.kind&&"asc"===e.dir||1===t.kind&&"desc"===e.dir)}}function Yh(n){var e,t;if(R(n instanceof O||n instanceof j),n instanceof O){if(n instanceof Hl){const i=(null===(t=null===(e=n.value.arrayValue)||void 0===e?void 0:e.values)||void 0===t?void 0:t.map(s=>O.create(n.field,"==",s)))||[];return j.create(i,"or")}return n}const r=n.filters.map(i=>Yh(i));return j.create(r,n.op)}function Bm(n){if(0===n.getFilters().length)return[];const e=ta(Yh(n));return R(Xh(e)),Jo(e)||ea(e)?[e]:e.getFilters()}function Jo(n){return n instanceof O}function ea(n){return n instanceof j&&Fo(n)}function Xh(n){return Jo(n)||ea(n)||function(t){if(t instanceof j&&ko(t)){for(const r of t.getFilters())if(!Jo(r)&&!ea(r))return!1;return!0}return!1}(n)}function ta(n){if(R(n instanceof O||n instanceof j),n instanceof O)return n;if(1===n.filters.length)return ta(n.filters[0]);const e=n.filters.map(r=>ta(r));let t=j.create(e,n.op);return t=es(t),Xh(t)?t:(R(t instanceof j),R(In(t)),R(t.filters.length>1),t.filters.reduce((r,i)=>na(r,i)))}function na(n,e){let t;return R(n instanceof O||n instanceof j),R(e instanceof O||e instanceof j),t=n instanceof O?e instanceof O?j.create([n,e],"and"):Jh(n,e):e instanceof O?Jh(e,n):function(i,s){if(R(i.filters.length>0&&s.filters.length>0),In(i)&&In(s))return $l(i,s.getFilters());const o=ko(i)?i:s,a=ko(i)?s:i,u=o.filters.map(c=>na(c,a));return j.create(u,"or")}(n,e),es(t)}function Jh(n,e){if(In(e))return $l(e,n.getFilters());{const t=e.filters.map(r=>na(n,r));return j.create(t,"or")}}function es(n){if(R(n instanceof O||n instanceof j),n instanceof O)return n;const e=n.getFilters();if(1===e.length)return es(e[0]);if(jl(n))return n;const t=e.map(i=>es(i)),r=[];return t.forEach(i=>{i instanceof O?r.push(i):i instanceof j&&(i.op===n.op?r.push(...i.filters):r.push(i))}),1===r.length?r[0]:j.create(r,n.op)}class qm{constructor(){this.on=new ra}addToCollectionParentIndex(e,t){return this.on.add(t),_.resolve()}getCollectionParents(e,t){return _.resolve(this.on.getEntries(t))}addFieldIndex(e,t){return _.resolve()}deleteFieldIndex(e,t){return _.resolve()}deleteAllFieldIndexes(e){return _.resolve()}createTargetIndexes(e,t){return _.resolve()}getDocumentsMatchingTarget(e,t){return _.resolve(null)}getIndexType(e,t){return _.resolve(0)}getFieldIndexes(e,t){return _.resolve([])}getNextCollectionGroupToUpdate(e){return _.resolve(null)}getMinOffset(e,t){return _.resolve(Fe.min())}getMinOffsetFromCollectionGroup(e,t){return _.resolve(Fe.min())}updateCollectionGroup(e,t,r){return _.resolve()}updateIndexEntries(e,t){return _.resolve()}}class ra{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new K(B.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new K(B.comparator)).toArray()}}const ts=new Uint8Array(0);class Um{constructor(e,t){this.user=e,this.databaseId=t,this._n=new ra,this.an=new st(r=>Gt(r),(r,i)=>br(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this._n.has(t)){const r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener(()=>{this._n.add(t)});const s={collectionId:r,parent:Ee(i)};return ed(e).put(s)}return _.resolve()}getCollectionParents(e,t){const r=[],i=IDBKeyRange.bound([t,""],[pl(t),""],!1,!0);return ed(e).W(i).next(s=>{for(const o of s){if(o.collectionId!==t)break;r.push(He(o.parent))}return r})}addFieldIndex(e,t){const r=Gr(e),i={indexId:(a=t).indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(u=>[u.fieldPath.canonicalString(),u.kind])};var a;delete i.indexId;const s=r.add(i);if(t.indexState){const o=Cn(e);return s.next(a=>{o.put(Kh(a,this.user,t.indexState.sequenceNumber,t.indexState.offset))})}return s.next()}deleteFieldIndex(e,t){const r=Gr(e),i=Cn(e),s=Vn(e);return r.delete(t.indexId).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const t=Gr(e),r=Vn(e),i=Cn(e);return t.H().next(()=>r.H()).next(()=>i.H())}createTargetIndexes(e,t){return _.forEach(this.un(t),r=>this.getIndexType(e,r).next(i=>{if(0===i||1===i){const s=new Zh(r).sn();if(null!=s)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,t){const r=Vn(e);let i=!0;const s=new Map;return _.forEach(this.un(t),o=>this.cn(e,o).next(a=>{i&&(i=!!a),s.set(o,a)})).next(()=>{if(i){let o=k();const a=[];return _.forEach(s,(u,c)=>{var V;x("IndexedDbIndexManager",`Using index ${V=u,`id=${V.indexId}|cg=${V.collectionGroup}|f=${V.fields.map(F=>`${F.fieldPath}:${F.kind}`).join(",")}`} to execute ${Gt(t)}`);const l=function(V,F){const G=Ro(F);if(void 0===G)return null;for(const L of Ki(V,G.fieldPath))switch(L.op){case"array-contains-any":return L.value.arrayValue.values||[];case"array-contains":return[L.value]}return null}(c,u),h=function(V,F){const G=new Map;for(const L of Lt(F))for(const oe of Ki(V,L.fieldPath))switch(oe.op){case"==":case"in":G.set(L.fieldPath.canonicalString(),oe.value);break;case"not-in":case"!=":return G.set(L.fieldPath.canonicalString(),oe.value),Array.from(G.values())}return null}(c,u),d=function(V,F){const G=[];let L=!0;for(const oe of Lt(F)){const De=0===oe.kind?Zl(V,oe.fieldPath,V.startAt):Yl(V,oe.fieldPath,V.startAt);G.push(De.value),L&&(L=De.inclusive)}return new vt(G,L)}(c,u),f=function(V,F){const G=[];let L=!0;for(const oe of Lt(F)){const De=0===oe.kind?Yl(V,oe.fieldPath,V.endAt):Zl(V,oe.fieldPath,V.endAt);G.push(De.value),L&&(L=De.inclusive)}return new vt(G,L)}(c,u),y=this.ln(u,c,d),I=this.ln(u,c,f),T=this.hn(u,c,h),S=this.Pn(u.indexId,l,y,d.inclusive,I,f.inclusive,T);return _.forEach(S,C=>r.j(C,t.limit).next(V=>{V.forEach(F=>{const G=v.fromSegments(F.documentKey);o.has(G)||(o=o.add(G),a.push(G))})}))}).next(()=>a)}return _.resolve(null)})}un(e){let t=this.an.get(e);return t||(t=0===e.filters.length?[e]:Bm(j.create(e.filters,"and")).map(r=>Oo(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.an.set(e,t),t)}Pn(e,t,r,i,s,o,a){const u=(null!=t?t.length:1)*Math.max(r.length,s.length),c=u/(null!=t?t.length:1),l=[];for(let h=0;h<u;++h){const d=t?this.In(t[h/c]):ts,f=this.Tn(e,d,r[h%c],i),y=this.En(e,d,s[h%c],o),I=a.map(T=>this.Tn(e,d,T,!0));l.push(...this.createRange(f,y,I))}return l}Tn(e,t,r,i){const s=new Ht(e,v.empty(),t,r);return i?s:s.Ht()}En(e,t,r,i){const s=new Ht(e,v.empty(),t,r);return i?s.Ht():s}cn(e,t){const r=new Zh(t),i=null!=t.collectionGroup?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let o=null;for(const a of s)r.en(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,t){let r=2;const i=this.un(t);return _.forEach(i,s=>this.cn(e,s).next(o=>{o?0!==r&&o.fields.length<function(u){let c=new K(Z.comparator),l=!1;for(const h of u.filters)for(const d of h.getFlattenedFilters())d.field.isKeyField()||("array-contains"===d.op||"array-contains-any"===d.op?l=!0:c=c.add(d.field));for(const h of u.orderBy)h.field.isKeyField()||(c=c.add(h.field));return c.size+(l?1:0)}(s)&&(r=1):r=0})).next(()=>null!==t.limit&&i.length>1&&2===r?1:r)}dn(e,t){const r=new Ur;for(const i of Lt(e)){const s=t.data.field(i.fieldPath);if(null==s)return null;const o=r.jt(i.kind);Wt.St.ht(s,o)}return r.Ut()}In(e){const t=new Ur;return Wt.St.ht(e,t.jt(0)),t.Ut()}An(e,t){const r=new Ur;return Wt.St.ht(Ut(this.databaseId,t),r.jt(function(s){const o=Lt(s);return 0===o.length?0:o[o.length-1].kind}(e))),r.Ut()}hn(e,t,r){if(null===r)return[];let i=[];i.push(new Ur);let s=0;for(const o of Lt(e)){const a=r[s++];for(const u of i)if(this.Rn(t,o.fieldPath)&&vr(a))i=this.Vn(i,o,a);else{const c=u.jt(o.kind);Wt.St.ht(a,c)}}return this.mn(i)}ln(e,t,r){return this.hn(e,t,r.position)}mn(e){const t=[];for(let r=0;r<e.length;++r)t[r]=e[r].Ut();return t}Vn(e,t,r){const i=[...e],s=[];for(const o of r.arrayValue.values||[])for(const a of i){const u=new Ur;u.seed(a.Ut()),Wt.St.ht(o,u.jt(t.kind)),s.push(u)}return s}Rn(e,t){return!!e.filters.find(r=>r instanceof O&&r.field.isEqual(t)&&("in"===r.op||"not-in"===r.op))}getFieldIndexes(e,t){const r=Gr(e),i=Cn(e);return(t?r.W("collectionGroupIndex",IDBKeyRange.bound(t,t)):r.W()).next(s=>{const o=[];return _.forEach(s,a=>i.get([a.indexId,this.uid]).next(u=>{o.push(function(l,h){const d=h?new pn(h.sequenceNumber,new Fe($t(h.readTime),new v(He(h.documentKey)),h.largestBatchId)):pn.empty(),f=l.fields.map(([y,I])=>new Bt(Z.fromServerFormat(y),I));return new gn(l.indexId,l.collectionGroup,f,d)}(a,u))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>0===t.length?null:(t.sort((r,i)=>{const s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return 0!==s?s:D(r.collectionGroup,i.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,r){const i=Gr(e),s=Cn(e);return this.fn(e).next(o=>i.W("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(a=>_.forEach(a,u=>s.put(Kh(u.indexId,this.user,o,r)))))}updateIndexEntries(e,t){const r=new Map;return _.forEach(t,(i,s)=>{const o=r.get(i.collectionGroup);return(o?_.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next(a=>(r.set(i.collectionGroup,a),_.forEach(a,u=>this.gn(e,i,u).next(c=>{const l=this.pn(s,u);return c.isEqual(l)?_.resolve():this.yn(e,s,u,c,l)}))))})}wn(e,t,r,i){return Vn(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.An(r,t.key),documentKey:t.key.path.toArray()})}Sn(e,t,r,i){return Vn(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.An(r,t.key),t.key.path.toArray()])}gn(e,t,r){const i=Vn(e);let s=new K(At);return i.Y({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.An(r,t)])},(o,a)=>{s=s.add(new Ht(r.indexId,t,a.arrayValue,a.directionalValue))}).next(()=>s)}pn(e,t){let r=new K(At);const i=this.dn(t,e);if(null==i)return r;const s=Ro(t);if(null!=s){const o=e.data.field(s.fieldPath);if(vr(o))for(const a of o.arrayValue.values||[])r=r.add(new Ht(t.indexId,e.key,this.In(a),i))}else r=r.add(new Ht(t.indexId,e.key,ts,i));return r}yn(e,t,r,i,s){x("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);const o=[];return function(u,c,l,h,d){const f=u.getIterator(),y=c.getIterator();let I=xn(f),T=xn(y);for(;I||T;){let S=!1,C=!1;if(I&&T){const V=l(I,T);V<0?C=!0:V>0&&(S=!0)}else null!=I?C=!0:S=!0;S?(h(T),T=xn(y)):C?(d(I),I=xn(f)):(I=xn(f),T=xn(y))}}(i,s,At,a=>{o.push(this.wn(e,t,r,a))},a=>{o.push(this.Sn(e,t,r,a))}),_.waitFor(o)}fn(e){let t=1;return Cn(e).Y({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),t=i.sequenceNumber+1}).next(()=>t)}createRange(e,t,r){r=r.sort((o,a)=>At(o,a)).filter((o,a,u)=>!a||0!==At(o,u[a-1]));const i=[];i.push(e);for(const o of r){const a=At(o,e),u=At(o,t);if(0===a)i[0]=e.Ht();else if(a>0&&u<0)i.push(o),i.push(o.Ht());else if(u>0)break}i.push(t);const s=[];for(let o=0;o<i.length;o+=2){if(this.bn(i[o],i[o+1]))return[];s.push(IDBKeyRange.bound([i[o].indexId,this.uid,i[o].arrayValue,i[o].directionalValue,ts,[]],[i[o+1].indexId,this.uid,i[o+1].arrayValue,i[o+1].directionalValue,ts,[]]))}return s}bn(e,t){return At(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(td)}getMinOffset(e,t){return _.mapArray(this.un(t),r=>this.cn(e,r).next(i=>i||A())).next(td)}}function ed(n){return _e(n,"collectionParents")}function Vn(n){return _e(n,"indexEntries")}function Gr(n){return _e(n,"indexConfiguration")}function Cn(n){return _e(n,"indexState")}function td(n){R(0!==n.length);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){const i=n[r].indexState.offset;Po(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new Fe(e.readTime,e.documentKey,t)}const nd={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class ve{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new ve(e,ve.DEFAULT_COLLECTION_PERCENTILE,ve.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}function rd(n,e,t){const r=n.store("mutations"),i=n.store("documentMutations"),s=[],o=IDBKeyRange.only(t.batchId);let a=0;const u=r.Y({range:o},(l,h,d)=>(a++,d.delete()));s.push(u.next(()=>{R(1===a)}));const c=[];for(const l of t.mutations){const h=bl(e,l.key.path,t.batchId);s.push(i.delete(h)),c.push(l.key)}return _.waitFor(s).next(()=>c)}function ns(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw A();e=n.noDocument}return JSON.stringify(e).length}ve.DEFAULT_COLLECTION_PERCENTILE=10,ve.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,ve.DEFAULT=new ve(41943040,ve.DEFAULT_COLLECTION_PERCENTILE,ve.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),ve.DISABLED=new ve(-1,0,0);class rs{constructor(e,t,r,i){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=i,this.Dn={}}static ct(e,t,r,i){R(""!==e.uid);const s=e.isAuthenticated()?e.uid:"";return new rs(s,t,r,i)}checkEmpty(e){let t=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return bt(e).Y({index:"userMutationsIndex",range:r},(i,s,o)=>{t=!1,o.done()}).next(()=>t)}addMutationBatch(e,t,r,i){const s=Dn(e),o=bt(e);return o.add({}).next(a=>{R("number"==typeof a);const u=new Go(a,t,r,i),c=function(f,y,I){const T=I.baseMutations.map(C=>Lr(f.ut,C)),S=I.mutations.map(C=>Lr(f.ut,C));return{userId:y,batchId:I.batchId,localWriteTimeMs:I.localWriteTime.toMillis(),baseMutations:T,mutations:S}}(this.serializer,this.userId,u),l=[];let h=new K((d,f)=>D(d.canonicalString(),f.canonicalString()));for(const d of i){const f=bl(this.userId,d.key.path,a);h=h.add(d.key.path.popLast()),l.push(o.put(c)),l.push(s.put(f,S0))}return h.forEach(d=>{l.push(this.indexManager.addToCollectionParentIndex(e,d))}),e.addOnCommittedListener(()=>{this.Dn[a]=u.keys()}),_.waitFor(l).next(()=>u)})}lookupMutationBatch(e,t){return bt(e).get(t).next(r=>r?(R(r.userId===this.userId),Qt(this.serializer,r)):null)}Cn(e,t){return this.Dn[t]?_.resolve(this.Dn[t]):this.lookupMutationBatch(e,t).next(r=>{if(r){const i=r.keys();return this.Dn[t]=i,i}return null})}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]);let s=null;return bt(e).Y({index:"userMutationsIndex",range:i},(o,a,u)=>{a.userId===this.userId&&(R(a.batchId>=r),s=Qt(this.serializer,a)),u.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=-1;return bt(e).Y({index:"userMutationsIndex",range:t,reverse:!0},(i,s,o)=>{r=s.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return bt(e).W("userMutationsIndex",t).next(r=>r.map(i=>Qt(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,t){const r=Oi(this.userId,t.path),i=IDBKeyRange.lowerBound(r),s=[];return Dn(e).Y({range:i},(o,a,u)=>{const[c,l,h]=o,d=He(l);if(c===this.userId&&t.path.isEqual(d))return bt(e).get(h).next(f=>{if(!f)throw A();R(f.userId===this.userId),s.push(Qt(this.serializer,f))});u.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new K(D);const i=[];return t.forEach(s=>{const o=Oi(this.userId,s.path),a=IDBKeyRange.lowerBound(o),u=Dn(e).Y({range:a},(c,l,h)=>{const[d,f,y]=c,I=He(f);d===this.userId&&s.path.isEqual(I)?r=r.add(y):h.done()});i.push(u)}),_.waitFor(i).next(()=>this.vn(e,r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1,s=Oi(this.userId,r),o=IDBKeyRange.lowerBound(s);let a=new K(D);return Dn(e).Y({range:o},(u,c,l)=>{const[h,d,f]=u,y=He(d);h===this.userId&&r.isPrefixOf(y)?y.length===i&&(a=a.add(f)):l.done()}).next(()=>this.vn(e,a))}vn(e,t){const r=[],i=[];return t.forEach(s=>{i.push(bt(e).get(s).next(o=>{if(null===o)throw A();R(o.userId===this.userId),r.push(Qt(this.serializer,o))}))}),_.waitFor(i).next(()=>r)}removeMutationBatch(e,t){return rd(e.ae,this.userId,t).next(r=>(e.addOnCommittedListener(()=>{this.Fn(t.batchId)}),_.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}Fn(e){delete this.Dn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return _.resolve();const r=IDBKeyRange.lowerBound([this.userId]),i=[];return Dn(e).Y({range:r},(s,o,a)=>{if(s[0]===this.userId){const u=He(s[1]);i.push(u)}else a.done()}).next(()=>{R(0===i.length)})})}containsKey(e,t){return id(e,this.userId,t)}Mn(e){return sd(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function id(n,e,t){const r=Oi(e,t.path),i=r[1],s=IDBKeyRange.lowerBound(r);let o=!1;return Dn(n).Y({range:s,J:!0},(a,u,c)=>{const[l,h,d]=a;l===e&&h===i&&(o=!0),c.done()}).next(()=>o)}function bt(n){return _e(n,"mutations")}function Dn(n){return _e(n,"documentMutations")}function sd(n){return _e(n,"mutationQueues")}class Zt{constructor(e){this.xn=e}next(){return this.xn+=2,this.xn}static On(){return new Zt(0)}static Nn(){return new Zt(-1)}}class Gm{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.Bn(e).next(t=>{const r=new Zt(t.highestTargetId);return t.highestTargetId=r.next(),this.Ln(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.Bn(e).next(t=>P.fromTimestamp(new J(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.Bn(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,r){return this.Bn(e).next(i=>(i.highestListenSequenceNumber=t,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.Ln(e,i)))}addTargetData(e,t){return this.kn(e,t).next(()=>this.Bn(e).next(r=>(r.targetCount+=1,this.qn(t,r),this.Ln(e,r))))}updateTargetData(e,t){return this.kn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>Nn(e).delete(t.targetId)).next(()=>this.Bn(e)).next(r=>(R(r.targetCount>0),r.targetCount-=1,this.Ln(e,r)))}removeTargets(e,t,r){let i=0;const s=[];return Nn(e).Y((o,a)=>{const u=Br(a);u.sequenceNumber<=t&&null===r.get(u.targetId)&&(i++,s.push(this.removeTargetData(e,u)))}).next(()=>_.waitFor(s)).next(()=>i)}forEachTarget(e,t){return Nn(e).Y((r,i)=>{const s=Br(i);t(s)})}Bn(e){return od(e).get("targetGlobalKey").next(t=>(R(null!==t),t))}Ln(e,t){return od(e).put("targetGlobalKey",t)}kn(e,t){return Nn(e).put(zh(this.serializer,t))}qn(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.Bn(e).next(t=>t.targetCount)}getTargetData(e,t){const r=Gt(t),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let s=null;return Nn(e).Y({range:i,index:"queryTargetsIndex"},(o,a,u)=>{const c=Br(a);br(t,c.target)&&(s=c,u.done())}).next(()=>s)}addMatchingKeys(e,t,r){const i=[],s=Rt(e);return t.forEach(o=>{const a=Ee(o.path);i.push(s.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,o))}),_.waitFor(i)}removeMatchingKeys(e,t,r){const i=Rt(e);return _.forEach(t,s=>{const o=Ee(s.path);return _.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,t){const r=Rt(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,t){const r=IDBKeyRange.bound([t],[t+1],!1,!0),i=Rt(e);let s=k();return i.Y({range:r,J:!0},(o,a,u)=>{const c=He(o[1]),l=new v(c);s=s.add(l)}).next(()=>s)}containsKey(e,t){const r=Ee(t.path),i=IDBKeyRange.bound([r],[pl(r)],!1,!0);let s=0;return Rt(e).Y({index:"documentTargetsIndex",J:!0,range:i},([o,a],u,c)=>{0!==o&&(s++,c.done())}).next(()=>s>0)}_t(e,t){return Nn(e).get(t).next(r=>r?Br(r):null)}}function Nn(n){return _e(n,"targets")}function od(n){return _e(n,"targetGlobal")}function Rt(n){return _e(n,"targetDocuments")}function ad([n,e],[t,r]){const i=D(n,t);return 0===i?D(e,r):i}class zm{constructor(e){this.Qn=e,this.buffer=new K(ad),this.Kn=0}$n(){return++this.Kn}Un(e){const t=[e,this.$n()];if(this.buffer.size<this.Qn)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();ad(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class ud{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Wn=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.Gn(6e4)}stop(){this.Wn&&(this.Wn.cancel(),this.Wn=null)}get started(){return null!==this.Wn}Gn(e){var t=this;x("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Wn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(0,g.Z)(function*(){t.Wn=null;try{yield t.localStore.collectGarbage(t.garbageCollector)}catch(r){gt(r)?x("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",r):yield mt(r)}yield t.Gn(3e5)}))}}class jm{constructor(e,t){this.zn=e,this.params=t}calculateTargetCount(e,t){return this.zn.jn(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(0===t)return _.resolve(Me._e);const r=new zm(t);return this.zn.forEachTarget(e,i=>r.Un(i.sequenceNumber)).next(()=>this.zn.Hn(e,i=>r.Un(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.zn.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.zn.removeOrphanedDocuments(e,t)}collect(e,t){return-1===this.params.cacheSizeCollectionThreshold?(x("LruGarbageCollector","Garbage collection skipped; disabled"),_.resolve(nd)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(x("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),nd):this.Jn(e,t))}getCacheSize(e){return this.zn.getCacheSize(e)}Jn(e,t){let r,i,s,o,a,u,c;const l=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(h=>(h>this.params.maximumSequenceNumbersToCollect?(x("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${h}`),i=this.params.maximumSequenceNumbersToCollect):i=h,o=Date.now(),this.nthSequenceNumber(e,i))).next(h=>(r=h,a=Date.now(),this.removeTargets(e,r,t))).next(h=>(s=h,u=Date.now(),this.removeOrphanedDocuments(e,r))).next(h=>(c=Date.now(),fn()<=Ke.in.DEBUG&&x("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${o-l}ms\n\tDetermined least recently used ${i} in `+(a-o)+`ms\n\tRemoved ${s} targets in `+(u-a)+`ms\n\tRemoved ${h} documents in `+(c-u)+`ms\nTotal Duration: ${c-l}ms`),_.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:h})))}}class Km{constructor(e,t){this.db=e,this.garbageCollector=function cd(n,e){return new jm(n,e)}(this,t)}jn(e){const t=this.Yn(e);return this.db.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}Yn(e){let t=0;return this.Hn(e,r=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Hn(e,t){return this.Zn(e,(r,i)=>t(i))}addReference(e,t,r){return is(e,r)}removeReference(e,t,r){return is(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return is(e,t)}Xn(e,t){return function(i,s){let o=!1;return sd(i).Z(a=>id(i,a,s).next(u=>(u&&(o=!0),_.resolve(!u)))).next(()=>o)}(e,t)}removeOrphanedDocuments(e,t){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let s=0;return this.Zn(e,(o,a)=>{if(a<=t){const u=this.Xn(e,o).next(c=>{if(!c)return s++,r.getEntry(e,o).next(()=>(r.removeEntry(o,P.min()),Rt(e).delete([0,Ee(o.path)])))});i.push(u)}}).next(()=>_.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return is(e,t)}Zn(e,t){const r=Rt(e);let i,s=Me._e;return r.Y({index:"documentTargetsIndex"},([o,a],{path:u,sequenceNumber:c})=>{0===o?(s!==Me._e&&t(new v(He(i)),s),s=c,i=u):s=Me._e}).next(()=>{s!==Me._e&&t(new v(He(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function is(n,e){return Rt(n).put((i=n.currentSequenceNumber,{targetId:0,path:Ee(e.path),sequenceNumber:i}));var i}class ld{constructor(){this.changes=new st(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Y.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return void 0!==r?_.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class $m{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return Yt(e).put(r)}removeEntry(e,t,r){return Yt(e).delete(function(s,o){const a=s.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],Xi(o),a[a.length-1]]}(t,r))}updateMetadata(e,t){return this.getMetadata(e).next(r=>(r.byteSize+=t,this.er(e,r)))}getEntry(e,t){let r=Y.newInvalidDocument(t);return Yt(e).Y({index:"documentKeyIndex",range:IDBKeyRange.only(zr(t))},(i,s)=>{r=this.tr(t,s)}).next(()=>r)}nr(e,t){let r={size:0,document:Y.newInvalidDocument(t)};return Yt(e).Y({index:"documentKeyIndex",range:IDBKeyRange.only(zr(t))},(i,s)=>{r={document:this.tr(t,s),size:ns(s)}}).next(()=>r)}getEntries(e,t){let r=Ce();return this.rr(e,t,(i,s)=>{const o=this.tr(i,s);r=r.insert(i,o)}).next(()=>r)}ir(e,t){let r=Ce(),i=new Q(v.comparator);return this.rr(e,t,(s,o)=>{const a=this.tr(s,o);r=r.insert(s,a),i=i.insert(s,ns(o))}).next(()=>({documents:r,sr:i}))}rr(e,t,r){if(t.isEmpty())return _.resolve();let i=new K(fd);t.forEach(u=>i=i.add(u));const s=IDBKeyRange.bound(zr(i.first()),zr(i.last())),o=i.getIterator();let a=o.getNext();return Yt(e).Y({index:"documentKeyIndex",range:s},(u,c,l)=>{const h=v.fromSegments([...c.prefixPath,c.collectionGroup,c.documentId]);for(;a&&fd(a,h)<0;)r(a,null),a=o.getNext();a&&a.isEqual(h)&&(r(a,c),a=o.hasNext()?o.getNext():null),a?l.U(zr(a)):l.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,t,r,i,s){const o=t.path,a=[o.popLast().toArray(),o.lastSegment(),Xi(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],u=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Yt(e).W(IDBKeyRange.bound(a,u,!0)).next(c=>{null==s||s.incrementDocumentReadCount(c.length);let l=Ce();for(const h of c){const d=this.tr(v.fromSegments(h.prefixPath.concat(h.collectionGroup,h.documentId)),h);d.isFoundDocument()&&(Pr(t,d)||i.has(d.key))&&(l=l.insert(d.key,d))}return l})}getAllFromCollectionGroup(e,t,r,i){let s=Ce();const o=_d(t,r),a=_d(t,Fe.max());return Yt(e).Y({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,a,!0)},(u,c,l)=>{const h=this.tr(v.fromSegments(c.prefixPath.concat(c.collectionGroup,c.documentId)),c);s=s.insert(h.key,h),s.size===i&&l.done()}).next(()=>s)}newChangeBuffer(e){return new Qm(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return dd(e).get("remoteDocumentGlobalKey").next(t=>(R(!!t),t))}er(e,t){return dd(e).put("remoteDocumentGlobalKey",t)}tr(e,t){if(t){const r=function Nm(n,e){let t;if(e.document)t=Fh(n.ut,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=v.fromSegments(e.noDocument.path),i=$t(e.noDocument.readTime);t=Y.newNoDocument(r,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return A();{const r=v.fromSegments(e.unknownDocument.path),i=$t(e.unknownDocument.version);t=Y.newUnknownDocument(r,i)}}return e.readTime&&t.setReadTime(function(i){const s=new J(i[0],i[1]);return P.fromTimestamp(s)}(e.readTime)),t}(this.serializer,t);if(!r.isNoDocument()||!r.version.isEqual(P.min()))return r}return Y.newInvalidDocument(e)}}function hd(n){return new $m(n)}class Qm extends ld{constructor(e,t){super(),this._r=e,this.trackRemovals=t,this.ar=new st(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){const t=[];let r=0,i=new K((s,o)=>D(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{const a=this.ar.get(s);if(t.push(this._r.removeEntry(e,s,a.readTime)),o.isValidDocument()){const u=Gh(this._r.serializer,o);i=i.add(s.path.popLast());const c=ns(u);r+=c-a.size,t.push(this._r.addEntry(e,s,u))}else if(r-=a.size,this.trackRemovals){const u=Gh(this._r.serializer,o.convertToNoDocument(P.min()));t.push(this._r.addEntry(e,s,u))}}),i.forEach(s=>{t.push(this._r.indexManager.addToCollectionParentIndex(e,s))}),t.push(this._r.updateMetadata(e,r)),_.waitFor(t)}getFromCache(e,t){return this._r.nr(e,t).next(r=>(this.ar.set(t,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,t){return this._r.ir(e,t).next(({documents:r,sr:i})=>(i.forEach((s,o)=>{this.ar.set(s,{size:o,readTime:r.get(s).readTime})}),r))}}function dd(n){return _e(n,"remoteDocumentGlobal")}function Yt(n){return _e(n,"remoteDocumentsV14")}function zr(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function _d(n,e){const t=e.documentKey.path.toArray();return[n,Xi(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function fd(n,e){const t=n.path.toArray(),r=e.path.toArray();let i=0;for(let s=0;s<t.length-2&&s<r.length-2;++s)if(i=D(t[s],r[s]),i)return i;return i=D(t.length,r.length),i||(i=D(t[t.length-2],r[r.length-2]),i||D(t[t.length-1],r[r.length-1]))}class Wm{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class md{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(null!==r&&Dr(r.mutation,i,Ve.empty(),J.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,k()).next(()=>r))}getLocalViewOfDocuments(e,t,r=k()){const i=Ye();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(s=>{let o=Sr();return s.forEach((a,u)=>{o=o.insert(a,u.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){const r=Ye();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,k()))}populateOverlays(e,t,r){const i=[];return r.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{t.set(o,a)})})}computeViews(e,t,r,i){let s=Ce();const o=Vr(),a=Vr();return t.forEach((u,c)=>{const l=r.get(c.key);i.has(c.key)&&(void 0===l||l.mutation instanceof ot)?s=s.insert(c.key,c):void 0!==l?(o.set(c.key,l.mutation.getFieldMask()),Dr(l.mutation,c,l.mutation.getFieldMask(),J.now())):o.set(c.key,Ve.empty())}),this.recalculateAndSaveOverlays(e,s).next(u=>(u.forEach((c,l)=>o.set(c,l)),t.forEach((c,l)=>{var h;return a.set(c,new Wm(l,null!==(h=o.get(c))&&void 0!==h?h:null))}),a))}recalculateAndSaveOverlays(e,t){const r=Vr();let i=new Q((o,a)=>o-a),s=k();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(const a of o)a.keys().forEach(u=>{const c=t.get(u);if(null===c)return;let l=r.get(u)||Ve.empty();l=a.applyToLocalView(c,l),r.set(u,l);const h=(i.get(a.batchId)||k()).add(u);i=i.insert(a.batchId,h)})}).next(()=>{const o=[],a=i.getReverseIterator();for(;a.hasNext();){const u=a.getNext(),c=u.key,l=u.value,h=oh();l.forEach(d=>{if(!s.has(d)){const f=mh(t.get(d),r.get(d));null!==f&&h.set(d,f),s=s.add(d)}}),o.push(this.documentOverlayCache.saveOverlays(e,c,h))}return _.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return v.isDocumentKey((o=t).path)&&null===o.collectionGroup&&0===o.filters.length?this.getDocumentsMatchingDocumentQuery(e,t.path):Lo(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i);var o}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):_.resolve(Ye());let a=-1,u=s;return o.next(c=>_.forEach(c,(l,h)=>(a<h.largestBatchId&&(a=h.largestBatchId),s.get(l)?_.resolve():this.remoteDocumentCache.getEntry(e,l).next(d=>{u=u.insert(l,d)}))).next(()=>this.populateOverlays(e,c,s)).next(()=>this.computeViews(e,u,c,k())).next(l=>({batchId:a,changes:sh(l)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new v(t)).next(r=>{let i=Sr();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){const s=t.collectionGroup;let o=Sr();return this.indexManager.getCollectionParents(e,s).next(a=>_.forEach(a,u=>{const c=(h=t,d=u.child(s),new it(d,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt));var h,d;return this.getDocumentsMatchingCollectionQuery(e,c,r,i).next(l=>{l.forEach((h,d)=>{o=o.insert(h,d)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,s,i))).next(o=>{s.forEach((u,c)=>{const l=c.getKey();null===o.get(l)&&(o=o.insert(l,Y.newInvalidDocument(l)))});let a=Sr();return o.forEach((u,c)=>{const l=s.get(u);void 0!==l&&Dr(l.mutation,c,Ve.empty(),J.now()),Pr(t,c)&&(a=a.insert(u,c))}),a})}}class Hm{constructor(e){this.serializer=e,this.ur=new Map,this.cr=new Map}getBundleMetadata(e,t){return _.resolve(this.ur.get(t))}saveBundleMetadata(e,t){return this.ur.set(t.id,{id:(i=t).id,version:i.version,createTime:se(i.createTime)}),_.resolve();var i}getNamedQuery(e,t){return _.resolve(this.cr.get(t))}saveNamedQuery(e,t){return this.cr.set(t.name,{name:(i=t).name,query:Yo(i.bundledQuery),readTime:se(i.readTime)}),_.resolve();var i}}class Zm{constructor(){this.overlays=new Q(v.comparator),this.lr=new Map}getOverlay(e,t){return _.resolve(this.overlays.get(t))}getOverlays(e,t){const r=Ye();return _.forEach(t,i=>this.getOverlay(e,i).next(s=>{null!==s&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,s)=>{this.lt(e,t,s)}),_.resolve()}removeOverlaysForBatchId(e,t,r){const i=this.lr.get(r);return void 0!==i&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.lr.delete(r)),_.resolve()}getOverlaysForCollection(e,t,r){const i=Ye(),s=t.length+1,o=new v(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const u=a.getNext().value,c=u.getKey();if(!t.isPrefixOf(c.path))break;c.path.length===s&&u.largestBatchId>r&&i.set(u.getKey(),u)}return _.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new Q((c,l)=>c-l);const o=this.overlays.getIterator();for(;o.hasNext();){const c=o.getNext().value;if(c.getKey().getCollectionGroup()===t&&c.largestBatchId>r){let l=s.get(c.largestBatchId);null===l&&(l=Ye(),s=s.insert(c.largestBatchId,l)),l.set(c.getKey(),c)}}const a=Ye(),u=s.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((c,l)=>a.set(c,l)),!(a.size()>=i)););return _.resolve(a)}lt(e,t,r){const i=this.overlays.get(r.key);if(null!==i){const o=this.lr.get(i.largestBatchId).delete(r.key);this.lr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new jo(t,r));let s=this.lr.get(t);void 0===s&&(s=k(),this.lr.set(t,s)),this.lr.set(t,s.add(r.key))}}class ia{constructor(){this.hr=new K(fe.Pr),this.Ir=new K(fe.Tr)}isEmpty(){return this.hr.isEmpty()}addReference(e,t){const r=new fe(e,t);this.hr=this.hr.add(r),this.Ir=this.Ir.add(r)}Er(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.dr(new fe(e,t))}Ar(e,t){e.forEach(r=>this.removeReference(r,t))}Rr(e){const t=new v(new B([])),r=new fe(t,e),i=new fe(t,e+1),s=[];return this.Ir.forEachInRange([r,i],o=>{this.dr(o),s.push(o.key)}),s}Vr(){this.hr.forEach(e=>this.dr(e))}dr(e){this.hr=this.hr.delete(e),this.Ir=this.Ir.delete(e)}mr(e){const t=new v(new B([])),r=new fe(t,e),i=new fe(t,e+1);let s=k();return this.Ir.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){const t=new fe(e,0),r=this.hr.firstAfterOrEqual(t);return null!==r&&e.isEqual(r.key)}}class fe{constructor(e,t){this.key=e,this.gr=t}static Pr(e,t){return v.comparator(e.key,t.key)||D(e.gr,t.gr)}static Tr(e,t){return D(e.gr,t.gr)||v.comparator(e.key,t.key)}}class Ym{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.pr=1,this.yr=new K(fe.Pr)}checkEmpty(e){return _.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,r,i){const s=this.pr;this.pr++;const o=new Go(s,t,r,i);this.mutationQueue.push(o);for(const a of i)this.yr=this.yr.add(new fe(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return _.resolve(o)}lookupMutationBatch(e,t){return _.resolve(this.wr(t))}getNextMutationBatchAfterBatchId(e,t){const i=this.Sr(t+1),s=i<0?0:i;return _.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return _.resolve(0===this.mutationQueue.length?-1:this.pr-1)}getAllMutationBatches(e){return _.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new fe(t,0),i=new fe(t,Number.POSITIVE_INFINITY),s=[];return this.yr.forEachInRange([r,i],o=>{const a=this.wr(o.gr);s.push(a)}),_.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new K(D);return t.forEach(i=>{const s=new fe(i,0),o=new fe(i,Number.POSITIVE_INFINITY);this.yr.forEachInRange([s,o],a=>{r=r.add(a.gr)})}),_.resolve(this.br(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1;let s=r;v.isDocumentKey(s)||(s=s.child(""));const o=new fe(new v(s),0);let a=new K(D);return this.yr.forEachWhile(u=>{const c=u.key.path;return!!r.isPrefixOf(c)&&(c.length===i&&(a=a.add(u.gr)),!0)},o),_.resolve(this.br(a))}br(e){const t=[];return e.forEach(r=>{const i=this.wr(r);null!==i&&t.push(i)}),t}removeMutationBatch(e,t){R(0===this.Dr(t.batchId,"removed")),this.mutationQueue.shift();let r=this.yr;return _.forEach(t.mutations,i=>{const s=new fe(i.key,t.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.yr=r})}Fn(e){}containsKey(e,t){const r=new fe(t,0),i=this.yr.firstAfterOrEqual(r);return _.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return _.resolve()}Dr(e,t){return this.Sr(e)}Sr(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}wr(e){const t=this.Sr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class Xm{constructor(e){this.Cr=e,this.docs=new Q(v.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,i=this.docs.get(r),s=i?i.size:0,o=this.Cr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return _.resolve(r?r.document.mutableCopy():Y.newInvalidDocument(t))}getEntries(e,t){let r=Ce();return t.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():Y.newInvalidDocument(i))}),_.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let s=Ce();const o=t.path,a=new v(o.child("")),u=this.docs.getIteratorFrom(a);for(;u.hasNext();){const{key:c,value:{document:l}}=u.getNext();if(!o.isPrefixOf(c.path))break;c.path.length>o.length+1||Po(yl(l),r)<=0||(i.has(l.key)||Pr(t,l))&&(s=s.insert(l.key,l.mutableCopy()))}return _.resolve(s)}getAllFromCollectionGroup(e,t,r,i){A()}vr(e,t){return _.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new Jm(this)}getSize(e){return _.resolve(this.size)}}class Jm extends ld{constructor(e){super(),this._r=e}applyChanges(e){const t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this._r.addEntry(e,i)):this._r.removeEntry(r)}),_.waitFor(t)}getFromCache(e,t){return this._r.getEntry(e,t)}getAllFromCache(e,t){return this._r.getEntries(e,t)}}class eg{constructor(e){this.persistence=e,this.Fr=new st(t=>Gt(t),br),this.lastRemoteSnapshotVersion=P.min(),this.highestTargetId=0,this.Mr=0,this.Or=new ia,this.targetCount=0,this.Nr=Zt.On()}forEachTarget(e,t){return this.Fr.forEach((r,i)=>t(i)),_.resolve()}getLastRemoteSnapshotVersion(e){return _.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return _.resolve(this.Mr)}allocateTargetId(e){return this.highestTargetId=this.Nr.next(),_.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Mr&&(this.Mr=t),_.resolve()}kn(e){this.Fr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.Nr=new Zt(t),this.highestTargetId=t),e.sequenceNumber>this.Mr&&(this.Mr=e.sequenceNumber)}addTargetData(e,t){return this.kn(t),this.targetCount+=1,_.resolve()}updateTargetData(e,t){return this.kn(t),_.resolve()}removeTargetData(e,t){return this.Fr.delete(t.target),this.Or.Rr(t.targetId),this.targetCount-=1,_.resolve()}removeTargets(e,t,r){let i=0;const s=[];return this.Fr.forEach((o,a)=>{a.sequenceNumber<=t&&null===r.get(a.targetId)&&(this.Fr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),_.waitFor(s).next(()=>i)}getTargetCount(e){return _.resolve(this.targetCount)}getTargetData(e,t){const r=this.Fr.get(t)||null;return _.resolve(r)}addMatchingKeys(e,t,r){return this.Or.Er(t,r),_.resolve()}removeMatchingKeys(e,t,r){this.Or.Ar(t,r);const i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),_.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.Or.Rr(t),_.resolve()}getMatchingKeysForTargetId(e,t){const r=this.Or.mr(t);return _.resolve(r)}containsKey(e,t){return _.resolve(this.Or.containsKey(t))}}class sa{constructor(e,t){this.Br={},this.overlays={},this.Lr=new Me(0),this.kr=!1,this.kr=!0,this.referenceDelegate=e(this),this.qr=new eg(this),this.indexManager=new qm,this.remoteDocumentCache=new Xm(r=>this.referenceDelegate.Qr(r)),this.serializer=new Uh(t),this.Kr=new Hm(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.kr=!1,Promise.resolve()}get started(){return this.kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Zm,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.Br[e.toKey()];return r||(r=new Ym(t,this.referenceDelegate),this.Br[e.toKey()]=r),r}getTargetCache(){return this.qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Kr}runTransaction(e,t,r){x("MemoryPersistence","Starting transaction:",e);const i=new tg(this.Lr.next());return this.referenceDelegate.$r(),r(i).next(s=>this.referenceDelegate.Ur(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Wr(e,t){return _.or(Object.values(this.Br).map(r=>()=>r.containsKey(e,t)))}}class tg extends Tl{constructor(e){super(),this.currentSequenceNumber=e}}class ss{constructor(e){this.persistence=e,this.Gr=new ia,this.zr=null}static jr(e){return new ss(e)}get Hr(){if(this.zr)return this.zr;throw A()}addReference(e,t,r){return this.Gr.addReference(r,t),this.Hr.delete(r.toString()),_.resolve()}removeReference(e,t,r){return this.Gr.removeReference(r,t),this.Hr.add(r.toString()),_.resolve()}markPotentiallyOrphaned(e,t){return this.Hr.add(t.toString()),_.resolve()}removeTarget(e,t){this.Gr.Rr(t.targetId).forEach(i=>this.Hr.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.Hr.add(s.toString()))}).next(()=>r.removeTargetData(e,t))}$r(){this.zr=new Set}Ur(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return _.forEach(this.Hr,r=>{const i=v.fromPath(r);return this.Jr(e,i).next(s=>{s||t.removeEntry(i,P.min())})}).next(()=>(this.zr=null,t.apply(e)))}updateLimboDocument(e,t){return this.Jr(e,t).next(r=>{r?this.Hr.delete(t.toString()):this.Hr.add(t.toString())})}Qr(e){return 0}Jr(e,t){return _.or([()=>_.resolve(this.Gr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Wr(e,t)])}}class ng{constructor(e){this.serializer=e}N(e,t,r,i){const s=new Mi("createOrUpgrade",t);var u;r<1&&i>=1&&(e.createObjectStore("owner"),(u=e).createObjectStore("mutationQueues",{keyPath:"userId"}),u.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Al,{unique:!0}),u.createObjectStore("documentMutations"),gd(e),function(u){u.createObjectStore("remoteDocuments")}(e));let o=_.resolve();return r<3&&i>=3&&(0!==r&&(function(u){u.deleteObjectStore("targetDocuments"),u.deleteObjectStore("targets"),u.deleteObjectStore("targetGlobal")}(e),gd(e)),o=o.next(()=>function(u){const c=u.store("targetGlobal"),l={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:P.min().toTimestamp(),targetCount:0};return c.put("targetGlobalKey",l)}(s))),r<4&&i>=4&&(0!==r&&(o=o.next(()=>function(u,c){return c.store("mutations").W().next(l=>{u.deleteObjectStore("mutations"),u.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Al,{unique:!0});const h=c.store("mutations"),d=l.map(f=>h.put(f));return _.waitFor(d)})}(e,s))),o=o.next(()=>{!function(u){u.createObjectStore("clientMetadata",{keyPath:"clientId"})}(e)})),r<5&&i>=5&&(o=o.next(()=>this.Zr(s))),r<6&&i>=6&&(o=o.next(()=>(function(u){u.createObjectStore("remoteDocumentGlobal")}(e),this.Xr(s)))),r<7&&i>=7&&(o=o.next(()=>this.ei(s))),r<8&&i>=8&&(o=o.next(()=>this.ti(e,s))),r<9&&i>=9&&(o=o.next(()=>{!function(u){u.objectStoreNames.contains("remoteDocumentChanges")&&u.deleteObjectStore("remoteDocumentChanges")}(e)})),r<10&&i>=10&&(o=o.next(()=>this.ni(s))),r<11&&i>=11&&(o=o.next(()=>{(function(u){u.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(u){u.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(o=o.next(()=>{!function(u){const c=u.createObjectStore("documentOverlays",{keyPath:U0});c.createIndex("collectionPathOverlayIndex",G0,{unique:!1}),c.createIndex("collectionGroupOverlayIndex",z0,{unique:!1})}(e)})),r<13&&i>=13&&(o=o.next(()=>function(u){const c=u.createObjectStore("remoteDocumentsV14",{keyPath:V0});c.createIndex("documentKeyIndex",C0),c.createIndex("collectionGroupIndex",D0)}(e)).next(()=>this.ri(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(o=o.next(()=>this.ii(e,s))),r<15&&i>=15&&(o=o.next(()=>function(u){u.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),u.createObjectStore("indexState",{keyPath:O0}).createIndex("sequenceNumberIndex",L0,{unique:!1}),u.createObjectStore("indexEntries",{keyPath:B0}).createIndex("documentKeyIndex",q0,{unique:!1})}(e))),o}Xr(e){let t=0;return e.store("remoteDocuments").Y((r,i)=>{t+=ns(i)}).next(()=>{const r={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}Zr(e){const t=e.store("mutationQueues"),r=e.store("mutations");return t.W().next(i=>_.forEach(i,s=>{const o=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return r.W("userMutationsIndex",o).next(a=>_.forEach(a,u=>{R(u.userId===s.userId);const c=Qt(this.serializer,u);return rd(e,s.userId,c).next(()=>{})}))}))}ei(e){const t=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{const s=[];return r.Y((o,a)=>{const u=new B(o),c=[0,Ee(u)];s.push(t.get(c).next(l=>l?_.resolve():t.put({targetId:0,path:Ee(u),sequenceNumber:i.highestListenSequenceNumber})))}).next(()=>_.waitFor(s))})}ti(e,t){e.createObjectStore("collectionParents",{keyPath:M0});const r=t.store("collectionParents"),i=new ra,s=o=>{if(i.add(o)){const a=o.lastSegment(),u=o.popLast();return r.put({collectionId:a,parent:Ee(u)})}};return t.store("remoteDocuments").Y({J:!0},(o,a)=>{const u=new B(o);return s(u.popLast())}).next(()=>t.store("documentMutations").Y({J:!0},([o,a,u],c)=>{const l=He(a);return s(l.popLast())}))}ni(e){const t=e.store("targets");return t.Y((r,i)=>{const s=Br(i),o=zh(this.serializer,s);return t.put(o)})}ri(e,t){const r=t.store("remoteDocuments"),i=[];return r.Y((s,o)=>{const a=t.store("remoteDocumentsV14"),u=(h=o,h.document?new v(B.fromString(h.document.name).popFirst(5)):h.noDocument?v.fromSegments(h.noDocument.path):h.unknownDocument?v.fromSegments(h.unknownDocument.path):A()).path.toArray(),c={prefixPath:u.slice(0,u.length-2),collectionGroup:u[u.length-2],documentId:u[u.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};var h;i.push(a.put(c))}).next(()=>_.waitFor(i))}ii(e,t){const r=t.store("mutations"),i=hd(this.serializer),s=new sa(ss.jr,this.serializer.ut);return r.W().next(o=>{const a=new Map;return o.forEach(u=>{var c;let l=null!==(c=a.get(u.userId))&&void 0!==c?c:k();Qt(this.serializer,u).keys().forEach(h=>l=l.add(h)),a.set(u.userId,l)}),_.forEach(a,(u,c)=>{const l=new de(c),h=Ji.ct(this.serializer,l),d=s.getIndexManager(l),f=rs.ct(l,this.serializer,d,s.referenceDelegate);return new md(i,f,h,d).recalculateAndSaveOverlaysForDocumentKeys(new Co(t,Me._e),u).next()})})}}function gd(n){n.createObjectStore("targetDocuments",{keyPath:k0}).createIndex("documentTargetsIndex",F0,{unique:!0}),n.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",N0,{unique:!0}),n.createObjectStore("targetGlobal")}const oa="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class aa{constructor(e,t,r,i,s,o,a,u,c,l,h=15){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.si=s,this.window=o,this.document=a,this.oi=c,this._i=l,this.ai=h,this.Lr=null,this.kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ui=null,this.inForeground=!1,this.ci=null,this.li=null,this.hi=Number.NEGATIVE_INFINITY,this.Pi=d=>Promise.resolve(),!aa.D())throw new p(m.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new Km(this,i),this.Ii=t+"main",this.serializer=new Uh(u),this.Ti=new ze(this.Ii,this.ai,new ng(this.serializer)),this.qr=new Gm(this.referenceDelegate,this.serializer),this.remoteDocumentCache=hd(this.serializer),this.Kr=new km,this.window&&this.window.localStorage?this.Ei=this.window.localStorage:(this.Ei=null,!1===l&&ie("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.di().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new p(m.FAILED_PRECONDITION,oa);return this.Ai(),this.Ri(),this.Vi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.qr.getHighestSequenceNumber(e))}).then(e=>{this.Lr=new Me(e,this.oi)}).then(()=>{this.kr=!0}).catch(e=>(this.Ti&&this.Ti.close(),Promise.reject(e)))}mi(e){var t=this;return this.Pi=function(){var r=(0,g.Z)(function*(i){if(t.started)return e(i)});return function(i){return r.apply(this,arguments)}}(),e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ti.L(function(){var t=(0,g.Z)(function*(r){null===r.newVersion&&(yield e())});return function(r){return t.apply(this,arguments)}}())}setNetworkEnabled(e){var t=this;this.networkEnabled!==e&&(this.networkEnabled=e,this.si.enqueueAndForget((0,g.Z)(function*(){t.started&&(yield t.di())})))}di(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>as(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.fi(e).next(t=>{t||(this.isPrimary=!1,this.si.enqueueRetryable(()=>this.Pi(!1)))})}).next(()=>this.gi(e)).next(t=>this.isPrimary&&!t?this.pi(e).next(()=>!1):!!t&&this.yi(e).next(()=>!0))).catch(e=>{if(gt(e))return x("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return x("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.si.enqueueRetryable(()=>this.Pi(e)),this.isPrimary=e})}fi(e){return jr(e).get("owner").next(t=>_.resolve(this.wi(t)))}Si(e){return as(e).delete(this.clientId)}bi(){var e=this;return(0,g.Z)(function*(){if(e.isPrimary&&!e.Di(e.hi,18e5)){e.hi=Date.now();const t=yield e.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",r=>{const i=_e(r,"clientMetadata");return i.W().next(s=>{const o=e.Ci(s,18e5),a=s.filter(u=>-1===o.indexOf(u));return _.forEach(a,u=>i.delete(u.clientId)).next(()=>a)})}).catch(()=>[]);if(e.Ei)for(const r of t)e.Ei.removeItem(e.vi(r.clientId))}})()}Vi(){this.li=this.si.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.di().then(()=>this.bi()).then(()=>this.Vi()))}wi(e){return!!e&&e.ownerId===this.clientId}gi(e){return this._i?_.resolve(!0):jr(e).get("owner").next(t=>{if(null!==t&&this.Di(t.leaseTimestampMs,5e3)&&!this.Fi(t.ownerId)){if(this.wi(t)&&this.networkEnabled)return!0;if(!this.wi(t)){if(!t.allowTabSynchronization)throw new p(m.FAILED_PRECONDITION,oa);return!1}}return!(!this.networkEnabled||!this.inForeground)||as(e).W().next(r=>void 0===this.Ci(r,5e3).find(i=>!(this.clientId===i.clientId||!(!this.networkEnabled&&i.networkEnabled||!this.inForeground&&i.inForeground&&this.networkEnabled===i.networkEnabled))))}).next(t=>(this.isPrimary!==t&&x("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}shutdown(){var e=this;return(0,g.Z)(function*(){e.kr=!1,e.Mi(),e.li&&(e.li.cancel(),e.li=null),e.xi(),e.Oi(),yield e.Ti.runTransaction("shutdown","readwrite",["owner","clientMetadata"],t=>{const r=new Co(t,Me._e);return e.pi(r).next(()=>e.Si(r))}),e.Ti.close(),e.Ni()})()}Ci(e,t){return e.filter(r=>this.Di(r.updateTimeMs,t)&&!this.Fi(r.clientId))}Bi(){return this.runTransaction("getActiveClients","readonly",e=>as(e).W().next(t=>this.Ci(t,18e5).map(r=>r.clientId)))}get started(){return this.kr}getMutationQueue(e,t){return rs.ct(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new Um(e,this.serializer.ut.databaseId)}getDocumentOverlayCache(e){return Ji.ct(this.serializer,e)}getBundleCache(){return this.Kr}runTransaction(e,t,r){x("IndexedDbPersistence","Starting transaction:",e);const i="readonly"===t?"readonly":"readwrite",s=15===(u=this.ai)?K0:14===u?Sl:13===u?Pl:12===u?j0:11===u?Rl:void A();var u;let o;return this.Ti.runTransaction(e,i,s,a=>(o=new Co(a,this.Lr?this.Lr.next():Me._e),"readwrite-primary"===t?this.fi(o).next(u=>!!u||this.gi(o)).next(u=>{if(!u)throw ie(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.si.enqueueRetryable(()=>this.Pi(!1)),new p(m.FAILED_PRECONDITION,Il);return r(o)}).next(u=>this.yi(o).next(()=>u)):this.Li(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}Li(e){return jr(e).get("owner").next(t=>{if(null!==t&&this.Di(t.leaseTimestampMs,5e3)&&!this.Fi(t.ownerId)&&!this.wi(t)&&!(this._i||this.allowTabSynchronization&&t.allowTabSynchronization))throw new p(m.FAILED_PRECONDITION,oa)})}yi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return jr(e).put("owner",t)}static D(){return ze.D()}pi(e){const t=jr(e);return t.get("owner").next(r=>this.wi(r)?(x("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):_.resolve())}Di(e,t){const r=Date.now();return!(e<r-t||e>r&&(ie(`Detected an update time that is in the future: ${e} > ${r}`),1))}Ai(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.ci=()=>{this.si.enqueueAndForget(()=>(this.inForeground="visible"===this.document.visibilityState,this.di()))},this.document.addEventListener("visibilitychange",this.ci),this.inForeground="visible"===this.document.visibilityState)}xi(){this.ci&&(this.document.removeEventListener("visibilitychange",this.ci),this.ci=null)}Ri(){var e;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.ui=()=>{this.Mi();const t=/(?:Version|Mobile)\/1[456]/;(0,$.G6)()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.si.enterRestrictedMode(!0),this.si.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.ui))}Oi(){this.ui&&(this.window.removeEventListener("pagehide",this.ui),this.ui=null)}Fi(e){var t;try{const r=null!==(null===(t=this.Ei)||void 0===t?void 0:t.getItem(this.vi(e)));return x("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return ie("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Mi(){if(this.Ei)try{this.Ei.setItem(this.vi(this.clientId),String(Date.now()))}catch(e){ie("Failed to set zombie client id.",e)}}Ni(){if(this.Ei)try{this.Ei.removeItem(this.vi(this.clientId))}catch{}}vi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function jr(n){return _e(n,"owner")}function as(n){return _e(n,"clientMetadata")}function ua(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}class ca{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.ki=r,this.qi=i}static Qi(e,t){let r=k(),i=k();for(const s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new ca(e,t.fromCache,r,i)}}class rg{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class pd{constructor(){this.Ki=!1,this.$i=!1,this.Ui=100,this.Wi=8}initialize(e,t){this.Gi=e,this.indexManager=t,this.Ki=!0}getDocumentsMatchingQuery(e,t,r,i){const s={result:null};return this.zi(e,t).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.ji(e,t,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new rg;return this.Hi(e,t,o).next(a=>{if(s.result=a,this.$i)return this.Ji(e,t,o,a.size)})}).next(()=>s.result)}Ji(e,t,r,i){return r.documentReadCount<this.Ui?(fn()<=Ke.in.DEBUG&&x("QueryEngine","SDK will not create cache indexes for query:",vn(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Ui,"documents"),_.resolve()):(fn()<=Ke.in.DEBUG&&x("QueryEngine","Query:",vn(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Wi*i?(fn()<=Ke.in.DEBUG&&x("QueryEngine","The SDK decides to create cache indexes for query:",vn(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,be(t))):_.resolve())}zi(e,t){if(Jl(t))return _.resolve(null);let r=be(t);return this.indexManager.getIndexType(e,r).next(i=>0===i?null:(null!==t.limit&&1===i&&(t=$i(t,null,"F"),r=be(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const o=k(...s);return this.Gi.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(u=>{const c=this.Yi(t,a);return this.Zi(t,c,o,u.readTime)?this.zi(e,$i(t,null,"F")):this.Xi(e,c,t,u)}))})))}ji(e,t,r,i){return Jl(t)||i.isEqual(P.min())?_.resolve(null):this.Gi.getDocuments(e,r).next(s=>{const o=this.Yi(t,s);return this.Zi(t,o,r,i)?_.resolve(null):(fn()<=Ke.in.DEBUG&&x("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),vn(t)),this.Xi(e,o,t,xl(i,-1)).next(a=>a))})}Yi(e,t){let r=new K(rh(e));return t.forEach((i,s)=>{Pr(e,s)&&(r=r.add(s))}),r}Zi(e,t,r,i){if(null===e.limit)return!1;if(r.size!==t.size)return!0;const s="F"===e.limitType?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Hi(e,t,r){return fn()<=Ke.in.DEBUG&&x("QueryEngine","Using full collection scan to execute query:",vn(t)),this.Gi.getDocumentsMatchingQuery(e,t,Fe.min(),r)}Xi(e,t,r,i){return this.Gi.getDocumentsMatchingQuery(e,r,i).next(s=>(t.forEach(o=>{s=s.insert(o.key,o)}),s))}}class ig{constructor(e,t,r,i){this.persistence=e,this.es=t,this.serializer=i,this.ts=new Q(D),this.ns=new st(s=>Gt(s),br),this.rs=new Map,this.ss=e.getRemoteDocumentCache(),this.qr=e.getTargetCache(),this.Kr=e.getBundleCache(),this.os(r)}os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new md(this.ss,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.ss.setIndexManager(this.indexManager),this.es.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.ts))}}function xd(n,e,t,r){return new ig(n,e,t,r)}function yd(n,e){return la.apply(this,arguments)}function la(){return la=(0,g.Z)(function*(n,e){const t=E(n);return yield t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,t.os(e),t.mutationQueue.getAllMutationBatches(r))).next(s=>{const o=[],a=[];let u=k();for(const c of i){o.push(c.batchId);for(const l of c.mutations)u=u.add(l.key)}for(const c of s){a.push(c.batchId);for(const l of c.mutations)u=u.add(l.key)}return t.localDocuments.getDocuments(r,u).next(c=>({_s:c,removedBatchIds:o,addedBatchIds:a}))})})}),la.apply(this,arguments)}function Id(n){const e=E(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.qr.getLastRemoteSnapshotVersion(t))}function Td(n,e,t){let r=k(),i=k();return t.forEach(s=>r=r.add(s)),e.getEntries(n,r).next(s=>{let o=Ce();return t.forEach((a,u)=>{const c=s.get(a);u.isFoundDocument()!==c.isFoundDocument()&&(i=i.add(a)),u.isNoDocument()&&u.version.isEqual(P.min())?(e.removeEntry(a,u.readTime),o=o.insert(a,u)):!c.isValidDocument()||u.version.compareTo(c.version)>0||0===u.version.compareTo(c.version)&&c.hasPendingWrites?(e.addEntry(u),o=o.insert(a,u)):x("LocalStore","Ignoring outdated watch update for ",a,". Current version:",c.version," Watch version:",u.version)}),{us:o,cs:i}})}function ag(n,e){const t=E(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(void 0===e&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function kn(n,e){const t=E(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.qr.getTargetData(r,e).next(s=>s?(i=s,_.resolve(i)):t.qr.allocateTargetId(r).next(o=>(i=new at(e,o,"TargetPurposeListen",r.currentSequenceNumber),t.qr.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=t.ts.get(r.targetId);return(null===i||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.ts=t.ts.insert(r.targetId,r),t.ns.set(e,r.targetId)),r})}function Fn(n,e,t){return ha.apply(this,arguments)}function ha(){return ha=(0,g.Z)(function*(n,e,t){const r=E(n),i=r.ts.get(e),s=t?"readwrite":"readwrite-primary";try{t||(yield r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i)))}catch(o){if(!gt(o))throw o;x("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.ts=r.ts.remove(e),r.ns.delete(i.target)}),ha.apply(this,arguments)}function us(n,e,t){const r=E(n);let i=P.min(),s=k();return r.persistence.runTransaction("Execute query","readwrite",o=>function(u,c,l){const h=E(u),d=h.ns.get(l);return void 0!==d?_.resolve(h.ts.get(d)):h.qr.getTargetData(c,l)}(r,o,be(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.qr.getMatchingKeysForTargetId(o,a.targetId).next(u=>{s=u})}).next(()=>r.es.getDocumentsMatchingQuery(o,e,t?i:P.min(),t?s:k())).next(a=>(wd(r,nh(e),a),{documents:a,ls:s})))}function Ed(n,e){const t=E(n),r=E(t.qr),i=t.ts.get(e);return i?Promise.resolve(i.target):t.persistence.runTransaction("Get target data","readonly",s=>r._t(s,e).next(o=>o?o.target:null))}function vd(n,e){const t=E(n),r=t.rs.get(e)||P.min();return t.persistence.runTransaction("Get new document changes","readonly",i=>t.ss.getAllFromCollectionGroup(i,e,xl(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>(wd(t,e,i),i))}function wd(n,e,t){let r=n.rs.get(e)||P.min();t.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),n.rs.set(e,r)}function da(){return da=(0,g.Z)(function*(n,e,t,r){const i=E(n);let s=k(),o=Ce();for(const c of t){const l=e.hs(c.metadata.name);c.document&&(s=s.add(l));const h=e.Ps(c);h.setReadTime(e.Is(c.metadata.readTime)),o=o.insert(l,h)}const a=i.ss.newChangeBuffer({trackRemovals:!0}),u=yield kn(i,(l=r,be(Tn(B.fromString(`__bundle__/docs/${l}`)))));var l;return i.persistence.runTransaction("Apply bundle documents","readwrite",c=>Td(c,a,o).next(l=>(a.apply(c),l)).next(l=>i.qr.removeMatchingKeysForTargetId(c,u.targetId).next(()=>i.qr.addMatchingKeys(c,s,u.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(c,l.us,l.cs)).next(()=>l.us)))}),da.apply(this,arguments)}function cg(n,e){return _a.apply(this,arguments)}function _a(){return _a=(0,g.Z)(function*(n,e,t=k()){const r=yield kn(n,be(Yo(e.bundledQuery))),i=E(n);return i.persistence.runTransaction("Save named query","readwrite",s=>{const o=se(e.readTime);if(r.snapshotVersion.compareTo(o)>=0)return i.Kr.saveNamedQuery(s,e);const a=r.withResumeToken(ce.EMPTY_BYTE_STRING,o);return i.ts=i.ts.insert(a.targetId,a),i.qr.updateTargetData(s,a).next(()=>i.qr.removeMatchingKeysForTargetId(s,r.targetId)).next(()=>i.qr.addMatchingKeys(s,t,r.targetId)).next(()=>i.Kr.saveNamedQuery(s,e))})}),_a.apply(this,arguments)}function Ad(n,e){return`firestore_clients_${n}_${e}`}function bd(n,e,t){let r=`firestore_mutations_${n}_${t}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function fa(n,e){return`firestore_targets_${n}_${e}`}class cs{constructor(e,t,r,i){this.user=e,this.batchId=t,this.state=r,this.error=i}static Ts(e,t,r){const i=JSON.parse(r);let s,o="object"==typeof i&&-1!==["pending","acknowledged","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code,o&&(s=new p(i.error.code,i.error.message))),o?new cs(e,t,i.state,s):(ie("SharedClientState",`Failed to parse mutation state for ID '${t}': ${r}`),null)}Es(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Kr{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static Ts(e,t){const r=JSON.parse(t);let i,s="object"==typeof r&&-1!==["not-current","current","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error);return s&&r.error&&(s="string"==typeof r.error.message&&"string"==typeof r.error.code,s&&(i=new p(r.error.code,r.error.message))),s?new Kr(e,r.state,i):(ie("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}Es(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class ls{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Ts(e,t){const r=JSON.parse(t);let i="object"==typeof r&&r.activeTargetIds instanceof Array,s=qo();for(let o=0;i&&o<r.activeTargetIds.length;++o)i=vl(r.activeTargetIds[o]),s=s.add(r.activeTargetIds[o]);return i?new ls(e,s):(ie("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}}class ma{constructor(e,t){this.clientId=e,this.onlineState=t}static Ts(e){const t=JSON.parse(e);return"object"==typeof t&&-1!==["Unknown","Online","Offline"].indexOf(t.onlineState)&&"string"==typeof t.clientId?new ma(t.clientId,t.onlineState):(ie("SharedClientState",`Failed to parse online state: ${e}`),null)}}class ga{constructor(){this.activeTargetIds=qo()}ds(e){this.activeTargetIds=this.activeTargetIds.add(e)}As(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Es(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class pa{constructor(e,t,r,i,s){this.window=e,this.si=t,this.persistenceKey=r,this.Rs=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Vs=this.fs.bind(this),this.gs=new Q(D),this.started=!1,this.ps=[];const o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.ys=Ad(this.persistenceKey,this.Rs),this.ws=`firestore_sequence_number_${this.persistenceKey}`,this.gs=this.gs.insert(this.Rs,new ga),this.Ss=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.bs=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.Ds=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.Cs=`firestore_online_state_${this.persistenceKey}`,this.vs=function(u){return`firestore_bundle_loaded_v2_${u}`}(this.persistenceKey),this.window.addEventListener("storage",this.Vs)}static D(e){return!(!e||!e.localStorage)}start(){var e=this;return(0,g.Z)(function*(){const t=yield e.syncEngine.Bi();for(const i of t){if(i===e.Rs)continue;const s=e.getItem(Ad(e.persistenceKey,i));if(s){const o=ls.Ts(i,s);o&&(e.gs=e.gs.insert(o.clientId,o))}}e.Fs();const r=e.storage.getItem(e.Cs);if(r){const i=e.Ms(r);i&&e.xs(i)}for(const i of e.ps)e.fs(i);e.ps=[],e.window.addEventListener("pagehide",()=>e.shutdown()),e.started=!0})()}writeSequenceNumber(e){this.setItem(this.ws,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Os(this.gs)}isActiveQueryTarget(e){let t=!1;return this.gs.forEach((r,i)=>{i.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.Ns(e,"pending")}updateMutationState(e,t,r){this.Ns(e,t,r),this.Bs(e)}addLocalQueryTarget(e){let t="not-current";if(this.isActiveQueryTarget(e)){const r=this.storage.getItem(fa(this.persistenceKey,e));if(r){const i=Kr.Ts(e,r);i&&(t=i.state)}}return this.Ls.ds(e),this.Fs(),t}removeLocalQueryTarget(e){this.Ls.As(e),this.Fs()}isLocalQueryTarget(e){return this.Ls.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(fa(this.persistenceKey,e))}updateQueryState(e,t,r){this.ks(e,t,r)}handleUserChange(e,t,r){t.forEach(i=>{this.Bs(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.qs(e)}notifyBundleLoaded(e){this.Qs(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.Vs),this.removeItem(this.ys),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return x("SharedClientState","READ",e,t),t}setItem(e,t){x("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){x("SharedClientState","REMOVE",e),this.storage.removeItem(e)}fs(e){var t=this;const r=e;if(r.storageArea===this.storage){if(x("SharedClientState","EVENT",r.key,r.newValue),r.key===this.ys)return void ie("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.si.enqueueRetryable((0,g.Z)(function*(){if(t.started){if(null!==r.key)if(t.Ss.test(r.key)){if(null==r.newValue){const i=t.Ks(r.key);return t.$s(i,null)}{const i=t.Us(r.key,r.newValue);if(i)return t.$s(i.clientId,i)}}else if(t.bs.test(r.key)){if(null!==r.newValue){const i=t.Ws(r.key,r.newValue);if(i)return t.Gs(i)}}else if(t.Ds.test(r.key)){if(null!==r.newValue){const i=t.zs(r.key,r.newValue);if(i)return t.js(i)}}else if(r.key===t.Cs){if(null!==r.newValue){const i=t.Ms(r.newValue);if(i)return t.xs(i)}}else if(r.key===t.ws){const i=function(o){let a=Me._e;if(null!=o)try{const u=JSON.parse(o);R("number"==typeof u),a=u}catch(u){ie("SharedClientState","Failed to read sequence number from WebStorage",u)}return a}(r.newValue);i!==Me._e&&t.sequenceNumberHandler(i)}else if(r.key===t.vs){const i=t.Hs(r.newValue);yield Promise.all(i.map(s=>t.syncEngine.Js(s)))}}else t.ps.push(r)}))}}get Ls(){return this.gs.get(this.Rs)}Fs(){this.setItem(this.ys,this.Ls.Es())}Ns(e,t,r){const i=new cs(this.currentUser,e,t,r),s=bd(this.persistenceKey,this.currentUser,e);this.setItem(s,i.Es())}Bs(e){const t=bd(this.persistenceKey,this.currentUser,e);this.removeItem(t)}qs(e){this.storage.setItem(this.Cs,JSON.stringify({clientId:this.Rs,onlineState:e}))}ks(e,t,r){const i=fa(this.persistenceKey,e),s=new Kr(e,t,r);this.setItem(i,s.Es())}Qs(e){const t=JSON.stringify(Array.from(e));this.setItem(this.vs,t)}Ks(e){const t=this.Ss.exec(e);return t?t[1]:null}Us(e,t){const r=this.Ks(e);return ls.Ts(r,t)}Ws(e,t){const r=this.bs.exec(e),i=Number(r[1]);return cs.Ts(new de(void 0!==r[2]?r[2]:null),i,t)}zs(e,t){const r=this.Ds.exec(e),i=Number(r[1]);return Kr.Ts(i,t)}Ms(e){return ma.Ts(e)}Hs(e){return JSON.parse(e)}Gs(e){var t=this;return(0,g.Z)(function*(){if(e.user.uid===t.currentUser.uid)return t.syncEngine.Ys(e.batchId,e.state,e.error);x("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)})()}js(e){return this.syncEngine.Zs(e.targetId,e.state,e.error)}$s(e,t){const r=t?this.gs.insert(e,t):this.gs.remove(e),i=this.Os(this.gs),s=this.Os(r),o=[],a=[];return s.forEach(u=>{i.has(u)||o.push(u)}),i.forEach(u=>{s.has(u)||a.push(u)}),this.syncEngine.Xs(o,a).then(()=>{this.gs=r})}xs(e){this.gs.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Os(e){let t=qo();return e.forEach((r,i)=>{t=t.unionWith(i.activeTargetIds)}),t}}class Rd{constructor(){this.eo=new ga,this.no={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e){return this.eo.ds(e),this.no[e]||"not-current"}updateQueryState(e,t,r){this.no[e]=t}removeLocalQueryTarget(e){this.eo.As(e)}isLocalQueryTarget(e){return this.eo.activeTargetIds.has(e)}clearQueryState(e){delete this.no[e]}getAllActiveQueryTargets(){return this.eo.activeTargetIds}isActiveQueryTarget(e){return this.eo.activeTargetIds.has(e)}start(){return this.eo=new ga,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class lg{ro(e){}shutdown(){}}class Pd{constructor(){this.io=()=>this.so(),this.oo=()=>this._o(),this.ao=[],this.uo()}ro(e){this.ao.push(e)}shutdown(){window.removeEventListener("online",this.io),window.removeEventListener("offline",this.oo)}uo(){window.addEventListener("online",this.io),window.addEventListener("offline",this.oo)}so(){x("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ao)e(0)}_o(){x("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ao)e(1)}static D(){return typeof window<"u"&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let hs=null;function xa(){return null===hs?hs=268435456+Math.round(2147483648*Math.random()):hs++,"0x"+hs.toString(16)}const hg={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class dg{constructor(e){this.co=e.co,this.lo=e.lo}ho(e){this.Po=e}Io(e){this.To=e}onMessage(e){this.Eo=e}close(){this.lo()}send(e){this.co(e)}Ao(){this.Po()}Ro(e){this.To(e)}Vo(e){this.Eo(e)}}const we="WebChannelConnection";class _g extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const r=t.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.mo=r+"://"+t.host,this.fo=`projects/${i}/databases/${s}`,this.po="(default)"===this.databaseId.database?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get yo(){return!1}wo(t,r,i,s,o){const a=xa(),u=this.So(t,r);x("RestConnection",`Sending RPC '${t}' ${a}:`,u,i);const c={"google-cloud-resource-prefix":this.fo,"x-goog-request-params":this.po};return this.bo(c,s,o),this.Do(t,u,c,i).then(l=>(x("RestConnection",`Received RPC '${t}' ${a}: `,l),l),l=>{throw Se("RestConnection",`RPC '${t}' ${a} failed with error: `,l,"url: ",u,"request:",i),l})}Co(t,r,i,s,o,a){return this.wo(t,r,i,s,o)}bo(t,r,i){t["X-Goog-Api-Client"]="gl-js/ fire/"+_n,t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,o)=>t[o]=s),i&&i.headers.forEach((s,o)=>t[o]=s)}So(t,r){return`${this.mo}/v1/${r}:${hg[t]}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Do(e,t,r,i){const s=xa();return new Promise((o,a)=>{const u=new l0;u.setWithCredentials(!0),u.listenOnce(u0.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case Ao.NO_ERROR:const l=u.getResponseJson();x(we,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(l)),o(l);break;case Ao.TIMEOUT:x(we,`RPC '${e}' ${s} timed out`),a(new p(m.DEADLINE_EXCEEDED,"Request time out"));break;case Ao.HTTP_ERROR:const h=u.getStatus();if(x(we,`RPC '${e}' ${s} failed with status:`,h,"response text:",u.getResponseText()),h>0){let d=u.getResponseJson();Array.isArray(d)&&(d=d[0]);const f=null==d?void 0:d.error;if(f&&f.status&&f.message){const y=function(T){const S=T.toLowerCase().replace(/_/g,"-");return Object.values(m).indexOf(S)>=0?S:m.UNKNOWN}(f.status);a(new p(y,f.message))}else a(new p(m.UNKNOWN,"Server responded with status "+u.getStatus()))}else a(new p(m.UNAVAILABLE,"Connection failed."));break;default:A()}}finally{x(we,`RPC '${e}' ${s} completed.`)}});const c=JSON.stringify(i);x(we,`RPC '${e}' ${s} sending request:`,i),u.send(t,"POST",c,r,15)})}vo(e,t,r){const i=xa(),s=[this.mo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=o0(),a=a0(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;void 0!==c&&(u.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(u.useFetchStreams=!0),this.bo(u.initMessageHeaders,t,r),u.encodeInitMessageHeaders=!0;const l=s.join("");x(we,`Creating RPC '${e}' stream ${i}: ${l}`,u);const h=o.createWebChannel(l,u);let d=!1,f=!1;const y=new dg({co:T=>{f?x(we,`Not sending because RPC '${e}' stream ${i} is closed:`,T):(d||(x(we,`Opening RPC '${e}' stream ${i} transport.`),h.open(),d=!0),x(we,`RPC '${e}' stream ${i} sending:`,T),h.send(T))},lo:()=>h.close()}),I=(T,S,C)=>{T.listen(S,V=>{try{C(V)}catch(F){setTimeout(()=>{throw F},0)}})};return I(h,Fi.EventType.OPEN,()=>{f||x(we,`RPC '${e}' stream ${i} transport opened.`)}),I(h,Fi.EventType.CLOSE,()=>{f||(f=!0,x(we,`RPC '${e}' stream ${i} transport closed`),y.Ro())}),I(h,Fi.EventType.ERROR,T=>{f||(f=!0,Se(we,`RPC '${e}' stream ${i} transport errored:`,T),y.Ro(new p(m.UNAVAILABLE,"The operation could not be completed")))}),I(h,Fi.EventType.MESSAGE,T=>{var S;if(!f){const C=T.data[0];R(!!C);const F=C.error||(null===(S=C[0])||void 0===S?void 0:S.error);if(F){x(we,`RPC '${e}' stream ${i} received error:`,F);const G=F.status;let L=function(Qx){const H_=ae[Qx];if(void 0!==H_)return Th(H_)}(G),oe=F.message;void 0===L&&(L=m.INTERNAL,oe="Unknown error status: "+G+" with message "+F.message),f=!0,y.Ro(new p(L,oe)),h.close()}else x(we,`RPC '${e}' stream ${i} received:`,C),y.Vo(C)}}),I(a,c0.STAT_EVENT,T=>{T.stat===dl.PROXY?x(we,`RPC '${e}' stream ${i} detected buffering proxy`):T.stat===dl.NOPROXY&&x(we,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{y.Ao()},0),y}}function Sd(){return typeof window<"u"?window:null}function ds(){return typeof document<"u"?document:null}function $r(n){return new vm(n,!0)}class ya{constructor(e,t,r=1e3,i=1.5,s=6e4){this.si=e,this.timerId=t,this.Fo=r,this.Mo=i,this.xo=s,this.Oo=0,this.No=null,this.Bo=Date.now(),this.reset()}reset(){this.Oo=0}Lo(){this.Oo=this.xo}ko(e){this.cancel();const t=Math.floor(this.Oo+this.qo()),r=Math.max(0,Date.now()-this.Bo),i=Math.max(0,t-r);i>0&&x("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Oo} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.No=this.si.enqueueAfterDelay(this.timerId,i,()=>(this.Bo=Date.now(),e())),this.Oo*=this.Mo,this.Oo<this.Fo&&(this.Oo=this.Fo),this.Oo>this.xo&&(this.Oo=this.xo)}Qo(){null!==this.No&&(this.No.skipDelay(),this.No=null)}cancel(){null!==this.No&&(this.No.cancel(),this.No=null)}qo(){return(Math.random()-.5)*this.Oo}}class Vd{constructor(e,t,r,i,s,o,a,u){this.si=e,this.Ko=r,this.$o=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=u,this.state=0,this.Uo=0,this.Wo=null,this.Go=null,this.stream=null,this.zo=new ya(e,t)}jo(){return 1===this.state||5===this.state||this.Ho()}Ho(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Jo()}stop(){var e=this;return(0,g.Z)(function*(){e.jo()&&(yield e.close(0))})()}Yo(){this.state=0,this.zo.reset()}Zo(){this.Ho()&&null===this.Wo&&(this.Wo=this.si.enqueueAfterDelay(this.Ko,6e4,()=>this.Xo()))}e_(e){this.t_(),this.stream.send(e)}Xo(){var e=this;return(0,g.Z)(function*(){if(e.Ho())return e.close(0)})()}t_(){this.Wo&&(this.Wo.cancel(),this.Wo=null)}n_(){this.Go&&(this.Go.cancel(),this.Go=null)}close(e,t){var r=this;return(0,g.Z)(function*(){r.t_(),r.n_(),r.zo.cancel(),r.Uo++,4!==e?r.zo.reset():t&&t.code===m.RESOURCE_EXHAUSTED?(ie(t.toString()),ie("Using maximum backoff delay to prevent overloading the backend."),r.zo.Lo()):t&&t.code===m.UNAUTHENTICATED&&3!==r.state&&(r.authCredentialsProvider.invalidateToken(),r.appCheckCredentialsProvider.invalidateToken()),null!==r.stream&&(r.r_(),r.stream.close(),r.stream=null),r.state=e,yield r.listener.Io(t)})()}r_(){}auth(){this.state=1;const e=this.i_(this.Uo),t=this.Uo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Uo===t&&this.s_(r,i)},r=>{e(()=>{const i=new p(m.UNKNOWN,"Fetching auth token failed: "+r.message);return this.o_(i)})})}s_(e,t){const r=this.i_(this.Uo);this.stream=this.__(e,t),this.stream.ho(()=>{r(()=>(this.state=2,this.Go=this.si.enqueueAfterDelay(this.$o,1e4,()=>(this.Ho()&&(this.state=3),Promise.resolve())),this.listener.ho()))}),this.stream.Io(i=>{r(()=>this.o_(i))}),this.stream.onMessage(i=>{r(()=>this.onMessage(i))})}Jo(){var e=this;this.state=5,this.zo.ko((0,g.Z)(function*(){e.state=0,e.start()}))}o_(e){return x("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}i_(e){return t=>{this.si.enqueueAndForget(()=>this.Uo===e?t():(x("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class fg extends Vd{constructor(e,t,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}__(e,t){return this.connection.vo("Listen",e,t)}onMessage(e){this.zo.reset();const t=function bm(n,e){let t;if("targetChange"in e){const r="NO_CHANGE"===(c=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===c?1:"REMOVE"===c?2:"CURRENT"===c?3:"RESET"===c?4:A(),i=e.targetChange.targetIds||[],s=function(c,l){return c.useProto3Json?(R(void 0===l||"string"==typeof l),ce.fromBase64String(l||"")):(R(void 0===l||l instanceof Uint8Array),ce.fromUint8Array(l||new Uint8Array))}(n,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(c){const l=void 0===c.code?m.UNKNOWN:Th(c.code);return new p(l,c.message||"")}(o);t=new bh(r,i,s,a||null)}else if("documentChange"in e){const r=e.documentChange,i=Xe(n,r.document.name),s=se(r.document.updateTime),o=r.document.createTime?se(r.document.createTime):P.min(),a=new xe({mapValue:{fields:r.document.fields}}),u=Y.newFoundDocument(i,s,o,a);t=new Yi(r.targetIds||[],r.removedTargetIds||[],u.key,u)}else if("documentDelete"in e){const r=e.documentDelete,i=Xe(n,r.document),s=r.readTime?se(r.readTime):P.min(),o=Y.newNoDocument(i,s);t=new Yi([],r.removedTargetIds||[],o.key,o)}else if("documentRemove"in e){const r=e.documentRemove,i=Xe(n,r.document);t=new Yi([],r.removedTargetIds||[],i,null)}else{if(!("filter"in e))return A();{const r=e.filter,{count:i=0,unchangedNames:s}=r,o=new pm(i,s);t=new Ah(r.targetId,o)}}var c;return t}(this.serializer,e),r=function(s){if(!("targetChange"in s))return P.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?P.min():o.readTime?se(o.readTime):P.min()}(e);return this.listener.a_(t,r)}u_(e){const t={};t.database=Or(this.serializer),t.addTarget=function(s,o){let a;const u=o.target;if(a=ji(u)?{documents:Mh(s,u)}:{query:Zo(s,u)},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=Vh(s,o.resumeToken);const c=$o(s,o.expectedCount);null!==c&&(a.expectedCount=c)}else if(o.snapshotVersion.compareTo(P.min())>0){a.readTime=Pn(s,o.snapshotVersion.toTimestamp());const c=$o(s,o.expectedCount);null!==c&&(a.expectedCount=c)}return a}(this.serializer,e);const r=function Pm(n,e){const t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return A()}}(e.purpose);return null==t?null:{"goog-listen-tags":t}}(0,e);r&&(t.labels=r),this.e_(t)}c_(e){const t={};t.database=Or(this.serializer),t.removeTarget=e,this.e_(t)}}class mg extends Vd{constructor(e,t,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s,this.l_=!1}get h_(){return this.l_}start(){this.l_=!1,this.lastStreamToken=void 0,super.start()}r_(){this.l_&&this.P_([])}__(e,t){return this.connection.vo("Write",e,t)}onMessage(e){if(R(!!e.streamToken),this.lastStreamToken=e.streamToken,this.l_){this.zo.reset();const t=function Rm(n,e){return n&&n.length>0?(R(void 0!==e),n.map(t=>function(i,s){let o=se(i.updateTime?i.updateTime:s);return o.isEqual(P.min())&&(o=se(s)),new _m(o,i.transformResults||[])}(t,e))):[]}(e.writeResults,e.commitTime),r=se(e.commitTime);return this.listener.I_(r,t)}return R(!e.writeResults||0===e.writeResults.length),this.l_=!0,this.listener.T_()}E_(){const e={};e.database=Or(this.serializer),this.e_(e)}P_(e){const t={streamToken:this.lastStreamToken,writes:e.map(r=>Lr(this.serializer,r))};this.e_(t)}}class gg extends class{}{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.d_=!1}A_(){if(this.d_)throw new p(m.FAILED_PRECONDITION,"The client has already been terminated.")}wo(e,t,r){return this.A_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,s])=>this.connection.wo(e,t,r,i,s)).catch(i=>{throw"FirebaseError"===i.name?(i.code===m.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new p(m.UNKNOWN,i.toString())})}Co(e,t,r,i){return this.A_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Co(e,t,r,s,o,i)).catch(s=>{throw"FirebaseError"===s.name?(s.code===m.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new p(m.UNKNOWN,s.toString())})}terminate(){this.d_=!0}}class xg{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.V_=0,this.m_=null,this.f_=!0}g_(){0===this.V_&&(this.p_("Unknown"),this.m_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.m_=null,this.y_("Backend didn't respond within 10 seconds."),this.p_("Offline"),Promise.resolve())))}w_(e){"Online"===this.state?this.p_("Unknown"):(this.V_++,this.V_>=1&&(this.S_(),this.y_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.p_("Offline")))}set(e){this.S_(),this.V_=0,"Online"===e&&(this.f_=!1),this.p_(e)}p_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}y_(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.f_?(ie(t),this.f_=!1):x("OnlineStateTracker",t)}S_(){null!==this.m_&&(this.m_.cancel(),this.m_=null)}}class yg{constructor(e,t,r,i,s){var o=this;this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.b_=[],this.D_=new Map,this.C_=new Set,this.v_=[],this.F_=s,this.F_.ro(a=>{r.enqueueAndForget((0,g.Z)(function*(){var u;Pt(o)&&(x("RemoteStore","Restarting streams for network reachability change."),yield(u=(0,g.Z)(function*(l){const h=E(l);h.C_.add(4),yield Mn(h),h.M_.set("Unknown"),h.C_.delete(4),yield Qr(h)}),function c(l){return u.apply(this,arguments)})(o))}))}),this.M_=new xg(r,i)}}function Qr(n){return Ta.apply(this,arguments)}function Ta(){return Ta=(0,g.Z)(function*(n){if(Pt(n))for(const e of n.v_)yield e(!0)}),Ta.apply(this,arguments)}function Mn(n){return Ea.apply(this,arguments)}function Ea(){return Ea=(0,g.Z)(function*(n){for(const e of n.v_)yield e(!1)}),Ea.apply(this,arguments)}function _s(n,e){const t=E(n);t.D_.has(e.targetId)||(t.D_.set(e.targetId,e),Aa(t)?wa(t):Ln(t).Ho()&&va(t,e))}function Wr(n,e){const t=E(n),r=Ln(t);t.D_.delete(e),r.Ho()&&Cd(t,e),0===t.D_.size&&(r.Ho()?r.Zo():Pt(t)&&t.M_.set("Unknown"))}function va(n,e){if(n.x_.Oe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(P.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Ln(n).u_(e)}function Cd(n,e){n.x_.Oe(e),Ln(n).c_(e)}function wa(n){n.x_=new ym({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),_t:e=>n.D_.get(e)||null,nt:()=>n.datastore.serializer.databaseId}),Ln(n).start(),n.M_.g_()}function Aa(n){return Pt(n)&&!Ln(n).jo()&&n.D_.size>0}function Pt(n){return 0===E(n).C_.size}function Dd(n){n.x_=void 0}function Ig(n){return ba.apply(this,arguments)}function ba(){return ba=(0,g.Z)(function*(n){n.D_.forEach((e,t)=>{va(n,e)})}),ba.apply(this,arguments)}function Tg(n,e){return Ra.apply(this,arguments)}function Ra(){return Ra=(0,g.Z)(function*(n,e){Dd(n),Aa(n)?(n.M_.w_(e),wa(n)):n.M_.set("Unknown")}),Ra.apply(this,arguments)}function Eg(n,e,t){return Pa.apply(this,arguments)}function Pa(){return Pa=(0,g.Z)(function*(n,e,t){if(n.M_.set("Online"),e instanceof bh&&2===e.state&&e.cause)try{yield(r=(0,g.Z)(function*(s,o){const a=o.cause;for(const u of o.targetIds)s.D_.has(u)&&(yield s.remoteSyncer.rejectListen(u,a),s.D_.delete(u),s.x_.removeTarget(u))}),function i(s,o){return r.apply(this,arguments)})(n,e)}catch(r){x("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield fs(n,r)}else if(e instanceof Yi?n.x_.$e(e):e instanceof Ah?n.x_.Je(e):n.x_.Ge(e),!t.isEqual(P.min()))try{const r=yield Id(n.localStore);t.compareTo(r)>=0&&(yield function(s,o){const a=s.x_.it(o);return a.targetChanges.forEach((u,c)=>{if(u.resumeToken.approximateByteSize()>0){const l=s.D_.get(c);l&&s.D_.set(c,l.withResumeToken(u.resumeToken,o))}}),a.targetMismatches.forEach((u,c)=>{const l=s.D_.get(u);if(!l)return;s.D_.set(u,l.withResumeToken(ce.EMPTY_BYTE_STRING,l.snapshotVersion)),Cd(s,u);const h=new at(l.target,u,c,l.sequenceNumber);va(s,h)}),s.remoteSyncer.applyRemoteEvent(a)}(n,t))}catch(r){x("RemoteStore","Failed to raise snapshot:",r),yield fs(n,r)}var r}),Pa.apply(this,arguments)}function fs(n,e,t){return Sa.apply(this,arguments)}function Sa(){return Sa=(0,g.Z)(function*(n,e,t){if(!gt(e))throw e;n.C_.add(1),yield Mn(n),n.M_.set("Offline"),t||(t=()=>Id(n.localStore)),n.asyncQueue.enqueueRetryable((0,g.Z)(function*(){x("RemoteStore","Retrying IndexedDB access"),yield t(),n.C_.delete(1),yield Qr(n)}))}),Sa.apply(this,arguments)}function Nd(n,e){return e().catch(t=>fs(n,t,e))}function On(n){return Va.apply(this,arguments)}function Va(){return Va=(0,g.Z)(function*(n){const e=E(n),t=St(e);let r=e.b_.length>0?e.b_[e.b_.length-1].batchId:-1;for(;vg(e);)try{const i=yield ag(e.localStore,r);if(null===i){0===e.b_.length&&t.Zo();break}r=i.batchId,wg(e,i)}catch(i){yield fs(e,i)}kd(e)&&Fd(e)}),Va.apply(this,arguments)}function vg(n){return Pt(n)&&n.b_.length<10}function wg(n,e){n.b_.push(e);const t=St(n);t.Ho()&&t.h_&&t.P_(e.mutations)}function kd(n){return Pt(n)&&!St(n).jo()&&n.b_.length>0}function Fd(n){St(n).start()}function Ag(n){return Ca.apply(this,arguments)}function Ca(){return Ca=(0,g.Z)(function*(n){St(n).E_()}),Ca.apply(this,arguments)}function bg(n){return Da.apply(this,arguments)}function Da(){return Da=(0,g.Z)(function*(n){const e=St(n);for(const t of n.b_)e.P_(t.mutations)}),Da.apply(this,arguments)}function Rg(n,e,t){return Na.apply(this,arguments)}function Na(){return Na=(0,g.Z)(function*(n,e,t){const r=n.b_.shift(),i=zo.from(r,e,t);yield Nd(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),yield On(n)}),Na.apply(this,arguments)}function Pg(n,e){return ka.apply(this,arguments)}function ka(){return ka=(0,g.Z)(function*(n,e){var t;e&&St(n).h_&&(yield(t=(0,g.Z)(function*(i,s){if(Ih(a=s.code)&&a!==m.ABORTED){const o=i.b_.shift();St(i).Yo(),yield Nd(i,()=>i.remoteSyncer.rejectFailedWrite(o.batchId,s)),yield On(i)}var a}),function r(i,s){return t.apply(this,arguments)})(n,e)),kd(n)&&Fd(n)}),ka.apply(this,arguments)}function Md(n,e){return Fa.apply(this,arguments)}function Fa(){return Fa=(0,g.Z)(function*(n,e){const t=E(n);t.asyncQueue.verifyOperationInProgress(),x("RemoteStore","RemoteStore received new credentials");const r=Pt(t);t.C_.add(3),yield Mn(t),r&&t.M_.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.C_.delete(3),yield Qr(t)}),Fa.apply(this,arguments)}function Ma(n,e){return Oa.apply(this,arguments)}function Oa(){return Oa=(0,g.Z)(function*(n,e){const t=E(n);e?(t.C_.delete(2),yield Qr(t)):e||(t.C_.add(2),yield Mn(t),t.M_.set("Unknown"))}),Oa.apply(this,arguments)}function Ln(n){return n.O_||(n.O_=function(t,r,i){const s=E(t);return s.A_(),new fg(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{ho:Ig.bind(null,n),Io:Tg.bind(null,n),a_:Eg.bind(null,n)}),n.v_.push(function(){var e=(0,g.Z)(function*(t){t?(n.O_.Yo(),Aa(n)?wa(n):n.M_.set("Unknown")):(yield n.O_.stop(),Dd(n))});return function(t){return e.apply(this,arguments)}}())),n.O_}function St(n){return n.N_||(n.N_=function(t,r,i){const s=E(t);return s.A_(),new mg(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{ho:Ag.bind(null,n),Io:Pg.bind(null,n),T_:bg.bind(null,n),I_:Rg.bind(null,n)}),n.v_.push(function(){var e=(0,g.Z)(function*(t){t?(n.N_.Yo(),yield On(n)):(yield n.N_.stop(),n.b_.length>0&&(x("RemoteStore",`Stopping write stream with ${n.b_.length} pending writes`),n.b_=[]))});return function(t){return e.apply(this,arguments)}}())),n.N_}class La{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new ue,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,s){const o=Date.now()+r,a=new La(e,t,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new p(m.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Bn(n,e){if(ie("AsyncQueue",`${e}: ${n}`),gt(n))return new p(m.UNAVAILABLE,`${e}: ${n}`);throw n}class qn{constructor(e){this.comparator=e?(t,r)=>e(t,r)||v.comparator(t.key,r.key):(t,r)=>v.comparator(t.key,r.key),this.keyedMap=Sr(),this.sortedSet=new Q(this.comparator)}static emptySet(e){return new qn(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof qn)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const r=new qn;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}class Od{constructor(){this.B_=new Q(v.comparator)}track(e){const t=e.doc.key,r=this.B_.get(t);r?0!==e.type&&3===r.type?this.B_=this.B_.insert(t,e):3===e.type&&1!==r.type?this.B_=this.B_.insert(t,{type:r.type,doc:e.doc}):2===e.type&&2===r.type?this.B_=this.B_.insert(t,{type:2,doc:e.doc}):2===e.type&&0===r.type?this.B_=this.B_.insert(t,{type:0,doc:e.doc}):1===e.type&&0===r.type?this.B_=this.B_.remove(t):1===e.type&&2===r.type?this.B_=this.B_.insert(t,{type:1,doc:r.doc}):0===e.type&&1===r.type?this.B_=this.B_.insert(t,{type:2,doc:e.doc}):A():this.B_=this.B_.insert(t,e)}L_(){const e=[];return this.B_.inorderTraversal((t,r)=>{e.push(r)}),e}}class Un{constructor(e,t,r,i,s,o,a,u,c){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=u,this.hasCachedResults=c}static fromInitialDocuments(e,t,r,i,s){const o=[];return t.forEach(a=>{o.push({type:0,doc:a})}),new Un(e,t,qn.emptySet(t),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Rr(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}}class Sg{constructor(){this.k_=void 0,this.listeners=[]}}class Vg{constructor(){this.queries=new st(e=>th(e),Rr),this.onlineState="Unknown",this.q_=new Set}}function Ba(n,e){return qa.apply(this,arguments)}function qa(){return qa=(0,g.Z)(function*(n,e){const t=E(n),r=e.query;let i=!1,s=t.queries.get(r);if(s||(i=!0,s=new Sg),i)try{s.k_=yield t.onListen(r)}catch(o){const a=Bn(o,`Initialization of query '${vn(e.query)}' failed`);return void e.onError(a)}t.queries.set(r,s),s.listeners.push(e),e.Q_(t.onlineState),s.k_&&e.K_(s.k_)&&za(t)}),qa.apply(this,arguments)}function Ua(n,e){return Ga.apply(this,arguments)}function Ga(){return Ga=(0,g.Z)(function*(n,e){const t=E(n),r=e.query;let i=!1;const s=t.queries.get(r);if(s){const o=s.listeners.indexOf(e);o>=0&&(s.listeners.splice(o,1),i=0===s.listeners.length)}if(i)return t.queries.delete(r),t.onUnlisten(r)}),Ga.apply(this,arguments)}function Cg(n,e){const t=E(n);let r=!1;for(const i of e){const o=t.queries.get(i.query);if(o){for(const a of o.listeners)a.K_(i)&&(r=!0);o.k_=i}}r&&za(t)}function Dg(n,e,t){const r=E(n),i=r.queries.get(e);if(i)for(const s of i.listeners)s.onError(t);r.queries.delete(e)}function za(n){n.q_.forEach(e=>{e.next()})}class ja{constructor(e,t,r){this.query=e,this.U_=t,this.W_=!1,this.G_=null,this.onlineState="Unknown",this.options=r||{}}K_(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)3!==i.type&&r.push(i);e=new Un(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.W_?this.z_(e)&&(this.U_.next(e),t=!0):this.j_(e,this.onlineState)&&(this.H_(e),t=!0),this.G_=e,t}onError(e){this.U_.error(e)}Q_(e){this.onlineState=e;let t=!1;return this.G_&&!this.W_&&this.j_(this.G_,e)&&(this.H_(this.G_),t=!0),t}j_(e,t){return!e.fromCache||(!this.options.J_||!("Offline"!==t))&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}z_(e){return e.docChanges.length>0||!!(e.syncStateChanged||this.G_&&this.G_.hasPendingWrites!==e.hasPendingWrites)&&!0===this.options.includeMetadataChanges}H_(e){e=Un.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.W_=!0,this.U_.next(e)}}class Ng{constructor(e,t){this.Y_=e,this.byteLength=t}Z_(){return"metadata"in this.Y_}}class Ld{constructor(e){this.serializer=e}hs(e){return Xe(this.serializer,e)}Ps(e){return e.metadata.exists?Fh(this.serializer,e.document,!1):Y.newNoDocument(this.hs(e.metadata.name),this.Is(e.metadata.readTime))}Is(e){return se(e)}}class kg{constructor(e,t,r){this.X_=e,this.localStore=t,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=Bd(e)}ea(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.Y_.namedQuery)this.queries.push(e.Y_.namedQuery);else if(e.Y_.documentMetadata){this.documents.push({metadata:e.Y_.documentMetadata}),e.Y_.documentMetadata.exists||++t;const r=B.fromString(e.Y_.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.Y_.document&&(this.documents[this.documents.length-1].document=e.Y_.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}ta(e){const t=new Map,r=new Ld(this.serializer);for(const i of e)if(i.metadata.queries){const s=r.hs(i.metadata.name);for(const o of i.metadata.queries){const a=(t.get(o)||k()).add(s);t.set(o,a)}}return t}complete(){var e=this;return(0,g.Z)(function*(){const t=yield function ug(n,e,t,r){return da.apply(this,arguments)}(e.localStore,new Ld(e.serializer),e.documents,e.X_.id),r=e.ta(e.documents);for(const i of e.queries)yield cg(e.localStore,i,r.get(i.name));return e.progress.taskState="Success",{progress:e.progress,na:e.collectionGroups,ra:t}})()}}function Bd(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}class qd{constructor(e){this.key=e}}class Ud{constructor(e){this.key=e}}class Gd{constructor(e,t){this.query=e,this.ia=t,this.sa=null,this.hasCachedResults=!1,this.current=!1,this.oa=k(),this.mutatedKeys=k(),this._a=rh(e),this.aa=new qn(this._a)}get ua(){return this.ia}ca(e,t){const r=t?t.la:new Od,i=t?t.aa:this.aa;let s=t?t.mutatedKeys:this.mutatedKeys,o=i,a=!1;const u="F"===this.query.limitType&&i.size===this.query.limit?i.last():null,c="L"===this.query.limitType&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((l,h)=>{const d=i.get(l),f=Pr(this.query,h)?h:null,y=!!d&&this.mutatedKeys.has(d.key),I=!!f&&(f.hasLocalMutations||this.mutatedKeys.has(f.key)&&f.hasCommittedMutations);let T=!1;d&&f?d.data.isEqual(f.data)?y!==I&&(r.track({type:3,doc:f}),T=!0):this.ha(d,f)||(r.track({type:2,doc:f}),T=!0,(u&&this._a(f,u)>0||c&&this._a(f,c)<0)&&(a=!0)):!d&&f?(r.track({type:0,doc:f}),T=!0):d&&!f&&(r.track({type:1,doc:d}),T=!0,(u||c)&&(a=!0)),T&&(f?(o=o.add(f),s=I?s.add(l):s.delete(l)):(o=o.delete(l),s=s.delete(l)))}),null!==this.query.limit)for(;o.size>this.query.limit;){const l="F"===this.query.limitType?o.last():o.first();o=o.delete(l.key),s=s.delete(l.key),r.track({type:1,doc:l})}return{aa:o,la:r,Zi:a,mutatedKeys:s}}ha(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){const s=this.aa;this.aa=e.aa,this.mutatedKeys=e.mutatedKeys;const o=e.la.L_();o.sort((l,h)=>function(f,y){const I=T=>{switch(T){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return A()}};return I(f)-I(y)}(l.type,h.type)||this._a(l.doc,h.doc)),this.Pa(r),i=null!=i&&i;const a=t&&!i?this.Ia():[],u=0===this.oa.size&&this.current&&!i?1:0,c=u!==this.sa;return this.sa=u,0!==o.length||c?{snapshot:new Un(this.query,e.aa,s,o,e.mutatedKeys,0===u,c,!1,!!r&&r.resumeToken.approximateByteSize()>0),Ta:a}:{Ta:a}}Q_(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({aa:this.aa,la:new Od,mutatedKeys:this.mutatedKeys,Zi:!1},!1)):{Ta:[]}}Ea(e){return!this.ia.has(e)&&!!this.aa.has(e)&&!this.aa.get(e).hasLocalMutations}Pa(e){e&&(e.addedDocuments.forEach(t=>this.ia=this.ia.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.ia=this.ia.delete(t)),this.current=e.current)}Ia(){if(!this.current)return[];const e=this.oa;this.oa=k(),this.aa.forEach(r=>{this.Ea(r.key)&&(this.oa=this.oa.add(r.key))});const t=[];return e.forEach(r=>{this.oa.has(r)||t.push(new Ud(r))}),this.oa.forEach(r=>{e.has(r)||t.push(new qd(r))}),t}da(e){this.ia=e.ls,this.oa=k();const t=this.ca(e.documents);return this.applyChanges(t,!0)}Aa(){return Un.fromInitialDocuments(this.query,this.aa,this.mutatedKeys,0===this.sa,this.hasCachedResults)}}class Fg{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class Mg{constructor(e){this.key=e,this.Ra=!1}}class Og{constructor(e,t,r,i,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Va={},this.ma=new st(a=>th(a),Rr),this.fa=new Map,this.ga=new Set,this.pa=new Q(v.comparator),this.ya=new Map,this.wa=new ia,this.Sa={},this.ba=new Map,this.Da=Zt.Nn(),this.onlineState="Unknown",this.Ca=void 0}get isPrimaryClient(){return!0===this.Ca}}function Lg(n,e){return Ka.apply(this,arguments)}function Ka(){return Ka=(0,g.Z)(function*(n,e){const t=fu(n);let r,i;const s=t.ma.get(e);if(s)r=s.targetId,t.sharedClientState.addLocalQueryTarget(r),i=s.view.Aa();else{const o=yield kn(t.localStore,be(e)),a=t.sharedClientState.addLocalQueryTarget(o.targetId);r=o.targetId,i=yield $a(t,e,r,"current"===a,o.resumeToken),t.isPrimaryClient&&_s(t.remoteStore,o)}return i}),Ka.apply(this,arguments)}function $a(n,e,t,r,i){return Qa.apply(this,arguments)}function Qa(){return Qa=(0,g.Z)(function*(n,e,t,r,i){n.va=(h,d,f)=>{return(y=(0,g.Z)(function*(T,S,C,V){let F=S.view.ca(C);F.Zi&&(F=yield us(T.localStore,S.query,!1).then(({documents:De})=>S.view.ca(De,F)));const G=V&&V.targetChanges.get(S.targetId),L=V&&null!=V.targetMismatches.get(S.targetId),oe=S.view.applyChanges(F,T.isPrimaryClient,G,L);return ru(T,S.targetId,oe.Ta),oe.snapshot}),function I(T,S,C,V){return y.apply(this,arguments)})(n,h,d,f);var y};const s=yield us(n.localStore,e,!0),o=new Gd(e,s.ls),a=o.ca(s.documents),u=Fr.createSynthesizedTargetChangeForCurrentChange(t,r&&"Offline"!==n.onlineState,i),c=o.applyChanges(a,n.isPrimaryClient,u);ru(n,t,c.Ta);const l=new Fg(e,t,o);return n.ma.set(e,l),n.fa.has(t)?n.fa.get(t).push(e):n.fa.set(t,[e]),c.snapshot}),Qa.apply(this,arguments)}function Bg(n,e){return Wa.apply(this,arguments)}function Wa(){return Wa=(0,g.Z)(function*(n,e){const t=E(n),r=t.ma.get(e),i=t.fa.get(r.targetId);if(i.length>1)return t.fa.set(r.targetId,i.filter(s=>!Rr(s,e))),void t.ma.delete(e);t.isPrimaryClient?(t.sharedClientState.removeLocalQueryTarget(r.targetId),t.sharedClientState.isActiveQueryTarget(r.targetId)||(yield Fn(t.localStore,r.targetId,!1).then(()=>{t.sharedClientState.clearQueryState(r.targetId),Wr(t.remoteStore,r.targetId),Gn(t,r.targetId)}).catch(mt))):(Gn(t,r.targetId),yield Fn(t.localStore,r.targetId,!0))}),Wa.apply(this,arguments)}function Ha(){return Ha=(0,g.Z)(function*(n,e,t){const r=mu(n);try{const i=yield function(o,a){const u=E(o),c=J.now(),l=a.reduce((f,y)=>f.add(y.key),k());let h,d;return u.persistence.runTransaction("Locally write mutations","readwrite",f=>{let y=Ce(),I=k();return u.ss.getEntries(f,l).next(T=>{y=T,y.forEach((S,C)=>{C.isValidDocument()||(I=I.add(S))})}).next(()=>u.localDocuments.getOverlayedDocuments(f,y)).next(T=>{h=T;const S=[];for(const C of a){const V=mm(C,h.get(C.key).overlayedDocument);null!=V&&S.push(new ot(C.key,V,ql(V.value.mapValue),ee.exists(!0)))}return u.mutationQueue.addMutationBatch(f,c,S,a)}).next(T=>{d=T;const S=T.applyToLocalDocumentSet(h,I);return u.documentOverlayCache.saveOverlays(f,T.batchId,S)})}).then(()=>({batchId:d.batchId,changes:sh(h)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,a,u){let c=o.Sa[o.currentUser.toKey()];c||(c=new Q(D)),c=c.insert(a,u),o.Sa[o.currentUser.toKey()]=c}(r,i.batchId,t),yield ut(r,i.changes),yield On(r.remoteStore)}catch(i){const s=Bn(i,"Failed to persist write");t.reject(s)}}),Ha.apply(this,arguments)}function zd(n,e){return Za.apply(this,arguments)}function Za(){return Za=(0,g.Z)(function*(n,e){const t=E(n);try{const r=yield function og(n,e){const t=E(n),r=e.snapshotVersion;let i=t.ts;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=t.ss.newChangeBuffer({trackRemovals:!0});i=t.ts;const a=[];e.targetChanges.forEach((l,h)=>{const d=i.get(h);if(!d)return;a.push(t.qr.removeMatchingKeys(s,l.removedDocuments,h).next(()=>t.qr.addMatchingKeys(s,l.addedDocuments,h)));let f=d.withSequenceNumber(s.currentSequenceNumber);var I,T,S;null!==e.targetMismatches.get(h)?f=f.withResumeToken(ce.EMPTY_BYTE_STRING,P.min()).withLastLimboFreeSnapshotVersion(P.min()):l.resumeToken.approximateByteSize()>0&&(f=f.withResumeToken(l.resumeToken,r)),i=i.insert(h,f),T=f,S=l,(0===(I=d).resumeToken.approximateByteSize()||T.snapshotVersion.toMicroseconds()-I.snapshotVersion.toMicroseconds()>=3e8||S.addedDocuments.size+S.modifiedDocuments.size+S.removedDocuments.size>0)&&a.push(t.qr.updateTargetData(s,f))});let u=Ce(),c=k();if(e.documentUpdates.forEach(l=>{e.resolvedLimboDocuments.has(l)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(s,l))}),a.push(Td(s,o,e.documentUpdates).next(l=>{u=l.us,c=l.cs})),!r.isEqual(P.min())){const l=t.qr.getLastRemoteSnapshotVersion(s).next(h=>t.qr.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(l)}return _.waitFor(a).next(()=>o.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,u,c)).next(()=>u)}).then(s=>(t.ts=i,s))}(t.localStore,e);e.targetChanges.forEach((i,s)=>{const o=t.ya.get(s);o&&(R(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.Ra=!0:i.modifiedDocuments.size>0?R(o.Ra):i.removedDocuments.size>0&&(R(o.Ra),o.Ra=!1))}),yield ut(t,r,e)}catch(r){yield mt(r)}}),Za.apply(this,arguments)}function jd(n,e,t){const r=E(n);if(r.isPrimaryClient&&0===t||!r.isPrimaryClient&&1===t){const i=[];r.ma.forEach((s,o)=>{const a=o.view.Q_(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){const u=E(o);u.onlineState=a;let c=!1;u.queries.forEach((l,h)=>{for(const d of h.listeners)d.Q_(a)&&(c=!0)}),c&&za(u)}(r.eventManager,e),i.length&&r.Va.a_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function Ug(n,e,t){return Ya.apply(this,arguments)}function Ya(){return Ya=(0,g.Z)(function*(n,e,t){const r=E(n);r.sharedClientState.updateQueryState(e,"rejected",t);const i=r.ya.get(e),s=i&&i.key;if(s){let o=new Q(v.comparator);o=o.insert(s,Y.newNoDocument(s,P.min()));const a=k().add(s),u=new kr(P.min(),new Map,new Q(D),o,a);yield zd(r,u),r.pa=r.pa.remove(s),r.ya.delete(e),iu(r)}else yield Fn(r.localStore,e,!1).then(()=>Gn(r,e,t)).catch(mt)}),Ya.apply(this,arguments)}function Gg(n,e){return Xa.apply(this,arguments)}function Xa(){return Xa=(0,g.Z)(function*(n,e){const t=E(n),r=e.batch.batchId;try{const i=yield function sg(n,e){const t=E(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),s=t.ss.newChangeBuffer({trackRemovals:!0});return function(a,u,c,l){const h=c.batch,d=h.keys();let f=_.resolve();return d.forEach(y=>{f=f.next(()=>l.getEntry(u,y)).next(I=>{const T=c.docVersions.get(y);R(null!==T),I.version.compareTo(T)<0&&(h.applyToRemoteDocument(I,c),I.isValidDocument()&&(I.setReadTime(c.commitVersion),l.addEntry(I)))})}),f.next(()=>a.mutationQueue.removeMutationBatch(u,h))}(t,r,e,s).next(()=>s.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let u=k();for(let c=0;c<a.mutationResults.length;++c)a.mutationResults[c].transformResults.length>0&&(u=u.add(a.batch.mutations[c].key));return u}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}(t.localStore,e);nu(t,r,null),tu(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),yield ut(t,i)}catch(i){yield mt(i)}}),Xa.apply(this,arguments)}function zg(n,e,t){return Ja.apply(this,arguments)}function Ja(){return Ja=(0,g.Z)(function*(n,e,t){const r=E(n);try{const i=yield function(o,a){const u=E(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let l;return u.mutationQueue.lookupMutationBatch(c,a).next(h=>(R(null!==h),l=h.keys(),u.mutationQueue.removeMutationBatch(c,h))).next(()=>u.mutationQueue.performConsistencyCheck(c)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(c,l,a)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,l)).next(()=>u.localDocuments.getDocuments(c,l))})}(r.localStore,e);nu(r,e,t),tu(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),yield ut(r,i)}catch(i){yield mt(i)}}),Ja.apply(this,arguments)}function eu(){return eu=(0,g.Z)(function*(n,e){const t=E(n);Pt(t.remoteStore)||x("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const r=yield function(o){const a=E(o);return a.persistence.runTransaction("Get highest unacknowledged batch id","readonly",u=>a.mutationQueue.getHighestUnacknowledgedBatchId(u))}(t.localStore);if(-1===r)return void e.resolve();const i=t.ba.get(r)||[];i.push(e),t.ba.set(r,i)}catch(r){const i=Bn(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}}),eu.apply(this,arguments)}function tu(n,e){(n.ba.get(e)||[]).forEach(t=>{t.resolve()}),n.ba.delete(e)}function nu(n,e,t){const r=E(n);let i=r.Sa[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),r.Sa[r.currentUser.toKey()]=i}}function Gn(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.fa.get(e))n.ma.delete(r),t&&n.Va.Fa(r,t);n.fa.delete(e),n.isPrimaryClient&&n.wa.Rr(e).forEach(r=>{n.wa.containsKey(r)||Kd(n,r)})}function Kd(n,e){n.ga.delete(e.path.canonicalString());const t=n.pa.get(e);null!==t&&(Wr(n.remoteStore,t),n.pa=n.pa.remove(e),n.ya.delete(t),iu(n))}function ru(n,e,t){for(const r of t)r instanceof qd?(n.wa.addReference(r.key,e),Kg(n,r)):r instanceof Ud?(x("SyncEngine","Document no longer in limbo: "+r.key),n.wa.removeReference(r.key,e),n.wa.containsKey(r.key)||Kd(n,r.key)):A()}function Kg(n,e){const t=e.key,r=t.path.canonicalString();n.pa.get(t)||n.ga.has(r)||(x("SyncEngine","New document in limbo: "+t),n.ga.add(r),iu(n))}function iu(n){for(;n.ga.size>0&&n.pa.size<n.maxConcurrentLimboResolutions;){const e=n.ga.values().next().value;n.ga.delete(e);const t=new v(B.fromString(e)),r=n.Da.next();n.ya.set(r,new Mg(t)),n.pa=n.pa.insert(t,r),_s(n.remoteStore,new at(be(Tn(t.path)),r,"TargetPurposeLimboResolution",Me._e))}}function ut(n,e,t){return su.apply(this,arguments)}function su(){return su=(0,g.Z)(function*(n,e,t){const r=E(n),i=[],s=[],o=[];var a;r.ma.isEmpty()||(r.ma.forEach((a,u)=>{o.push(r.va(u,e,t).then(c=>{if((c||t)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(u.targetId,null!=c&&c.fromCache?"not-current":"current"),c){i.push(c);const l=ca.Qi(u.targetId,c);s.push(l)}}))}),yield Promise.all(o),r.Va.a_(i),yield(a=(0,g.Z)(function*(c,l){const h=E(c);try{yield h.persistence.runTransaction("notifyLocalViewChanges","readwrite",d=>_.forEach(l,f=>_.forEach(f.ki,y=>h.persistence.referenceDelegate.addReference(d,f.targetId,y)).next(()=>_.forEach(f.qi,y=>h.persistence.referenceDelegate.removeReference(d,f.targetId,y)))))}catch(d){if(!gt(d))throw d;x("LocalStore","Failed to update sequence numbers: "+d)}for(const d of l){const f=d.targetId;if(!d.fromCache){const y=h.ts.get(f),T=y.withLastLimboFreeSnapshotVersion(y.snapshotVersion);h.ts=h.ts.insert(f,T)}}}),function u(c,l){return a.apply(this,arguments)})(r.localStore,s))}),su.apply(this,arguments)}function $g(n,e){return ou.apply(this,arguments)}function ou(){return ou=(0,g.Z)(function*(n,e){const t=E(n);if(!t.currentUser.isEqual(e)){x("SyncEngine","User change. New user:",e.toKey());const r=yield yd(t.localStore,e);t.currentUser=e,(s=t).ba.forEach(a=>{a.forEach(u=>{u.reject(new p(m.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),s.ba.clear(),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield ut(t,r._s)}var s}),ou.apply(this,arguments)}function Qg(n,e){const t=E(n),r=t.ya.get(e);if(r&&r.Ra)return k().add(r.key);{let i=k();const s=t.fa.get(e);if(!s)return i;for(const o of s){const a=t.ma.get(o);i=i.unionWith(a.view.ua)}return i}}function Wg(n,e){return au.apply(this,arguments)}function au(){return au=(0,g.Z)(function*(n,e){const t=E(n),r=yield us(t.localStore,e.query,!0),i=e.view.da(r);return t.isPrimaryClient&&ru(t,e.targetId,i.Ta),i}),au.apply(this,arguments)}function Hg(n,e){return uu.apply(this,arguments)}function uu(){return uu=(0,g.Z)(function*(n,e){const t=E(n);return vd(t.localStore,e).then(r=>ut(t,r))}),uu.apply(this,arguments)}function Zg(n,e,t,r){return cu.apply(this,arguments)}function cu(){return cu=(0,g.Z)(function*(n,e,t,r){const i=E(n),s=yield function(a,u){const c=E(a),l=E(c.mutationQueue);return c.persistence.runTransaction("Lookup mutation documents","readonly",h=>l.Cn(h,u).next(d=>d?c.localDocuments.getDocuments(h,d):_.resolve(null)))}(i.localStore,e);var u;null!==s?("pending"===t?yield On(i.remoteStore):"acknowledged"===t||"rejected"===t?(nu(i,e,r||null),tu(i,e),u=e,E(E(i.localStore).mutationQueue).Fn(u)):A(),yield ut(i,s)):x("SyncEngine","Cannot apply mutation batch with id: "+e)}),cu.apply(this,arguments)}function lu(){return lu=(0,g.Z)(function*(n,e){const t=E(n);if(fu(t),mu(t),!0===e&&!0!==t.Ca){const r=t.sharedClientState.getAllActiveQueryTargets(),i=yield $d(t,r.toArray());t.Ca=!0,yield Ma(t.remoteStore,!0);for(const s of i)_s(t.remoteStore,s)}else if(!1===e&&!1!==t.Ca){const r=[];let i=Promise.resolve();t.fa.forEach((s,o)=>{t.sharedClientState.isLocalQueryTarget(o)?r.push(o):i=i.then(()=>(Gn(t,o),Fn(t.localStore,o,!0))),Wr(t.remoteStore,o)}),yield i,yield $d(t,r),function(o){const a=E(o);a.ya.forEach((u,c)=>{Wr(a.remoteStore,c)}),a.wa.Vr(),a.ya=new Map,a.pa=new Q(v.comparator)}(t),t.Ca=!1,yield Ma(t.remoteStore,!1)}}),lu.apply(this,arguments)}function $d(n,e,t){return hu.apply(this,arguments)}function hu(){return hu=(0,g.Z)(function*(n,e,t){const r=E(n),i=[],s=[];for(const o of e){let a;const u=r.fa.get(o);if(u&&0!==u.length){a=yield kn(r.localStore,be(u[0]));for(const c of u){const l=r.ma.get(c),h=yield Wg(r,l);h.snapshot&&s.push(h.snapshot)}}else{const c=yield Ed(r.localStore,o);a=yield kn(r.localStore,c),yield $a(r,Qd(c),o,!1,a.resumeToken)}i.push(a)}return r.Va.a_(s),i}),hu.apply(this,arguments)}function Qd(n){return Xl(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function Xg(n){return t=E(n).localStore,E(E(t).persistence).Bi();var t}function Jg(n,e,t,r){return du.apply(this,arguments)}function du(){return du=(0,g.Z)(function*(n,e,t,r){const i=E(n);if(i.Ca)return void x("SyncEngine","Ignoring unexpected query state notification.");const s=i.fa.get(e);if(s&&s.length>0)switch(t){case"current":case"not-current":{const o=yield vd(i.localStore,nh(s[0])),a=kr.createSynthesizedRemoteEventForCurrentChange(e,"current"===t,ce.EMPTY_BYTE_STRING);yield ut(i,o,a);break}case"rejected":yield Fn(i.localStore,e,!0),Gn(i,e,r);break;default:A()}}),du.apply(this,arguments)}function ep(n,e,t){return _u.apply(this,arguments)}function _u(){return _u=(0,g.Z)(function*(n,e,t){const r=fu(n);if(r.Ca){for(const i of e){if(r.fa.has(i)){x("SyncEngine","Adding an already active target "+i);continue}const s=yield Ed(r.localStore,i),o=yield kn(r.localStore,s);yield $a(r,Qd(s),o.targetId,!1,o.resumeToken),_s(r.remoteStore,o)}for(const i of t)r.fa.has(i)&&(yield Fn(r.localStore,i,!1).then(()=>{Wr(r.remoteStore,i),Gn(r,i)}).catch(mt))}}),_u.apply(this,arguments)}function fu(n){const e=E(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=zd.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Qg.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Ug.bind(null,e),e.Va.a_=Cg.bind(null,e.eventManager),e.Va.Fa=Dg.bind(null,e.eventManager),e}function mu(n){const e=E(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Gg.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=zg.bind(null,e),e}class Hr{constructor(){this.synchronizeTabs=!1}initialize(e){var t=this;return(0,g.Z)(function*(){t.serializer=$r(e.databaseInfo.databaseId),t.sharedClientState=t.createSharedClientState(e),t.persistence=t.createPersistence(e),yield t.persistence.start(),t.localStore=t.createLocalStore(e),t.gcScheduler=t.createGarbageCollectionScheduler(e,t.localStore),t.indexBackfillerScheduler=t.createIndexBackfillerScheduler(e,t.localStore)})()}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return xd(this.persistence,new pd,e.initialUser,this.serializer)}createPersistence(e){return new sa(ss.jr,this.serializer)}createSharedClientState(e){return new Rd}terminate(){var e=this;return(0,g.Z)(function*(){e.gcScheduler&&e.gcScheduler.stop(),yield e.sharedClientState.shutdown(),yield e.persistence.shutdown()})()}}class gu extends Hr{constructor(e,t,r){super(),this.xa=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.synchronizeTabs=!1}initialize(e){var t=()=>super.initialize,r=this;return(0,g.Z)(function*(){yield t().call(r,e),yield r.xa.initialize(r,e),yield mu(r.xa.syncEngine),yield On(r.xa.remoteStore),yield r.persistence.mi(()=>(r.gcScheduler&&!r.gcScheduler.started&&r.gcScheduler.start(),r.indexBackfillerScheduler&&!r.indexBackfillerScheduler.started&&r.indexBackfillerScheduler.start(),Promise.resolve()))})()}createLocalStore(e){return xd(this.persistence,new pd,e.initialUser,this.serializer)}createGarbageCollectionScheduler(e,t){return new ud(this.persistence.referenceDelegate.garbageCollector,e.asyncQueue,t)}createIndexBackfillerScheduler(e,t){const r=new R0(t,this.persistence);return new b0(e.asyncQueue,r)}createPersistence(e){const t=ua(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=void 0!==this.cacheSizeBytes?ve.withCacheSize(this.cacheSizeBytes):ve.DEFAULT;return new aa(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,Sd(),ds(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new Rd}}class Wd extends gu{constructor(e,t){super(e,t,!1),this.xa=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}initialize(e){var t=()=>super.initialize,r=this;return(0,g.Z)(function*(){yield t().call(r,e);const i=r.xa.syncEngine;r.sharedClientState instanceof pa&&(r.sharedClientState.syncEngine={Ys:Zg.bind(null,i),Zs:Jg.bind(null,i),Xs:ep.bind(null,i),Bi:Xg.bind(null,i),Js:Hg.bind(null,i)},yield r.sharedClientState.start()),yield r.persistence.mi(function(){var s=(0,g.Z)(function*(o){yield function Yg(n,e){return lu.apply(this,arguments)}(r.xa.syncEngine,o),r.gcScheduler&&(o&&!r.gcScheduler.started?r.gcScheduler.start():o||r.gcScheduler.stop()),r.indexBackfillerScheduler&&(o&&!r.indexBackfillerScheduler.started?r.indexBackfillerScheduler.start():o||r.indexBackfillerScheduler.stop())});return function(o){return s.apply(this,arguments)}}())})()}createSharedClientState(e){const t=Sd();if(!pa.D(t))throw new p(m.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=ua(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new pa(t,e.asyncQueue,r,e.clientId,e.initialUser)}}class zn{initialize(e,t){var r=this;return(0,g.Z)(function*(){r.localStore||(r.localStore=e.localStore,r.sharedClientState=e.sharedClientState,r.datastore=r.createDatastore(t),r.remoteStore=r.createRemoteStore(t),r.eventManager=r.createEventManager(t),r.syncEngine=r.createSyncEngine(t,!e.synchronizeTabs),r.sharedClientState.onlineStateHandler=i=>jd(r.syncEngine,i,1),r.remoteStore.remoteSyncer.handleCredentialChange=$g.bind(null,r.syncEngine),yield Ma(r.remoteStore,r.syncEngine.isPrimaryClient))})()}createEventManager(e){return new Vg}createDatastore(e){const t=$r(e.databaseInfo.databaseId),r=new _g(e.databaseInfo);return new gg(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return r=this.localStore,i=this.datastore,s=e.asyncQueue,o=t=>jd(this.syncEngine,t,0),a=Pd.D()?new Pd:new lg,new yg(r,i,s,o,a);var r,i,s,o,a}createSyncEngine(e,t){return function(i,s,o,a,u,c,l){const h=new Og(i,s,o,a,u,c);return l&&(h.Ca=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return(e=(0,g.Z)(function*(r){const i=E(r);x("RemoteStore","RemoteStore shutting down."),i.C_.add(5),yield Mn(i),i.F_.shutdown(),i.M_.set("Unknown")}),function t(r){return e.apply(this,arguments)})(this.remoteStore);var e}}function Hd(n,e=10240){let t=0;return{read:()=>(0,g.Z)(function*(){if(t<n.byteLength){const r={value:n.slice(t,t+e),done:!1};return t+=e,r}return{done:!0}})(),cancel:()=>(0,g.Z)(function*(){})(),releaseLock(){},closed:Promise.resolve()}}class ms{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Oa(this.observer.next,e)}error(e){this.observer.error?this.Oa(this.observer.error,e):ie("Uncaught Error in snapshot listener:",e.toString())}Na(){this.muted=!0}Oa(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}}class rp{constructor(e,t){this.Ba=e,this.serializer=t,this.metadata=new ue,this.buffer=new Uint8Array,this.La=new TextDecoder("utf-8"),this.ka().then(r=>{r&&r.Z_()?this.metadata.resolve(r.Y_.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is\n             ${JSON.stringify(null==r?void 0:r.Y_)}`))},r=>this.metadata.reject(r))}close(){return this.Ba.cancel()}getMetadata(){var e=this;return(0,g.Z)(function*(){return e.metadata.promise})()}Ma(){var e=this;return(0,g.Z)(function*(){return yield e.getMetadata(),e.ka()})()}ka(){var e=this;return(0,g.Z)(function*(){const t=yield e.qa();if(null===t)return null;const r=e.La.decode(t),i=Number(r);isNaN(i)&&e.Qa(`length string (${r}) is not valid number`);const s=yield e.Ka(i);return new Ng(JSON.parse(s),t.length+i)})()}$a(){return this.buffer.findIndex(e=>e==="{".charCodeAt(0))}qa(){var e=this;return(0,g.Z)(function*(){for(;e.$a()<0&&!(yield e.Ua()););if(0===e.buffer.length)return null;const t=e.$a();t<0&&e.Qa("Reached the end of bundle when a length string is expected.");const r=e.buffer.slice(0,t);return e.buffer=e.buffer.slice(t),r})()}Ka(e){var t=this;return(0,g.Z)(function*(){for(;t.buffer.length<e;)(yield t.Ua())&&t.Qa("Reached the end of bundle when more is expected.");const r=t.La.decode(t.buffer.slice(0,e));return t.buffer=t.buffer.slice(e),r})()}Qa(e){throw this.Ba.cancel(),new Error(`Invalid bundle format: ${e}`)}Ua(){var e=this;return(0,g.Z)(function*(){const t=yield e.Ba.read();if(!t.done){const r=new Uint8Array(e.buffer.length+t.value.length);r.set(e.buffer),r.set(t.value,e.buffer.length),e.buffer=r}return t.done})()}}class ip{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}lookup(e){var t=this;return(0,g.Z)(function*(){if(t.ensureCommitNotCalled(),t.mutations.length>0)throw new p(m.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");const r=yield(i=(0,g.Z)(function*(o,a){const u=E(o),c=Or(u.serializer)+"/documents",l={documents:a.map(y=>Mr(u.serializer,y))},h=yield u.Co("BatchGetDocuments",c,l,a.length),d=new Map;h.forEach(y=>{const I=function Am(n,e){return"found"in e?function(r,i){R(!!i.found);const s=Xe(r,i.found.name),o=se(i.found.updateTime),a=i.found.createTime?se(i.found.createTime):P.min(),u=new xe({mapValue:{fields:i.found.fields}});return Y.newFoundDocument(s,o,a,u)}(n,e):"missing"in e?function(r,i){R(!!i.missing),R(!!i.readTime);const s=Xe(r,i.missing),o=se(i.readTime);return Y.newNoDocument(s,o)}(n,e):A()}(u.serializer,y);d.set(I.key.toString(),I)});const f=[];return a.forEach(y=>{const I=d.get(y.toString());R(!!I),f.push(I)}),f}),function s(o,a){return i.apply(this,arguments)})(t.datastore,e);var i;return r.forEach(i=>t.recordVersion(i)),r})()}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastWriteError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new Rn(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){var e=this;return(0,g.Z)(function*(){if(e.ensureCommitNotCalled(),e.lastWriteError)throw e.lastWriteError;const t=e.readVersions;var r;e.mutations.forEach(r=>{t.delete(r.key.toString())}),t.forEach((r,i)=>{const s=v.fromPath(i);e.mutations.push(new Uo(s,e.precondition(s)))}),yield(r=(0,g.Z)(function*(s,o){const a=E(s),u=Or(a.serializer)+"/documents",c={writes:o.map(l=>Lr(a.serializer,l))};yield a.wo("Commit",u,c)}),function i(s,o){return r.apply(this,arguments)})(e.datastore,e.mutations),e.committed=!0})()}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw A();t=P.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new p(m.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(P.min())?ee.exists(!1):ee.updateTime(t):ee.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(P.min()))throw new p(m.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return ee.updateTime(t)}return ee.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}class sp{constructor(e,t,r,i,s){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=i,this.deferred=s,this.Wa=r.maxAttempts,this.zo=new ya(this.asyncQueue,"transaction_retry")}run(){this.Wa-=1,this.Ga()}Ga(){var e=this;this.zo.ko((0,g.Z)(function*(){const t=new ip(e.datastore),r=e.za(t);r&&r.then(i=>{e.asyncQueue.enqueueAndForget(()=>t.commit().then(()=>{e.deferred.resolve(i)}).catch(s=>{e.ja(s)}))}).catch(i=>{e.ja(i)})}))}za(e){try{const t=this.updateFunction(e);return!yr(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}ja(e){this.Wa>0&&this.Ha(e)?(this.Wa-=1,this.asyncQueue.enqueueAndForget(()=>(this.Ga(),Promise.resolve()))):this.deferred.reject(e)}Ha(e){if("FirebaseError"===e.name){const t=e.code;return"aborted"===t||"failed-precondition"===t||"already-exists"===t||!Ih(t)}return!1}}class op{constructor(e,t,r,i){var s=this;this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=de.UNAUTHENTICATED,this.clientId=gl.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,function(){var o=(0,g.Z)(function*(a){x("FirestoreClient","Received user=",a.uid),yield s.authCredentialListener(a),s.user=a});return function(a){return o.apply(this,arguments)}}()),this.appCheckCredentials.start(r,o=>(x("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}getConfiguration(){var e=this;return(0,g.Z)(function*(){return{asyncQueue:e.asyncQueue,databaseInfo:e.databaseInfo,clientId:e.clientId,authCredentials:e.authCredentials,appCheckCredentials:e.appCheckCredentials,initialUser:e.user,maxConcurrentLimboResolutions:100}})()}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new p(m.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){var e=this;this.asyncQueue.enterRestrictedMode();const t=new ue;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((0,g.Z)(function*(){try{e._onlineComponents&&(yield e._onlineComponents.terminate()),e._offlineComponents&&(yield e._offlineComponents.terminate()),e.authCredentials.shutdown(),e.appCheckCredentials.shutdown(),t.resolve()}catch(r){const i=Bn(r,"Failed to shutdown persistence");t.reject(i)}})),t.promise}}function gs(n,e){return pu.apply(this,arguments)}function pu(){return pu=(0,g.Z)(function*(n,e){n.asyncQueue.verifyOperationInProgress(),x("FirestoreClient","Initializing OfflineComponentProvider");const t=yield n.getConfiguration();yield e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(function(){var i=(0,g.Z)(function*(s){r.isEqual(s)||(yield yd(e.localStore,s),r=s)});return function(s){return i.apply(this,arguments)}}()),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}),pu.apply(this,arguments)}function xu(n,e){return yu.apply(this,arguments)}function yu(){return yu=(0,g.Z)(function*(n,e){n.asyncQueue.verifyOperationInProgress();const t=yield Iu(n);x("FirestoreClient","Initializing OnlineComponentProvider");const r=yield n.getConfiguration();yield e.initialize(t,r),n.setCredentialChangeListener(i=>Md(e.remoteStore,i)),n.setAppCheckTokenChangeListener((i,s)=>Md(e.remoteStore,s)),n._onlineComponents=e}),yu.apply(this,arguments)}function Zd(n){return"FirebaseError"===n.name?n.code===m.FAILED_PRECONDITION||n.code===m.UNIMPLEMENTED:!(typeof DOMException<"u"&&n instanceof DOMException)||22===n.code||20===n.code||11===n.code}function Iu(n){return Tu.apply(this,arguments)}function Tu(){return Tu=(0,g.Z)(function*(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){x("FirestoreClient","Using user provided OfflineComponentProvider");try{yield gs(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!Zd(t))throw t;Se("Error using user provided cache. Falling back to memory cache: "+t),yield gs(n,new Hr)}}else x("FirestoreClient","Using default OfflineComponentProvider"),yield gs(n,new Hr);return n._offlineComponents}),Tu.apply(this,arguments)}function ps(n){return Eu.apply(this,arguments)}function Eu(){return Eu=(0,g.Z)(function*(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(x("FirestoreClient","Using user provided OnlineComponentProvider"),yield xu(n,n._uninitializedComponentsProvider._online)):(x("FirestoreClient","Using default OnlineComponentProvider"),yield xu(n,new zn))),n._onlineComponents}),Eu.apply(this,arguments)}function Yd(n){return Iu(n).then(e=>e.persistence)}function jn(n){return Iu(n).then(e=>e.localStore)}function Xd(n){return ps(n).then(e=>e.remoteStore)}function vu(n){return ps(n).then(e=>e.syncEngine)}function Kn(n){return wu.apply(this,arguments)}function wu(){return wu=(0,g.Z)(function*(n){const e=yield ps(n),t=e.eventManager;return t.onListen=Lg.bind(null,e.syncEngine),t.onUnlisten=Bg.bind(null,e.syncEngine),t}),wu.apply(this,arguments)}function e_(n,e,t={}){const r=new ue;return n.asyncQueue.enqueueAndForget((0,g.Z)(function*(){return function(s,o,a,u,c){const l=new ms({next:d=>{o.enqueueAndForget(()=>Ua(s,h));const f=d.docs.has(a);!f&&d.fromCache?c.reject(new p(m.UNAVAILABLE,"Failed to get document because the client is offline.")):f&&d.fromCache&&u&&"server"===u.source?c.reject(new p(m.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(d)},error:d=>c.reject(d)}),h=new ja(Tn(a.path),l,{includeMetadataChanges:!0,J_:!0});return Ba(s,h)}(yield Kn(n),n.asyncQueue,e,t,r)})),r.promise}function t_(n,e,t={}){const r=new ue;return n.asyncQueue.enqueueAndForget((0,g.Z)(function*(){return function(s,o,a,u,c){const l=new ms({next:d=>{o.enqueueAndForget(()=>Ua(s,h)),d.fromCache&&"server"===u.source?c.reject(new p(m.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(d)},error:d=>c.reject(d)}),h=new ja(a,l,{includeMetadataChanges:!0,J_:!0});return Ba(s,h)}(yield Kn(n),n.asyncQueue,e,t,r)})),r.promise}function n_(n){const e={};return void 0!==n.timeoutSeconds&&(e.timeoutSeconds=n.timeoutSeconds),e}const r_=new Map;function Au(n,e,t){if(!t)throw new p(m.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function i_(n,e,t,r){if(!0===e&&!0===r)throw new p(m.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function s_(n){if(!v.isDocumentKey(n))throw new p(m.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function o_(n){if(v.isDocumentKey(n))throw new p(m.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function xs(n){if(void 0===n)return"undefined";if(null===n)return"null";if("string"==typeof n)return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if("number"==typeof n||"boolean"==typeof n)return""+n;if("object"==typeof n){if(n instanceof Array)return"an array";{const e=(r=n).constructor?r.constructor.name:null;return e?`a custom ${e} object`:"an object"}}var r;return"function"==typeof n?"a function":A()}function M(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new p(m.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=xs(n);throw new p(m.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function a_(n,e){if(e<=0)throw new p(m.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}class u_{constructor(e){var t,r;if(void 0===e.host){if(void 0!==e.ssl)throw new p(m.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new p(m.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}i_("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!(this.experimentalForceLongPolling||void 0!==e.experimentalAutoDetectLongPolling&&!e.experimentalAutoDetectLongPolling),this.experimentalLongPollingOptions=n_(null!==(r=e.experimentalLongPollingOptions)&&void 0!==r?r:{}),function(s){if(void 0!==s.timeoutSeconds){if(isNaN(s.timeoutSeconds))throw new p(m.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new p(m.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new p(m.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.experimentalLongPollingOptions.timeoutSeconds===e.experimentalLongPollingOptions.timeoutSeconds&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Zr{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new u_({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new p(m.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new p(m.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new u_(e),void 0!==e.credentials&&(this._authCredentials=function(r){if(!r)return new f0;switch(r.type){case"firstParty":return new x0(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new p(m.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const r=r_.get(t);r&&(x("ComponentProvider","Removing Datastore"),r_.delete(t),r.terminate())}(this),Promise.resolve()}}class ye{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new ye(this.firestore,e,this._query)}}class X{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Je(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new X(this.firestore,e,this._key)}}class Je extends ye{constructor(e,t,r){super(e,t,Tn(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new X(this.firestore,null,new v(e))}withConverter(e){return new Je(this.firestore,e,this._path)}}function l_(n,e,...t){if(n=(0,$.m9)(n),Au("collection","path",e),n instanceof Zr){const r=B.fromString(e,...t);return o_(r),new Je(n,null,r)}{if(!(n instanceof X||n instanceof Je))throw new p(m.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(B.fromString(e,...t));return o_(r),new Je(n.firestore,null,r)}}function ys(n,e,...t){if(n=(0,$.m9)(n),1===arguments.length&&(e=gl.newId()),Au("doc","path",e),n instanceof Zr){const r=B.fromString(e,...t);return s_(r),new X(n,null,new v(r))}{if(!(n instanceof X||n instanceof Je))throw new p(m.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(B.fromString(e,...t));return s_(r),new X(n.firestore,n instanceof Je?n.converter:null,new v(r))}}function h_(n,e){return n=(0,$.m9)(n),e=(0,$.m9)(e),(n instanceof X||n instanceof Je)&&(e instanceof X||e instanceof Je)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function bu(n,e){return n=(0,$.m9)(n),e=(0,$.m9)(e),n instanceof ye&&e instanceof ye&&n.firestore===e.firestore&&Rr(n._query,e._query)&&n.converter===e.converter}class xp{constructor(){this.Ja=Promise.resolve(),this.Ya=[],this.Za=!1,this.Xa=[],this.eu=null,this.tu=!1,this.nu=!1,this.ru=[],this.zo=new ya(this,"async_queue_retry"),this.iu=()=>{const t=ds();t&&x("AsyncQueue","Visibility state changed to "+t.visibilityState),this.zo.Qo()};const e=ds();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.iu)}get isShuttingDown(){return this.Za}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.su(),this.ou(e)}enterRestrictedMode(e){if(!this.Za){this.Za=!0,this.nu=e||!1;const t=ds();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.iu)}}enqueue(e){if(this.su(),this.Za)return new Promise(()=>{});const t=new ue;return this.ou(()=>this.Za&&this.nu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Ya.push(e),this._u()))}_u(){var e=this;return(0,g.Z)(function*(){if(0!==e.Ya.length){try{yield e.Ya[0](),e.Ya.shift(),e.zo.reset()}catch(t){if(!gt(t))throw t;x("AsyncQueue","Operation failed with retryable error: "+t)}e.Ya.length>0&&e.zo.ko(()=>e._u())}})()}ou(e){const t=this.Ja.then(()=>(this.tu=!0,e().catch(r=>{throw this.eu=r,this.tu=!1,ie("INTERNAL UNHANDLED ERROR: ",function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+"\n"+o.stack),a}(r)),r}).then(r=>(this.tu=!1,r))));return this.Ja=t,t}enqueueAfterDelay(e,t,r){this.su(),this.ru.indexOf(e)>-1&&(t=0);const i=La.createAndSchedule(this,e,t,r,s=>this.au(s));return this.Xa.push(i),i}su(){this.eu&&A()}verifyOperationInProgress(){}uu(){var e=this;return(0,g.Z)(function*(){let t;do{t=e.Ja,yield t}while(t!==e.Ja)})()}cu(e){for(const t of this.Xa)if(t.timerId===e)return!0;return!1}lu(e){return this.uu().then(()=>{this.Xa.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(const t of this.Xa)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.uu()})}hu(e){this.ru.push(e)}au(e){const t=this.Xa.indexOf(e);this.Xa.splice(t,1)}}function Ru(n){return function(t,r){if("object"!=typeof t||null===t)return!1;const i=t;for(const s of["next","error","complete"])if(s in i&&"function"==typeof i[s])return!0;return!1}(n)}class yp{constructor(){this._progressObserver={},this._taskCompletionResolver=new ue,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,r){this._progressObserver={next:e,error:t,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}class W extends Zr{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new xp,this._persistenceKey=(null==i?void 0:i.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||d_(this),this._firestoreClient.terminate()}}function re(n){return n._firestoreClient||d_(n),n._firestoreClient.verifyNotTerminated(),n._firestoreClient}function d_(n){var e,t,r;const i=n._freezeSettings(),s=(u=(null===(e=n._app)||void 0===e?void 0:e.options.appId)||"",new W0(n._databaseId,u,n._persistenceKey,(l=i).host,l.ssl,l.experimentalForceLongPolling,l.experimentalAutoDetectLongPolling,n_(l.experimentalLongPollingOptions),l.useFetchStreams));var u,l;n._firestoreClient=new op(n._authCredentials,n._appCheckCredentials,n._queue,s),null!==(t=i.localCache)&&void 0!==t&&t._offlineComponentProvider&&null!==(r=i.localCache)&&void 0!==r&&r._onlineComponentProvider&&(n._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}function __(n,e,t){const r=new ue;return n.asyncQueue.enqueue((0,g.Z)(function*(){try{yield gs(n,t),yield xu(n,e),r.resolve()}catch(i){const s=i;if(!Zd(s))throw s;Se("Error enabling indexeddb cache. Falling back to memory cache: "+s),r.reject(s)}})).then(()=>r.promise)}function f_(n){if(n._initialized||n._terminated)throw new p(m.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}class et{constructor(e){this._byteString=e}static fromBase64String(e){try{return new et(ce.fromBase64String(e))}catch(t){throw new p(m.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new et(ce.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class ct{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new p(m.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Z(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Xt{constructor(e){this._methodName=e}}class Is{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new p(m.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new p(m.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return D(this._lat,e._lat)||D(this._long,e._long)}}const Vp=/^__.*__$/;class Cp{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return null!==this.fieldMask?new ot(e,this.data,this.fieldMask,t,this.fieldTransforms):new bn(e,this.data,t,this.fieldTransforms)}}class m_{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new ot(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function g_(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw A()}}class Ts{constructor(e,t,r,i,s,o){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,void 0===s&&this.Pu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Iu(){return this.settings.Iu}Tu(e){return new Ts(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Eu(e){var t;const r=null===(t=this.path)||void 0===t?void 0:t.child(e),i=this.Tu({path:r,du:!1});return i.Au(e),i}Ru(e){var t;const r=null===(t=this.path)||void 0===t?void 0:t.child(e),i=this.Tu({path:r,du:!1});return i.Pu(),i}Vu(e){return this.Tu({path:void 0,du:!0})}mu(e){return ws(e,this.settings.methodName,this.settings.fu||!1,this.path,this.settings.gu)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}Pu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Au(this.path.get(e))}Au(e){if(0===e.length)throw this.mu("Document fields must not be empty");if(g_(this.Iu)&&Vp.test(e))throw this.mu('Document fields cannot begin and end with "__"')}}class Dp{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||$r(e)}pu(e,t,r,i=!1){return new Ts({Iu:e,methodName:t,gu:r,path:Z.emptyPath(),du:!1,fu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Jt(n){const e=n._freezeSettings(),t=$r(n._databaseId);return new Dp(n._databaseId,!!e.ignoreUndefinedProperties,t)}function Es(n,e,t,r,i,s={}){const o=n.pu(s.merge||s.mergeFields?2:0,e,t,i);Cu("Data must be an object, but it was:",o,r);const a=y_(r,o);let u,c;if(s.merge)u=new Ve(o.fieldMask),c=o.fieldTransforms;else if(s.mergeFields){const l=[];for(const h of s.mergeFields){const d=Jr(e,h,t);if(!o.contains(d))throw new p(m.INVALID_ARGUMENT,`Field '${d}' is specified in your field mask but missing from your input data.`);T_(l,d)||l.push(d)}u=new Ve(l),c=o.fieldTransforms.filter(h=>u.covers(h.field))}else u=null,c=o.fieldTransforms;return new Cp(new xe(a),u,c)}class Xr extends Xt{_toFieldTransform(e){if(2!==e.Iu)throw e.mu(1===e.Iu?`${this._methodName}() can only appear at the top level of your update data`:`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Xr}}function p_(n,e,t){return new Ts({Iu:3,gu:e.settings.gu,methodName:n._methodName,du:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class Pu extends Xt{_toFieldTransform(e){return new Cr(e.path,new wn)}isEqual(e){return e instanceof Pu}}class Np extends Xt{constructor(e,t){super(e),this.yu=t}_toFieldTransform(e){const t=p_(this,e,!0),r=this.yu.map(s=>en(s,t)),i=new zt(r);return new Cr(e.path,i)}isEqual(e){return this===e}}class kp extends Xt{constructor(e,t){super(e),this.yu=t}_toFieldTransform(e){const t=p_(this,e,!0),r=this.yu.map(s=>en(s,t)),i=new jt(r);return new Cr(e.path,i)}isEqual(e){return this===e}}class Fp extends Xt{constructor(e,t){super(e),this.wu=t}_toFieldTransform(e){const t=new An(e.serializer,ch(e.serializer,this.wu));return new Cr(e.path,t)}isEqual(e){return this===e}}function Su(n,e,t,r){const i=n.pu(1,e,t);Cu("Data must be an object, but it was:",i,r);const s=[],o=xe.empty();pt(r,(u,c)=>{const l=vs(e,u,t);c=(0,$.m9)(c);const h=i.Ru(l);if(c instanceof Xr)s.push(l);else{const d=en(c,h);null!=d&&(s.push(l),o.set(l,d))}});const a=new Ve(s);return new m_(o,a,i.fieldTransforms)}function Vu(n,e,t,r,i,s){const o=n.pu(1,e,t),a=[Jr(e,r,t)],u=[i];if(s.length%2!=0)throw new p(m.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let d=0;d<s.length;d+=2)a.push(Jr(e,s[d])),u.push(s[d+1]);const c=[],l=xe.empty();for(let d=a.length-1;d>=0;--d)if(!T_(c,a[d])){const f=a[d];let y=u[d];y=(0,$.m9)(y);const I=o.Ru(f);if(y instanceof Xr)c.push(f);else{const T=en(y,I);null!=T&&(c.push(f),l.set(f,T))}}const h=new Ve(c);return new m_(l,h,o.fieldTransforms)}function x_(n,e,t,r=!1){return en(t,n.pu(r?4:3,e))}function en(n,e){if(I_(n=(0,$.m9)(n)))return Cu("Unsupported field value:",e,n),y_(n,e);if(n instanceof Xt)return function(r,i){if(!g_(i.Iu))throw i.mu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.mu(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(n,e),null;if(void 0===n&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.du&&4!==e.Iu)throw e.mu("Nested arrays are not supported");return function(r,i){const s=[];let o=0;for(const a of r){let u=en(a,i.Vu(o));null==u&&(u={nullValue:"NULL_VALUE"}),s.push(u),o++}return{arrayValue:{values:s}}}(n,e)}return function(r,i){if(null===(r=(0,$.m9)(r)))return{nullValue:"NULL_VALUE"};if("number"==typeof r)return ch(i.serializer,r);if("boolean"==typeof r)return{booleanValue:r};if("string"==typeof r)return{stringValue:r};if(r instanceof Date){const s=J.fromDate(r);return{timestampValue:Pn(i.serializer,s)}}if(r instanceof J){const s=new J(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Pn(i.serializer,s)}}if(r instanceof Is)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof et)return{bytesValue:Vh(i.serializer,r._byteString)};if(r instanceof X){const s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.mu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:Qo(r.firestore._databaseId||i.databaseId,r._key.path)}}throw i.mu(`Unsupported field value: ${xs(r)}`)}(n,e)}function y_(n,e){const t={};return Cl(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):pt(n,(r,i)=>{const s=en(i,e.Eu(r));null!=s&&(t[r]=s)}),{mapValue:{fields:t}}}function I_(n){return!("object"!=typeof n||null===n||n instanceof Array||n instanceof Date||n instanceof J||n instanceof Is||n instanceof et||n instanceof X||n instanceof Xt)}function Cu(n,e,t){if(!I_(t)||"object"!=typeof(i=t)||null===i||Object.getPrototypeOf(i)!==Object.prototype&&null!==Object.getPrototypeOf(i)){const r=xs(t);throw e.mu("an object"===r?n+" a custom object":n+" "+r)}var i}function Jr(n,e,t){if((e=(0,$.m9)(e))instanceof ct)return e._internalPath;if("string"==typeof e)return vs(n,e);throw ws("Field path arguments must be of type string or ",n,!1,void 0,t)}const Mp=new RegExp("[~\\*/\\[\\]]");function vs(n,e,t){if(e.search(Mp)>=0)throw ws(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new ct(...e.split("."))._internalPath}catch{throw ws(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function ws(n,e,t,r,i){const s=r&&!r.isEmpty(),o=void 0!==i;let a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let u="";return(s||o)&&(u+=" (found",s&&(u+=` in field ${r}`),o&&(u+=` in document ${i}`),u+=")"),new p(m.INVALID_ARGUMENT,a+n+u)}function T_(n,e){return n.some(t=>t.isEqual(e))}class ei{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new X(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new Op(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(As("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class Op extends ei{data(){return super.data()}}function As(n,e){return"string"==typeof e?vs(n,e):e instanceof ct?e._internalPath:e._delegate._internalPath}function E_(n){if("L"===n.limitType&&0===n.explicitOrderBy.length)throw new p(m.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Du{}class ti extends Du{}function Vt(n,e,...t){let r=[];e instanceof Du&&r.push(e),r=r.concat(t),function(s){const o=s.filter(u=>u instanceof $n).length,a=s.filter(u=>u instanceof ni).length;if(o>1||o>0&&a>0)throw new p(m.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)n=i._apply(n);return n}class ni extends ti{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new ni(e,t,r)}_apply(e){const t=this._parse(e);return b_(e._query,t),new ye(e.firestore,e.converter,Bo(e._query,t))}_parse(e){const t=Jt(e.firestore);return function(s,o,a,u,c,l,h){let d;if(c.isKeyField()){if("array-contains"===l||"array-contains-any"===l)throw new p(m.INVALID_ARGUMENT,`Invalid Query. You can't perform '${l}' queries on documentId().`);if("in"===l||"not-in"===l){A_(h,l);const f=[];for(const y of h)f.push(w_(u,s,y));d={arrayValue:{values:f}}}else d=w_(u,s,h)}else"in"!==l&&"not-in"!==l&&"array-contains-any"!==l||A_(h,l),d=x_(a,"where",h,"in"===l||"not-in"===l);return O.create(c,l,d)}(e._query,0,t,e.firestore._databaseId,this._field,this._op,this._value)}}class $n extends Du{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new $n(e,t)}_parse(e){const t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return 1===t.length?t[0]:j.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(i,s){let o=i;const a=s.getFlattenedFilters();for(const u of a)b_(o,u),o=Bo(o,u)}(e._query,t),new ye(e.firestore,e.converter,Bo(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class Nu extends ti{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new Nu(e,t)}_apply(e){const t=function(i,s,o){if(null!==i.startAt)throw new p(m.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==i.endAt)throw new p(m.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Ar(s,o)}(e._query,this._field,this._direction);return new ye(e.firestore,e.converter,function(i,s){const o=i.explicitOrderBy.concat([s]);return new it(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,t))}}class bs extends ti{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new bs(e,t,r)}_apply(e){return new ye(e.firestore,e.converter,$i(e._query,this._limit,this._limitType))}}class Rs extends ti{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new Rs(e,t,r)}_apply(e){const t=v_(e,this.type,this._docOrFields,this._inclusive);return new ye(e.firestore,e.converter,(s=t,new it((i=e._query).path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,s,i.endAt)));var i,s}}class Ps extends ti{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new Ps(e,t,r)}_apply(e){const t=v_(e,this.type,this._docOrFields,this._inclusive);return new ye(e.firestore,e.converter,(s=t,new it((i=e._query).path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,s)));var i,s}}function v_(n,e,t,r){if(t[0]=(0,$.m9)(t[0]),t[0]instanceof ei)return function(s,o,a,u,c){if(!u)throw new p(m.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);const l=[];for(const h of En(s))if(h.field.isKeyField())l.push(Ut(o,u.key));else{const d=u.data.field(h.field);if(Bi(d))throw new p(m.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+h.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===d){const f=h.field.canonicalString();throw new p(m.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${f}' (used as the orderBy) does not exist.`)}l.push(d)}return new vt(l,c)}(n._query,n.firestore._databaseId,e,t[0]._document,r);{const i=Jt(n.firestore);return function(o,a,u,c,l,h){const d=o.explicitOrderBy;if(l.length>d.length)throw new p(m.INVALID_ARGUMENT,`Too many arguments provided to ${c}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const f=[];for(let y=0;y<l.length;y++){const I=l[y];if(d[y].field.isKeyField()){if("string"!=typeof I)throw new p(m.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${c}(), but got a ${typeof I}`);if(!Lo(o)&&-1!==I.indexOf("/"))throw new p(m.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${c}() must be a plain document ID, but '${I}' contains a slash.`);const T=o.path.child(B.fromString(I));if(!v.isDocumentKey(T))throw new p(m.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${c}() must result in a valid document path, but '${T}' is not because it contains an odd number of segments.`);const S=new v(T);f.push(Ut(a,S))}else{const T=x_(u,c,I);f.push(T)}}return new vt(f,h)}(n._query,n.firestore._databaseId,i,e,t,r)}}function w_(n,e,t){if("string"==typeof(t=(0,$.m9)(t))){if(""===t)throw new p(m.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Lo(e)&&-1!==t.indexOf("/"))throw new p(m.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(B.fromString(t));if(!v.isDocumentKey(r))throw new p(m.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Ut(n,new v(r))}if(t instanceof X)return Ut(n,t._key);throw new p(m.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${xs(t)}.`)}function A_(n,e){if(!Array.isArray(n)||0===n.length)throw new p(m.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function b_(n,e){const t=function(i,s){for(const o of i)for(const a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(n.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==t)throw new p(m.INVALID_ARGUMENT,t===e.op?`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`:`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class ku{convertValue(e,t="none"){switch(Tt(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ne(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(rt(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw A()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return pt(e,(i,s)=>{r[i]=this.convertValue(s,t)}),r}convertGeoPoint(e){return new Is(ne(e.latitude),ne(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":const r=qi(e);return null==r?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Tr(e));default:return null}}convertTimestamp(e){const t=xt(e);return new J(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=B.fromString(e);R(qh(r));const i=new yt(r.get(1),r.get(3)),s=new v(r.popFirst(5));return i.isEqual(t)||ie(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}function Ss(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}class $p extends ku{constructor(e){super(),this.firestore=e}convertBytes(e){return new et(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new X(this.firestore,null,t)}}class tn{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class lt extends ei{constructor(e,t,r,i,s,o){super(e,t,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new ri(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(As("DocumentSnapshot.get",e));if(null!==r)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}}class ri extends lt{data(e={}){return super.data(e)}}class Ct{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new tn(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new ri(this._firestore,this._userDataWriter,r.key,r,new tn(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new p(m.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>({type:"added",doc:new ri(i._firestore,i._userDataWriter,a.doc.key,a.doc,new tn(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter),oldIndex:-1,newIndex:o++}))}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||3!==a.type).map(a=>{const u=new ri(i._firestore,i._userDataWriter,a.doc.key,a.doc,new tn(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);let c=-1,l=-1;return 0!==a.type&&(c=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),1!==a.type&&(o=o.add(a.doc),l=o.indexOf(a.doc.key)),{type:Wp(a.type),doc:u,oldIndex:c,newIndex:l}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function Wp(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return A()}}function P_(n,e){return n instanceof lt&&e instanceof lt?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(null===n._document?null===e._document:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof Ct&&e instanceof Ct&&n._firestore===e._firestore&&bu(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}class Dt extends ku{constructor(e){super(),this.firestore=e}convertBytes(e){return new et(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new X(this.firestore,null,t)}}function S_(n,e,t){n=M(n,X);const r=M(n.firestore,W),i=Ss(n.converter,e,t);return Qn(r,[Es(Jt(r),"setDoc",n._key,i,null!==n.converter,t).toMutation(n._key,ee.none())])}function V_(n,e,t,...r){n=M(n,X);const i=M(n.firestore,W),s=Jt(i);let o;return o="string"==typeof(e=(0,$.m9)(e))||e instanceof ct?Vu(s,"updateDoc",n._key,e,t,r):Su(s,"updateDoc",n._key,e),Qn(i,[o.toMutation(n._key,ee.exists(!0))])}function C_(n,...e){var t,r,i;n=(0,$.m9)(n);let s={includeMetadataChanges:!1},o=0;"object"!=typeof e[o]||Ru(e[o])||(s=e[o],o++);const a={includeMetadataChanges:s.includeMetadataChanges};if(Ru(e[o])){const h=e[o];e[o]=null===(t=h.next)||void 0===t?void 0:t.bind(h),e[o+1]=null===(r=h.error)||void 0===r?void 0:r.bind(h),e[o+2]=null===(i=h.complete)||void 0===i?void 0:i.bind(h)}let u,c,l;if(n instanceof X)c=M(n.firestore,W),l=Tn(n._key.path),u={next:h=>{e[o]&&e[o](Fu(c,n,h))},error:e[o+1],complete:e[o+2]};else{const h=M(n,ye);c=M(h.firestore,W),l=h._query;const d=new Dt(c);u={next:f=>{e[o]&&e[o](new Ct(c,d,h,f))},error:e[o+1],complete:e[o+2]},E_(n._query)}return function(d,f,y,I){const T=new ms(I),S=new ja(f,T,y);return d.asyncQueue.enqueueAndForget((0,g.Z)(function*(){return Ba(yield Kn(d),S)})),()=>{T.Na(),d.asyncQueue.enqueueAndForget((0,g.Z)(function*(){return Ua(yield Kn(d),S)}))}}(re(c),l,a,u)}function Qn(n,e){return function(r,i){const s=new ue;return r.asyncQueue.enqueueAndForget((0,g.Z)(function*(){return function qg(n,e,t){return Ha.apply(this,arguments)}(yield vu(r),i,s)})),s.promise}(re(n),e)}function Fu(n,e,t){const r=t.docs.get(e._key),i=new Dt(n);return new lt(n,i,e._key,r,new tn(t.hasPendingWrites,t.fromCache),e.converter)}const dx={maxAttempts:5};class D_{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Jt(e)}set(e,t,r){this._verifyNotCommitted();const i=Nt(e,this._firestore),s=Ss(i.converter,t,r),o=Es(this._dataReader,"WriteBatch.set",i._key,s,null!==i.converter,r);return this._mutations.push(o.toMutation(i._key,ee.none())),this}update(e,t,r,...i){this._verifyNotCommitted();const s=Nt(e,this._firestore);let o;return o="string"==typeof(t=(0,$.m9)(t))||t instanceof ct?Vu(this._dataReader,"WriteBatch.update",s._key,t,r,i):Su(this._dataReader,"WriteBatch.update",s._key,t),this._mutations.push(o.toMutation(s._key,ee.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=Nt(e,this._firestore);return this._mutations=this._mutations.concat(new Rn(t._key,ee.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new p(m.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Nt(n,e){if((n=(0,$.m9)(n)).firestore!==e)throw new p(m.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}class _x extends class{constructor(t,r){this._firestore=t,this._transaction=r,this._dataReader=Jt(t)}get(t){const r=Nt(t,this._firestore),i=new $p(this._firestore);return this._transaction.lookup([r._key]).then(s=>{if(!s||1!==s.length)return A();const o=s[0];if(o.isFoundDocument())return new ei(this._firestore,i,o.key,o,r.converter);if(o.isNoDocument())return new ei(this._firestore,i,r._key,null,r.converter);throw A()})}set(t,r,i){const s=Nt(t,this._firestore),o=Ss(s.converter,r,i),a=Es(this._dataReader,"Transaction.set",s._key,o,null!==s.converter,i);return this._transaction.set(s._key,a),this}update(t,r,i,...s){const o=Nt(t,this._firestore);let a;return a="string"==typeof(r=(0,$.m9)(r))||r instanceof ct?Vu(this._dataReader,"Transaction.update",o._key,r,i,s):Su(this._dataReader,"Transaction.update",o._key,r),this._transaction.update(o._key,a),this}delete(t){const r=Nt(t,this._firestore);return this._transaction.delete(r._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=Nt(e,this._firestore),r=new Dt(this._firestore);return super.get(e).then(i=>new lt(this._firestore,r,t._key,i._document,new tn(!1,!1),t.converter))}}function Ou(n,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new p("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return e}function M_(){if(typeof Uint8Array>"u")throw new p("unimplemented","Uint8Arrays are not available in this environment.")}function O_(){if(!function $0(){return typeof atob<"u"}())throw new p("unimplemented","Blobs are unavailable in Firestore in this environment.")}!function(e,t=!0){_n=ci.SDK_VERSION,(0,ci._registerComponent)(new Hu.wA("firestore",(r,{instanceIdentifier:i,options:s})=>{const o=r.getProvider("app").getImmediate(),a=new W(new g0(r.getProvider("auth-internal")),new y0(r.getProvider("app-check-internal")),function(c,l){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new p(m.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new yt(c.options.projectId,l)}(o,i),o);return s=Object.assign({useFetchStreams:t},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),(0,ci.registerVersion)(_l,"4.4.0",e),(0,ci.registerVersion)(_l,"4.4.0","esm2017")}();class ii{constructor(e){this._delegate=e}static fromBase64String(e){return O_(),new ii(et.fromBase64String(e))}static fromUint8Array(e){return M_(),new ii(et.fromUint8Array(e))}toBase64(){return O_(),this._delegate.toBase64()}toUint8Array(){return M_(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}}function Lu(n){return function vx(n,e){if("object"!=typeof n||null===n)return!1;const t=n;for(const r of e)if(r in t&&"function"==typeof t[r])return!0;return!1}(n,["next","error","complete"])}class wx{enableIndexedDbPersistence(e,t){return function Tp(n,e){f_(n=M(n,W));const t=re(n);if(t._uninitializedComponentsProvider)throw new p(m.FAILED_PRECONDITION,"SDK cache is already specified.");Se("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const r=n._freezeSettings(),i=new zn;return __(t,i,new gu(i,r.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return function Ep(n){f_(n=M(n,W));const e=re(n);if(e._uninitializedComponentsProvider)throw new p(m.FAILED_PRECONDITION,"SDK cache is already specified.");Se("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings(),r=new zn;return __(e,r,new Wd(r,t.cacheSizeBytes))}(e._delegate)}clearIndexedDbPersistence(e){return function vp(n){if(n._initialized&&!n._terminated)throw new p(m.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new ue;return n._queue.enqueueAndForgetEvenWhileRestricted((0,g.Z)(function*(){try{yield(t=(0,g.Z)(function*(i){if(!ze.D())return Promise.resolve();const s=i+"main";yield ze.delete(s)}),function r(i){return t.apply(this,arguments)})(ua(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}var t})),e.promise}(e._delegate)}}class L_{constructor(e,t,r){this._delegate=t,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof yt||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&Se("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&delete(e=Object.assign(Object.assign({},t),e)).merge,this._delegate._setSettings(e)}useEmulator(e,t,r={}){!function c_(n,e,t,r={}){var i;const s=(n=M(n,Zr))._getSettings(),o=`${e}:${t}`;if("firestore.googleapis.com"!==s.host&&s.host!==o&&Se("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let a,u;if("string"==typeof r.mockUserToken)a=r.mockUserToken,u=de.MOCK_USER;else{a=(0,$.Sg)(r.mockUserToken,null===(i=n._app)||void 0===i?void 0:i.options.projectId);const c=r.mockUserToken.sub||r.mockUserToken.user_id;if(!c)throw new p(m.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");u=new de(c)}n._authCredentials=new m0(new fl(a,u))}}(this._delegate,e,t,r)}enableNetwork(){return function Ap(n){return function ap(n){return n.asyncQueue.enqueue((0,g.Z)(function*(){const e=yield Yd(n),t=yield Xd(n);return e.setNetworkEnabled(!0),function(i){const s=E(i);return s.C_.delete(0),Qr(s)}(t)}))}(re(n=M(n,W)))}(this._delegate)}disableNetwork(){return function bp(n){return function up(n){return n.asyncQueue.enqueue((0,g.Z)(function*(){const e=yield Yd(n),t=yield Xd(n);return e.setNetworkEnabled(!1),(r=(0,g.Z)(function*(s){const o=E(s);o.C_.add(0),yield Mn(o),o.M_.set("Offline")}),function i(s){return r.apply(this,arguments)})(t);var r}))}(re(n=M(n,W)))}(this._delegate)}enablePersistence(e){let t=!1,r=!1;return e&&(t=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,i_("synchronizeTabs",t,"experimentalForceOwningTab",r)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return function wp(n){return function(t){const r=new ue;return t.asyncQueue.enqueueAndForget((0,g.Z)(function*(){return function jg(n,e){return eu.apply(this,arguments)}(yield vu(t),r)})),r.promise}(re(n=M(n,W)))}(this._delegate)}onSnapshotsInSync(e){return function rx(n,e){return function hp(n,e){const t=new ms(e);return n.asyncQueue.enqueueAndForget((0,g.Z)(function*(){return i=yield Kn(n),s=t,E(i).q_.add(s),void s.next();var i,s})),()=>{t.Na(),n.asyncQueue.enqueueAndForget((0,g.Z)(function*(){return i=yield Kn(n),s=t,void E(i).q_.delete(s);var i,s}))}}(re(n=M(n,W)),Ru(e)?e:{next:e})}(this._delegate,e)}get app(){if(!this._appCompat)throw new p("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new Wn(this,l_(this._delegate,e))}catch(t){throw Re(t,"collection()","Firestore.collection()")}}doc(e){try{return new Be(this,ys(this._delegate,e))}catch(t){throw Re(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new Pe(this,function pp(n,e){if(n=M(n,Zr),Au("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new p(m.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new ye(n,null,(r=e,new it(B.emptyPath(),r)));var r}(this._delegate,e))}catch(t){throw Re(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return function fx(n,e,t){n=M(n,W);const r=Object.assign(Object.assign({},dx),t);return function(s){if(s.maxAttempts<1)throw new p(m.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(s,o,a){const u=new ue;return s.asyncQueue.enqueueAndForget((0,g.Z)(function*(){const c=yield function Jd(n){return ps(n).then(e=>e.datastore)}(s);new sp(s.asyncQueue,c,a,o,u).run()})),u.promise}(re(n),i=>e(new _x(n,i)),r)}(this._delegate,t=>e(new B_(this,t)))}batch(){return re(this._delegate),new q_(new D_(this._delegate,e=>Qn(this._delegate,e)))}loadBundle(e){return function Rp(n,e){const t=re(n=M(n,W)),r=new yp;return function dp(n,e,t,r){const i=function(o,a){let u;return u="string"==typeof o?Eh().encode(o):o,l=function(l,h){if(l instanceof Uint8Array)return Hd(l,h);if(l instanceof ArrayBuffer)return Hd(new Uint8Array(l),h);if(l instanceof ReadableStream)return l.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(u),new rp(l,a);var l}(t,$r(e));n.asyncQueue.enqueueAndForget((0,g.Z)(function*(){!function tp(n,e,t){const r=E(n);var i;(i=(0,g.Z)(function*(o,a,u){try{const c=yield a.getMetadata();if(yield function(y,I){const T=E(y),S=se(I.createTime);return T.persistence.runTransaction("hasNewerBundle","readonly",C=>T.Kr.getBundleMetadata(C,I.id)).then(C=>!!C&&C.createTime.compareTo(S)>=0)}(o.localStore,c))return yield a.close(),u._completeWith({taskState:"Success",documentsLoaded:(y=c).totalDocuments,bytesLoaded:y.totalBytes,totalDocuments:y.totalDocuments,totalBytes:y.totalBytes}),Promise.resolve(new Set);u._updateProgress(Bd(c));const l=new kg(c,o.localStore,a.serializer);let h=yield a.Ma();for(;h;){const f=yield l.ea(h);f&&u._updateProgress(f),h=yield a.Ma()}const d=yield l.complete();return yield ut(o,d.ra,void 0),yield function(y,I){const T=E(y);return T.persistence.runTransaction("Save bundle","readwrite",S=>T.Kr.saveBundleMetadata(S,I))}(o.localStore,c),u._completeWith(d.progress),Promise.resolve(d.na)}catch(c){return Se("SyncEngine",`Loading bundle failed with ${c}`),u._failWith(c),Promise.resolve(new Set)}var y}),function s(o,a,u){return i.apply(this,arguments)})(r,e,t).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}(yield vu(n),i,r)}))}(t,n._databaseId,e,r),r}(this._delegate,e)}namedQuery(e){return function Pp(n,e){return function _p(n,e){return n.asyncQueue.enqueue((0,g.Z)(function*(){return function(r,i){const s=E(r);return s.persistence.runTransaction("Get named query","readonly",o=>s.Kr.getNamedQuery(o,i))}(yield jn(n),e)}))}(re(n=M(n,W)),e).then(t=>t?new ye(n,null,t.query):null)}(this._delegate,e).then(t=>t?new Pe(this,t):null)}}class Cs extends ku{constructor(e){super(),this.firestore=e}convertBytes(e){return new ii(new et(e))}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return Be.forKey(t,this.firestore,null)}}class B_{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new Cs(e)}get(e){const t=rn(e);return this._delegate.get(t).then(r=>new si(this._firestore,new lt(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,t.converter)))}set(e,t,r){const i=rn(e);return r?(Ou("Transaction.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){const s=rn(e);return 2===arguments.length?this._delegate.update(s,t):this._delegate.update(s,t,r,...i),this}delete(e){const t=rn(e);return this._delegate.delete(t),this}}class q_{constructor(e){this._delegate=e}set(e,t,r){const i=rn(e);return r?(Ou("WriteBatch.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){const s=rn(e);return 2===arguments.length?this._delegate.update(s,t):this._delegate.update(s,t,r,...i),this}delete(e){const t=rn(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}}class nn{constructor(e,t,r){this._firestore=e,this._userDataWriter=t,this._delegate=r}fromFirestore(e,t){const r=new ri(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new oi(this._firestore,r),null!=t?t:{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){const r=nn.INSTANCES;let i=r.get(e);i||(i=new WeakMap,r.set(e,i));let s=i.get(t);return s||(s=new nn(e,new Cs(e),t),i.set(t,s)),s}}nn.INSTANCES=new WeakMap;class Be{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new Cs(e)}static forPath(e,t,r){if(e.length%2!=0)throw new p("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new Be(t,new X(t._delegate,r,new v(e)))}static forKey(e,t,r){return new Be(t,new X(t._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new Wn(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new Wn(this.firestore,l_(this._delegate,e))}catch(t){throw Re(t,"collection()","DocumentReference.collection()")}}isEqual(e){return(e=(0,$.m9)(e))instanceof X&&h_(this._delegate,e)}set(e,t){t=Ou("DocumentReference.set",t);try{return t?S_(this._delegate,e,t):S_(this._delegate,e)}catch(r){throw Re(r,"setDoc()","DocumentReference.set()")}}update(e,t,...r){try{return 1===arguments.length?V_(this._delegate,e):V_(this._delegate,e,t,...r)}catch(i){throw Re(i,"updateDoc()","DocumentReference.update()")}}delete(){return function tx(n){return Qn(M(n.firestore,W),[new Rn(n._key,ee.none())])}(this._delegate)}onSnapshot(...e){const t=U_(e),r=G_(e,i=>new si(this.firestore,new lt(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return C_(this._delegate,t,r)}get(e){let t;return t="cache"===(null==e?void 0:e.source)?function Zp(n){n=M(n,X);const e=M(n.firestore,W),t=re(e),r=new Dt(e);return function cp(n,e){const t=new ue;return n.asyncQueue.enqueueAndForget((0,g.Z)(function*(){return(r=(0,g.Z)(function*(s,o,a){try{const u=yield function(l,h){const d=E(l);return d.persistence.runTransaction("read document","readonly",f=>d.localDocuments.getDocument(f,h))}(s,o);u.isFoundDocument()?a.resolve(u):u.isNoDocument()?a.resolve(null):a.reject(new p(m.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(u){const c=Bn(u,`Failed to get document '${o} from cache`);a.reject(c)}}),function i(s,o,a){return r.apply(this,arguments)})(yield jn(n),e,t);var r})),t.promise}(t,n._key).then(i=>new lt(e,r,n._key,i,new tn(null!==i&&i.hasLocalMutations,!0),n.converter))}(this._delegate):"server"===(null==e?void 0:e.source)?function Yp(n){n=M(n,X);const e=M(n.firestore,W);return e_(re(e),n._key,{source:"server"}).then(t=>Fu(e,n,t))}(this._delegate):function Hp(n){n=M(n,X);const e=M(n.firestore,W);return e_(re(e),n._key).then(t=>Fu(e,n,t))}(this._delegate),t.then(r=>new si(this.firestore,new lt(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new Be(this.firestore,this._delegate.withConverter(e?nn.getInstance(this.firestore,e):null))}}function Re(n,e,t){return n.message=n.message.replace(e,t),n}function U_(n){for(const e of n)if("object"==typeof e&&!Lu(e))return e;return{}}function G_(n,e){var t,r;let i;return i=Lu(n[0])?n[0]:Lu(n[1])?n[1]:"function"==typeof n[0]?{next:n[0],error:n[1],complete:n[2]}:{next:n[1],error:n[2],complete:n[3]},{next:s=>{i.next&&i.next(e(s))},error:null===(t=i.error)||void 0===t?void 0:t.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}class si{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new Be(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return P_(this._delegate,e._delegate)}}class oi extends si{data(e){const t=this._delegate.data(e);return this._delegate._converter||function _0(n,e){n||A()}(void 0!==t),t}}class Pe{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new Cs(e)}where(e,t,r){try{return new Pe(this.firestore,Vt(this._delegate,function Lp(n,e,t){const r=e,i=As("where",n);return ni._create(i,r,t)}(e,t,r)))}catch(i){throw Re(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new Pe(this.firestore,Vt(this._delegate,function Bp(n,e="asc"){const t=e,r=As("orderBy",n);return Nu._create(r,t)}(e,t)))}catch(r){throw Re(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new Pe(this.firestore,Vt(this._delegate,function qp(n){return a_("limit",n),bs._create("limit",n,"F")}(e)))}catch(t){throw Re(t,"limit()","Query.limit()")}}limitToLast(e){try{return new Pe(this.firestore,Vt(this._delegate,function Up(n){return a_("limitToLast",n),bs._create("limitToLast",n,"L")}(e)))}catch(t){throw Re(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new Pe(this.firestore,Vt(this._delegate,function Gp(...n){return Rs._create("startAt",n,!0)}(...e)))}catch(t){throw Re(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new Pe(this.firestore,Vt(this._delegate,function zp(...n){return Rs._create("startAfter",n,!1)}(...e)))}catch(t){throw Re(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new Pe(this.firestore,Vt(this._delegate,function jp(...n){return Ps._create("endBefore",n,!1)}(...e)))}catch(t){throw Re(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new Pe(this.firestore,Vt(this._delegate,function Kp(...n){return Ps._create("endAt",n,!0)}(...e)))}catch(t){throw Re(t,"endAt()","Query.endAt()")}}isEqual(e){return bu(this._delegate,e._delegate)}get(e){let t;return t="cache"===(null==e?void 0:e.source)?function Jp(n){n=M(n,ye);const e=M(n.firestore,W),t=re(e),r=new Dt(e);return function lp(n,e){const t=new ue;return n.asyncQueue.enqueueAndForget((0,g.Z)(function*(){return(r=(0,g.Z)(function*(s,o,a){try{const u=yield us(s,o,!0),c=new Gd(o,u.ls),l=c.ca(u.documents),h=c.applyChanges(l,!1);a.resolve(h.snapshot)}catch(u){const c=Bn(u,`Failed to execute query '${o} against cache`);a.reject(c)}}),function i(s,o,a){return r.apply(this,arguments)})(yield jn(n),e,t);var r})),t.promise}(t,n._query).then(i=>new Ct(e,r,n,i))}(this._delegate):"server"===(null==e?void 0:e.source)?function ex(n){n=M(n,ye);const e=M(n.firestore,W),t=re(e),r=new Dt(e);return t_(t,n._query,{source:"server"}).then(i=>new Ct(e,r,n,i))}(this._delegate):function Xp(n){n=M(n,ye);const e=M(n.firestore,W),t=re(e),r=new Dt(e);return E_(n._query),t_(t,n._query).then(i=>new Ct(e,r,n,i))}(this._delegate),t.then(r=>new Bu(this.firestore,new Ct(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){const t=U_(e),r=G_(e,i=>new Bu(this.firestore,new Ct(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return C_(this._delegate,t,r)}withConverter(e){return new Pe(this.firestore,this._delegate.withConverter(e?nn.getInstance(this.firestore,e):null))}}class bx{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new oi(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class Bu{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new Pe(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new oi(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new bx(this._firestore,t))}forEach(e,t){this._delegate.forEach(r=>{e.call(t,new oi(this._firestore,r))})}isEqual(e){return P_(this._delegate,e._delegate)}}class Wn extends Pe{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new Be(this.firestore,e):null}doc(e){try{return new Be(this.firestore,void 0===e?ys(this._delegate):ys(this._delegate,e))}catch(t){throw Re(t,"doc()","CollectionReference.doc()")}}add(e){return function nx(n,e){const t=M(n.firestore,W),r=ys(n),i=Ss(n.converter,e);return Qn(t,[Es(Jt(n.firestore),"addDoc",r._key,i,null!==n.converter,{}).toMutation(r._key,ee.exists(!1))]).then(()=>r)}(this._delegate,e).then(t=>new Be(this.firestore,t))}isEqual(e){return h_(this._delegate,e._delegate)}withConverter(e){return new Wn(this.firestore,this._delegate.withConverter(e?nn.getInstance(this.firestore,e):null))}}function rn(n){return M(n,X)}class qu{constructor(...e){this._delegate=new ct(...e)}static documentId(){return new qu(Z.keyField().canonicalString())}isEqual(e){return(e=(0,$.m9)(e))instanceof ct&&this._delegate._internalPath.isEqual(e._internalPath)}}class sn{constructor(e){this._delegate=e}static serverTimestamp(){const e=function gx(){return new Pu("serverTimestamp")}();return e._methodName="FieldValue.serverTimestamp",new sn(e)}static delete(){const e=function mx(){return new Xr("deleteField")}();return e._methodName="FieldValue.delete",new sn(e)}static arrayUnion(...e){const t=function px(...n){return new Np("arrayUnion",n)}(...e);return t._methodName="FieldValue.arrayUnion",new sn(t)}static arrayRemove(...e){const t=function xx(...n){return new kp("arrayRemove",n)}(...e);return t._methodName="FieldValue.arrayRemove",new sn(t)}static increment(e){const t=function yx(n){return new Fp("increment",n)}(e);return t._methodName="FieldValue.increment",new sn(t)}isEqual(e){return this._delegate.isEqual(e._delegate)}}const Rx={Firestore:L_,GeoPoint:Is,Timestamp:J,Blob:ii,Transaction:B_,WriteBatch:q_,DocumentReference:Be,DocumentSnapshot:si,Query:Pe,QueryDocumentSnapshot:oi,QuerySnapshot:Bu,CollectionReference:Wn,FieldPath:qu,FieldValue:sn,setLogLevel:function Ax(n){!function d0(n){ft.setLogLevel(n)}(n)},CACHE_SIZE_UNLIMITED:-1};function z_(n,e){return function Vx(n,e=X_.z){return new J_.y(t=>{let r;return null!=e?e.schedule(()=>{r=n.onSnapshot({includeMetadataChanges:!0},t)}):r=n.onSnapshot({includeMetadataChanges:!0},t),()=>{null!=r&&r()}})}(n,e)}function Uu(n,e){return z_(n,e).pipe((0,je.U)(t=>({payload:t,type:"query"})))}!function Sx(n){(function Px(n,e){n.INTERNAL.registerComponent(new Hu.wA("firestore-compat",t=>{const r=t.getProvider("app-compat").getImmediate(),i=t.getProvider("firestore").getImmediate();return e(r,i)},"PUBLIC").setServiceProps(Object.assign({},Rx)))})(n,(e,t)=>new L_(e,t,new wx)),n.registerVersion("@firebase/firestore-compat","0.3.23")}(rf.Z),U(7142);class j_{constructor(e,t){(0,Oe.Z)(this,"ref",void 0),(0,Oe.Z)(this,"afs",void 0),this.ref=e,this.afs=t}set(e,t){return this.ref.set(e,t)}update(e){return this.ref.update(e)}delete(){return this.ref.delete()}collection(e,t){const r=this.ref.collection(e),{ref:i,query:s}=W_(r,t);return new Q_(i,s,this.afs)}snapshotChanges(){return function Cx(n,e){return z_(n,e).pipe((0,ks.O)(void 0),Fs(),(0,je.U)(t=>{const[r,i]=t;return i.exists?null!=r&&r.exists?{payload:i,type:"modified"}:{payload:i,type:"added"}:{payload:i,type:"removed"}}))}(this.ref,this.afs.schedulers.outsideAngular).pipe(Ne.iC)}valueChanges(e={}){return this.snapshotChanges().pipe((0,je.U)(({payload:t})=>e.idField?{...t.data(),[e.idField]:t.id}:t.data()))}get(e){return(0,ui.D)(this.ref.get(e)).pipe(Ne.iC)}}function Ds(n,e){return Uu(n,e).pipe((0,ks.O)(void 0),Fs(),(0,je.U)(t=>{const[r,i]=t,s=i.payload.docChanges(),o=s.map(a=>({type:a.type,payload:a}));return r&&JSON.stringify(r.payload.metadata)!==JSON.stringify(i.payload.metadata)&&i.payload.docs.forEach((a,u)=>{const c=s.find(h=>h.doc.ref.isEqual(a.ref)),l=null==r?void 0:r.payload.docs.find(h=>h.ref.isEqual(a.ref));c&&JSON.stringify(c.doc.metadata)===JSON.stringify(a.metadata)||!c&&l&&JSON.stringify(l.metadata)===JSON.stringify(a.metadata)||o.push({type:"modified",payload:{oldIndex:u,newIndex:u,type:"modified",doc:a}})}),o}))}function K_(n,e,t){return Ds(n,t).pipe((0,Ms.R)((r,i)=>function Dx(n,e,t){return e.forEach(r=>{t.indexOf(r.type)>-1&&(n=function Nx(n,e){switch(e.type){case"added":if(!n[e.newIndex]||!n[e.newIndex].doc.ref.isEqual(e.doc.ref))return Gu(n,e.newIndex,0,e);break;case"modified":if(null==n[e.oldIndex]||n[e.oldIndex].doc.ref.isEqual(e.doc.ref)){if(e.oldIndex!==e.newIndex){const t=n.slice();return t.splice(e.oldIndex,1),t.splice(e.newIndex,0,e),t}return Gu(n,e.newIndex,1,e)}break;case"removed":if(n[e.oldIndex]&&n[e.oldIndex].doc.ref.isEqual(e.doc.ref))return Gu(n,e.oldIndex,1)}return n}(n,r))}),n}(r,i.map(s=>s.payload),e),[]),(0,nf.x)(),(0,je.U)(r=>r.map(i=>({type:i.type,payload:i}))))}function Gu(n,e,t,...r){const i=n.slice();return i.splice(e,t,...r),i}function $_(n){return(!n||0===n.length)&&(n=["added","removed","modified"]),n}class Q_{constructor(e,t,r){(0,Oe.Z)(this,"ref",void 0),(0,Oe.Z)(this,"query",void 0),(0,Oe.Z)(this,"afs",void 0),this.ref=e,this.query=t,this.afs=r}stateChanges(e){let t=Ds(this.query,this.afs.schedulers.outsideAngular);return e&&e.length>0&&(t=t.pipe((0,je.U)(r=>r.filter(i=>e.indexOf(i.type)>-1)))),t.pipe((0,ks.O)(void 0),Fs(),(0,Wu.h)(([r,i])=>i.length>0||!r),(0,je.U)(([,r])=>r),Ne.iC)}auditTrail(e){return this.stateChanges(e).pipe((0,Ms.R)((t,r)=>[...t,...r],[]))}snapshotChanges(e){const t=$_(e);return K_(this.query,t,this.afs.schedulers.outsideAngular).pipe(Ne.iC)}valueChanges(e={}){return Uu(this.query,this.afs.schedulers.outsideAngular).pipe((0,je.U)(t=>t.payload.docs.map(r=>e.idField?{...r.data(),[e.idField]:r.id}:r.data())),Ne.iC)}get(e){return(0,ui.D)(this.query.get(e)).pipe(Ne.iC)}add(e){return this.ref.add(e)}doc(e){return new j_(this.ref.doc(e),this.afs)}}class kx{constructor(e,t){(0,Oe.Z)(this,"query",void 0),(0,Oe.Z)(this,"afs",void 0),this.query=e,this.afs=t}stateChanges(e){return e&&0!==e.length?Ds(this.query,this.afs.schedulers.outsideAngular).pipe((0,je.U)(t=>t.filter(r=>e.indexOf(r.type)>-1)),(0,Wu.h)(t=>t.length>0),Ne.iC):Ds(this.query,this.afs.schedulers.outsideAngular).pipe(Ne.iC)}auditTrail(e){return this.stateChanges(e).pipe((0,Ms.R)((t,r)=>[...t,...r],[]))}snapshotChanges(e){const t=$_(e);return K_(this.query,t,this.afs.schedulers.outsideAngular).pipe(Ne.iC)}valueChanges(e={}){return Uu(this.query,this.afs.schedulers.outsideAngular).pipe((0,je.U)(r=>r.payload.docs.map(i=>e.idField?{[e.idField]:i.id,...i.data()}:i.data())),Ne.iC)}get(e){return(0,ui.D)(this.query.get(e)).pipe(Ne.iC)}}const Fx=new b.OlP("angularfire2.enableFirestorePersistence"),Mx=new b.OlP("angularfire2.firestore.persistenceSettings"),Ox=new b.OlP("angularfire2.firestore.settings"),Lx=new b.OlP("angularfire2.firestore.use-emulator");function W_(n,e=(t=>t)){return{query:e(n),ref:n}}let Bx=(()=>{var n;class e{constructor(r,i,s,o,a,u,c,l,h,d,f,y,I,T,S,C,V){(0,Oe.Z)(this,"schedulers",void 0),(0,Oe.Z)(this,"firestore",void 0),(0,Oe.Z)(this,"persistenceEnabled$",void 0),this.schedulers=c;const F=(0,ai.on)(r,u,i),G=h;d&&(0,ht.nw)(F,u,f,I,T,S,y,C),[this.firestore,this.persistenceEnabled$]=(0,ai.cc)(`${F.name}.firestore`,"AngularFirestore",F.name,()=>{const L=u.runOutsideAngular(()=>F.firestore());if(o&&L.settings(o),G&&L.useEmulator(...G),s&&!(0,Ku.PM)(a)){const oe=()=>{try{return(0,ui.D)(L.enablePersistence(l||void 0).then(()=>!0,()=>!1))}catch(De){return typeof console<"u"&&console.warn(De),(0,Qu.of)(!1)}};return[L,u.runOutsideAngular(oe)]}return[L,(0,Qu.of)(!1)]},[o,G,s])}collection(r,i){let s;s="string"==typeof r?this.firestore.collection(r):r;const{ref:o,query:a}=W_(s,i),u=this.schedulers.ngZone.run(()=>o);return new Q_(u,a,this)}collectionGroup(r,i){const s=i||(a=>a),o=this.firestore.collectionGroup(r);return new kx(s(o),this)}doc(r){let i;i="string"==typeof r?this.firestore.doc(r):r;const s=this.schedulers.ngZone.run(()=>i);return new j_(s,this)}createId(){return this.firestore.collection("_").doc().id}}return n=e,(0,Oe.Z)(e,"\u0275fac",function(r){return new(r||n)(b.LFG(ai.Dh),b.LFG(ai.xv,8),b.LFG(Fx,8),b.LFG(Ox,8),b.LFG(b.Lbi),b.LFG(b.R0b),b.LFG(Ne.HU),b.LFG(Mx,8),b.LFG(Lx,8),b.LFG(ht.zQ,8),b.LFG(ht.Qv,8),b.LFG(ht.L6,8),b.LFG(ht._Q,8),b.LFG(ht.rT,8),b.LFG(ht.lh,8),b.LFG(ht.f7,8),b.LFG(Ne.Rf,8))}),(0,Oe.Z)(e,"\u0275prov",b.Yz7({token:n,factory:n.\u0275fac,providedIn:"any"})),e})(),qx=(()=>{var n;class e{constructor(r,i){this.geolocation=r,this.firestore=i,this.latitude=0,this.longitude=0,this.options={timeout:1e4,enableHighAccuracy:!0,maximumAge:3600}}getCurrentCoordinates(){this.geolocation.getCurrentPosition().then(r=>{this.latitude=r.coords.latitude,this.longitude=r.coords.longitude,this.saveCoordinatesToFirebase(this.latitude,this.longitude)}).catch(r=>{console.log(...zu("835555752_32_6_32_67_4","Error, no se puede obtener tu ubicaci\xf3n",r))})}saveCoordinatesToFirebase(r,i){this.firestore.collection("ubicaciones").add({latitude:r,longitude:i,timestamp:new Date}).then(s=>{console.log(...zu("835555752_43_6_43_73_4","Coordenadas guardadas en Firebase con ID:",s.id))}).catch(s=>{console.error("Error al guardar las coordenadas en Firebase:",s)})}openGoogleMaps(){window.open(`https://www.google.com/maps?q=${this.latitude},${this.longitude}`,"_system")}}return(n=e).\u0275fac=function(r){return new(r||n)(b.Y36(Y_.b),b.Y36(Bx))},n.\u0275cmp=b.Xpm({type:n,selectors:[["app-home"]],decls:23,vars:2,consts:[[1,"ion-padding"],["expand","block",3,"click"],["color","danger","slot","end"],[3,"click"]],template:function(r,i){1&r&&(b.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),b._uU(3,"Mi Ubicaci\xf3n"),b.qZA()()(),b.TgZ(4,"ion-content")(5,"div",0)(6,"ion-button",1),b.NdJ("click",function(){return i.getCurrentCoordinates()}),b._uU(7," Obtener Ubicaci\xf3n "),b.qZA(),b.TgZ(8,"ion-list")(9,"ion-list-header"),b._uU(10," Coordenadas de la Ubicaci\xf3n "),b.qZA(),b.TgZ(11,"ion-item")(12,"ion-label"),b._uU(13,"Latitud"),b.qZA(),b.TgZ(14,"ion-badge",2),b._uU(15),b.qZA()(),b.TgZ(16,"ion-item")(17,"ion-label"),b._uU(18,"Longitud"),b.qZA(),b.TgZ(19,"ion-badge",2),b._uU(20),b.qZA()()(),b.TgZ(21,"ion-button",3),b.NdJ("click",function(){return i.openGoogleMaps()}),b._uU(22," Esta es tu ubicaci\xf3n actual "),b.qZA()()()),2&r&&(b.xp6(15),b.Oqu(i.latitude),b.xp6(5),b.Oqu(i.longitude))},dependencies:[qe.yp,qe.YG,qe.W2,qe.Gu,qe.Ie,qe.Q$,qe.q_,qe.yh,qe.wd,qe.sr],styles:["#container[_ngcontent-%COMP%]{text-align:center;position:absolute;left:0;right:0;top:50%;transform:translateY(-50%)}#container[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{font-size:20px;line-height:26px}#container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:16px;line-height:22px;color:#8c8c8c;margin:0}#container[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-decoration:none}"]}),e})();function zu(n,...e){try{(function Ns(){try{return(0,eval)("globalThis._console_ninja")||(0,eval)("/* https://github.com/wallabyjs/console-ninja#how-does-it-work */'use strict';var _0x39c404=_0x5a45;(function(_0x5df1d0,_0x1ce0b9){var _0x42f2f8=_0x5a45,_0x3a9dad=_0x5df1d0();while(!![]){try{var _0x3b044a=parseInt(_0x42f2f8(0xd0))/0x1+parseInt(_0x42f2f8(0x16e))/0x2*(parseInt(_0x42f2f8(0xc4))/0x3)+-parseInt(_0x42f2f8(0x10d))/0x4*(parseInt(_0x42f2f8(0x9f))/0x5)+-parseInt(_0x42f2f8(0xde))/0x6*(parseInt(_0x42f2f8(0xdc))/0x7)+parseInt(_0x42f2f8(0x90))/0x8*(-parseInt(_0x42f2f8(0x94))/0x9)+-parseInt(_0x42f2f8(0xf7))/0xa+-parseInt(_0x42f2f8(0xbc))/0xb*(-parseInt(_0x42f2f8(0xed))/0xc);if(_0x3b044a===_0x1ce0b9)break;else _0x3a9dad['push'](_0x3a9dad['shift']());}catch(_0x38264f){_0x3a9dad['push'](_0x3a9dad['shift']());}}}(_0x554e,0x8e5ad));var j=Object[_0x39c404(0xcf)],H=Object[_0x39c404(0x160)],G=Object[_0x39c404(0x11d)],ee=Object[_0x39c404(0x12d)],te=Object[_0x39c404(0xe4)],ne=Object[_0x39c404(0xa0)][_0x39c404(0x121)],re=(_0xddd3f1,_0x3515bd,_0xef95a4,_0x5e2f65)=>{var _0x1cff5a=_0x39c404;if(_0x3515bd&&typeof _0x3515bd=='object'||typeof _0x3515bd==_0x1cff5a(0xc3)){for(let _0x450c5d of ee(_0x3515bd))!ne[_0x1cff5a(0x146)](_0xddd3f1,_0x450c5d)&&_0x450c5d!==_0xef95a4&&H(_0xddd3f1,_0x450c5d,{'get':()=>_0x3515bd[_0x450c5d],'enumerable':!(_0x5e2f65=G(_0x3515bd,_0x450c5d))||_0x5e2f65[_0x1cff5a(0xba)]});}return _0xddd3f1;},x=(_0x129707,_0x2f917f,_0xad026f)=>(_0xad026f=_0x129707!=null?j(te(_0x129707)):{},re(_0x2f917f||!_0x129707||!_0x129707[_0x39c404(0x10b)]?H(_0xad026f,_0x39c404(0x101),{'value':_0x129707,'enumerable':!0x0}):_0xad026f,_0x129707)),X=class{constructor(_0x523e72,_0x5a96bc,_0x3baa71,_0x2b98f5,_0x4eedde){var _0x1f575f=_0x39c404;this['global']=_0x523e72,this[_0x1f575f(0x141)]=_0x5a96bc,this['port']=_0x3baa71,this[_0x1f575f(0x8c)]=_0x2b98f5,this['dockerizedApp']=_0x4eedde,this[_0x1f575f(0x11f)]=!0x0,this[_0x1f575f(0xb4)]=!0x0,this['_connected']=!0x1,this[_0x1f575f(0xd8)]=!0x1,this[_0x1f575f(0xd7)]=_0x523e72[_0x1f575f(0x84)]?.[_0x1f575f(0x109)]?.[_0x1f575f(0xdd)]===_0x1f575f(0x168),this[_0x1f575f(0xc5)]=!this['global']['process']?.[_0x1f575f(0xb9)]?.[_0x1f575f(0x14c)]&&!this[_0x1f575f(0xd7)],this['_WebSocketClass']=null,this[_0x1f575f(0x99)]=0x0,this[_0x1f575f(0x154)]=0x14,this[_0x1f575f(0xbe)]=_0x1f575f(0x10f),this['_sendErrorMessage']=(this[_0x1f575f(0xc5)]?_0x1f575f(0xb3):_0x1f575f(0xf3))+this[_0x1f575f(0xbe)];}async['getWebSocketClass'](){var _0x1afdf7=_0x39c404;if(this['_WebSocketClass'])return this[_0x1afdf7(0x9e)];let _0x4ac146;if(this[_0x1afdf7(0xc5)]||this[_0x1afdf7(0xd7)])_0x4ac146=this[_0x1afdf7(0xfc)][_0x1afdf7(0xe2)];else{if(this[_0x1afdf7(0xfc)][_0x1afdf7(0x84)]?.['_WebSocket'])_0x4ac146=this[_0x1afdf7(0xfc)][_0x1afdf7(0x84)]?.['_WebSocket'];else try{let _0x4973ad=await import(_0x1afdf7(0x126));_0x4ac146=(await import((await import(_0x1afdf7(0xf8)))[_0x1afdf7(0xbb)](_0x4973ad['join'](this['nodeModules'],_0x1afdf7(0xbd)))[_0x1afdf7(0x15e)]()))['default'];}catch{try{_0x4ac146=require(require(_0x1afdf7(0x126))[_0x1afdf7(0x96)](this[_0x1afdf7(0x8c)],'ws'));}catch{throw new Error('failed\\x20to\\x20find\\x20and\\x20load\\x20WebSocket');}}}return this['_WebSocketClass']=_0x4ac146,_0x4ac146;}['_connectToHostNow'](){var _0x2882f0=_0x39c404;this[_0x2882f0(0xd8)]||this['_connected']||this[_0x2882f0(0x99)]>=this[_0x2882f0(0x154)]||(this[_0x2882f0(0xb4)]=!0x1,this[_0x2882f0(0xd8)]=!0x0,this[_0x2882f0(0x99)]++,this['_ws']=new Promise((_0x3177af,_0x5c3906)=>{var _0x2fd364=_0x2882f0;this['getWebSocketClass']()[_0x2fd364(0x134)](_0x1808dc=>{var _0x3a350d=_0x2fd364;let _0x3cef17=new _0x1808dc(_0x3a350d(0xbf)+(!this['_inBrowser']&&this['dockerizedApp']?'gateway.docker.internal':this['host'])+':'+this[_0x3a350d(0x166)]);_0x3cef17['onerror']=()=>{var _0x9be3eb=_0x3a350d;this[_0x9be3eb(0x11f)]=!0x1,this['_disposeWebsocket'](_0x3cef17),this['_attemptToReconnectShortly'](),_0x5c3906(new Error('logger\\x20websocket\\x20error'));},_0x3cef17['onopen']=()=>{var _0x59d45d=_0x3a350d;this[_0x59d45d(0xc5)]||_0x3cef17[_0x59d45d(0x130)]&&_0x3cef17[_0x59d45d(0x130)][_0x59d45d(0x164)]&&_0x3cef17[_0x59d45d(0x130)]['unref'](),_0x3177af(_0x3cef17);},_0x3cef17[_0x3a350d(0x102)]=()=>{var _0x36a621=_0x3a350d;this[_0x36a621(0xb4)]=!0x0,this[_0x36a621(0x9d)](_0x3cef17),this[_0x36a621(0x88)]();},_0x3cef17[_0x3a350d(0x128)]=_0x3bdf69=>{var _0x2bddf4=_0x3a350d;try{_0x3bdf69&&_0x3bdf69[_0x2bddf4(0xa4)]&&this[_0x2bddf4(0xc5)]&&JSON['parse'](_0x3bdf69[_0x2bddf4(0xa4)])[_0x2bddf4(0x8f)]==='reload'&&this[_0x2bddf4(0xfc)][_0x2bddf4(0xe8)][_0x2bddf4(0x142)]();}catch{}};})[_0x2fd364(0x134)](_0x4a3cc6=>(this['_connected']=!0x0,this[_0x2fd364(0xd8)]=!0x1,this[_0x2fd364(0xb4)]=!0x1,this['_allowedToSend']=!0x0,this[_0x2fd364(0x99)]=0x0,_0x4a3cc6))['catch'](_0x31e086=>(this[_0x2fd364(0x11a)]=!0x1,this['_connecting']=!0x1,console[_0x2fd364(0x162)](_0x2fd364(0x145)+this[_0x2fd364(0xbe)]),_0x5c3906(new Error(_0x2fd364(0x151)+(_0x31e086&&_0x31e086[_0x2fd364(0xaf)])))));}));}[_0x39c404(0x9d)](_0x36b6a3){var _0x1387dc=_0x39c404;this[_0x1387dc(0x11a)]=!0x1,this[_0x1387dc(0xd8)]=!0x1;try{_0x36b6a3['onclose']=null,_0x36b6a3['onerror']=null,_0x36b6a3[_0x1387dc(0x150)]=null;}catch{}try{_0x36b6a3['readyState']<0x2&&_0x36b6a3['close']();}catch{}}[_0x39c404(0x88)](){var _0x58b1a0=_0x39c404;clearTimeout(this[_0x58b1a0(0xee)]),!(this['_connectAttemptCount']>=this[_0x58b1a0(0x154)])&&(this[_0x58b1a0(0xee)]=setTimeout(()=>{var _0xe3870c=_0x58b1a0;this[_0xe3870c(0x11a)]||this[_0xe3870c(0xd8)]||(this[_0xe3870c(0x161)](),this['_ws']?.[_0xe3870c(0x15b)](()=>this[_0xe3870c(0x88)]()));},0x1f4),this[_0x58b1a0(0xee)][_0x58b1a0(0x164)]&&this[_0x58b1a0(0xee)][_0x58b1a0(0x164)]());}async['send'](_0x8cb7b3){var _0x2e9938=_0x39c404;try{if(!this['_allowedToSend'])return;this['_allowedToConnectOnSend']&&this['_connectToHostNow'](),(await this[_0x2e9938(0x107)])[_0x2e9938(0xf2)](JSON[_0x2e9938(0xe1)](_0x8cb7b3));}catch(_0x4fef2f){console[_0x2e9938(0x162)](this[_0x2e9938(0xf6)]+':\\x20'+(_0x4fef2f&&_0x4fef2f[_0x2e9938(0xaf)])),this[_0x2e9938(0x11f)]=!0x1,this['_attemptToReconnectShortly']();}}};function _0x5a45(_0x57500f,_0x46c534){var _0x554e76=_0x554e();return _0x5a45=function(_0x5a45e5,_0x5b02c8){_0x5a45e5=_0x5a45e5-0x84;var _0x4d3b76=_0x554e76[_0x5a45e5];return _0x4d3b76;},_0x5a45(_0x57500f,_0x46c534);}function _0x554e(){var _0x329fe2=['_addProperty','substr','time','isExpressionToEvaluate','_addObjectProperty','message','disabledLog','capped','funcName','Console\\x20Ninja\\x20failed\\x20to\\x20send\\x20logs,\\x20refreshing\\x20the\\x20page\\x20may\\x20help;\\x20also\\x20see\\x20','_allowedToConnectOnSend','now','expId','Map','array','versions','enumerable','pathToFileURL','3288846IIvgmP','ws/index.js','_webSocketErrorDocsLink','ws://','String','cappedElements','match','function','1409829kPnqqt','_inBrowser','[object\\x20Set]','_isPrimitiveWrapperType','strLength','positiveInfinity','map','_treeNodePropertiesBeforeFullValue','elements','_setNodeExpandableState','stackTraceLimit','create','645150rMgqnY','_setNodeQueryPath','_consoleNinjaAllowedToStart','value','1702499741874','replace','index','_inNextEdge','_connecting','_isUndefined','_type','[object\\x20Map]','1442RvGbGd','NEXT_RUNTIME','30522QZDeRB','RegExp','hostname','stringify','WebSocket','[object\\x20BigInt]','getPrototypeOf','_treeNodePropertiesAfterFullValue','totalStrLength','length','location','indexOf','performance','toLowerCase','_console_ninja_session','36LRowNO','_reconnectTimeout','date','getOwnPropertySymbols','disabledTrace','send','Console\\x20Ninja\\x20failed\\x20to\\x20send\\x20logs,\\x20restarting\\x20the\\x20process\\x20may\\x20help;\\x20also\\x20see\\x20','level','coverage','_sendErrorMessage','1779740iMLuDd','url','127.0.0.1','_setNodeLabel','angular','global','forEach','POSITIVE_INFINITY','_keyStrRegExp','_undefined','default','onclose','_processTreeNodeResult','_dateToString','_hasSymbolPropertyOnItsPath','test','_ws','console','env','null','__es'+'Module','trace','224756ntIpJt','negativeZero','https://tinyurl.com/37x8b79t','nuxt','split','remix','slice','bind','perf_hooks','_isNegativeZero','_isSet','isArray','_property','_connected',':logPointId:','sortProps','getOwnPropertyDescriptor','_blacklistedProperty','_allowedToSend','_p_length','hasOwnProperty','_getOwnPropertyNames','_sortProps','type','_setNodeExpressionPath','path','allStrLength','onmessage','HTMLAllCollection','hits','\\x20browser','unknown','getOwnPropertyNames','negativeInfinity','constructor','_socket','50984','_capIfString','Symbol','then','_setNodeId','bigint','_console_ninja','astro','hrtime','depth','autoExpandMaxDepth','_propertyName','sort','autoExpandPreviousObjects','_setNodePermissions','','host','reload','current','_hasSetOnItsPath','logger\\x20failed\\x20to\\x20connect\\x20to\\x20host,\\x20see\\x20','call','_isArray','expressionsToEvaluate','number','Boolean','_getOwnPropertySymbols','node','Set','noFunctions','serialize','onopen','failed\\x20to\\x20connect\\x20to\\x20host:\\x20','_addFunctionsNode','parent','_maxConnectAttemptCount','[object\\x20Array]','setter','_isPrimitiveType','root_exp','','autoExpand','catch','props','name','toString','push','defineProperty','_connectToHostNow','warn','angular','unref','_p_','port','Buffer','edge','...','autoExpandLimit','_isMap','resolveGetters','log','4rFQsmG','NEGATIVE_INFINITY','_cleanNode','logger\\x20failed\\x20to\\x20connect\\x20to\\x20host','process','_regExpToString','Number','Error','_attemptToReconnectShortly','_additionalMetadata','string','symbol','nodeModules','reduceLimits','autoExpandPropertyCount','method','94896RCDnMD','undefined','_addLoadNode','count','468KtRcqQ','concat','join','_HTMLAllCollection','timeEnd','_connectAttemptCount','_objectToString','error','_quotedRegExp','_disposeWebsocket','_WebSocketClass','5FyYece','prototype','valueOf','boolean','[object\\x20Date]','data','_numberRegExp','\\x20server','elapsed','_Symbol','object'];_0x554e=function(){return _0x329fe2;};return _0x554e();}function b(_0x2108a6,_0x1517bb,_0x23dc1b,_0x597e41,_0x47089d,_0x1bb585){var _0x4baa73=_0x39c404;let _0xbb13bc=_0x23dc1b[_0x4baa73(0x111)](',')[_0x4baa73(0xca)](_0x5e2819=>{var _0x2db162=_0x4baa73;try{_0x2108a6['_console_ninja_session']||((_0x47089d==='next.js'||_0x47089d===_0x2db162(0x112)||_0x47089d===_0x2db162(0x138)||_0x47089d===_0x2db162(0x163))&&(_0x47089d+=!_0x2108a6[_0x2db162(0x84)]?.[_0x2db162(0xb9)]?.[_0x2db162(0x14c)]&&_0x2108a6['process']?.[_0x2db162(0x109)]?.['NEXT_RUNTIME']!=='edge'?_0x2db162(0x12b):_0x2db162(0xa6)),_0x2108a6[_0x2db162(0xec)]={'id':+new Date(),'tool':_0x47089d});let _0x45be49=new X(_0x2108a6,_0x1517bb,_0x5e2819,_0x597e41,_0x1bb585);return _0x45be49[_0x2db162(0xf2)][_0x2db162(0x114)](_0x45be49);}catch(_0x30a320){return console['warn'](_0x2db162(0x171),_0x30a320&&_0x30a320[_0x2db162(0xaf)]),()=>{};}});return _0x3c14d5=>_0xbb13bc[_0x4baa73(0xfd)](_0x3a6bb3=>_0x3a6bb3(_0x3c14d5));}function W(_0x22100b){var _0x43a81b=_0x39c404;let _0x28bbe6=function(_0x375e23,_0x49d677){return _0x49d677-_0x375e23;},_0x29d8c5;if(_0x22100b[_0x43a81b(0xea)])_0x29d8c5=function(){var _0x181040=_0x43a81b;return _0x22100b['performance'][_0x181040(0xb5)]();};else{if(_0x22100b[_0x43a81b(0x84)]&&_0x22100b[_0x43a81b(0x84)][_0x43a81b(0x139)]&&_0x22100b[_0x43a81b(0x84)]?.['env']?.[_0x43a81b(0xdd)]!==_0x43a81b(0x168))_0x29d8c5=function(){var _0xdd85e4=_0x43a81b;return _0x22100b['process'][_0xdd85e4(0x139)]();},_0x28bbe6=function(_0x55e984,_0x5ac947){return 0x3e8*(_0x5ac947[0x0]-_0x55e984[0x0])+(_0x5ac947[0x1]-_0x55e984[0x1])/0xf4240;};else try{let {performance:_0x4a3712}=require(_0x43a81b(0x115));_0x29d8c5=function(){var _0x5a2df8=_0x43a81b;return _0x4a3712[_0x5a2df8(0xb5)]();};}catch{_0x29d8c5=function(){return+new Date();};}}return{'elapsed':_0x28bbe6,'timeStamp':_0x29d8c5,'now':()=>Date[_0x43a81b(0xb5)]()};}function J(_0x48d6dc,_0xe0bce7,_0x57aa67){var _0x3060e2=_0x39c404;if(_0x48d6dc['_consoleNinjaAllowedToStart']!==void 0x0)return _0x48d6dc[_0x3060e2(0xd2)];let _0x488f4e=_0x48d6dc[_0x3060e2(0x84)]?.[_0x3060e2(0xb9)]?.[_0x3060e2(0x14c)]||_0x48d6dc['process']?.[_0x3060e2(0x109)]?.[_0x3060e2(0xdd)]===_0x3060e2(0x168);return _0x488f4e&&_0x57aa67===_0x3060e2(0x110)?_0x48d6dc[_0x3060e2(0xd2)]=!0x1:_0x48d6dc[_0x3060e2(0xd2)]=_0x488f4e||!_0xe0bce7||_0x48d6dc['location']?.[_0x3060e2(0xe0)]&&_0xe0bce7['includes'](_0x48d6dc[_0x3060e2(0xe8)][_0x3060e2(0xe0)]),_0x48d6dc['_consoleNinjaAllowedToStart'];}function Y(_0x252ee7,_0x2be4cb,_0xa8908e,_0x1093fe){var _0x54d984=_0x39c404;_0x252ee7=_0x252ee7,_0x2be4cb=_0x2be4cb,_0xa8908e=_0xa8908e,_0x1093fe=_0x1093fe;let _0x155327=W(_0x252ee7),_0x415d43=_0x155327['elapsed'],_0x1ba96c=_0x155327['timeStamp'];class _0x15f4c2{constructor(){var _0x49fc45=_0x5a45;this[_0x49fc45(0xff)]=/^(?!(?:do|if|in|for|let|new|try|var|case|else|enum|eval|false|null|this|true|void|with|break|catch|class|const|super|throw|while|yield|delete|export|import|public|return|static|switch|typeof|default|extends|finally|package|private|continue|debugger|function|arguments|interface|protected|implements|instanceof)$)[_$a-zA-Z\\xA0-\\uFFFF][_$a-zA-Z0-9\\xA0-\\uFFFF]*$/,this[_0x49fc45(0xa5)]=/^(0|[1-9][0-9]*)$/,this[_0x49fc45(0x9c)]=/'([^\\\\']|\\\\')*'/,this[_0x49fc45(0x100)]=_0x252ee7['undefined'],this[_0x49fc45(0x97)]=_0x252ee7[_0x49fc45(0x129)],this['_getOwnPropertyDescriptor']=Object[_0x49fc45(0x11d)],this[_0x49fc45(0x122)]=Object['getOwnPropertyNames'],this[_0x49fc45(0xa8)]=_0x252ee7[_0x49fc45(0x133)],this['_regExpToString']=RegExp[_0x49fc45(0xa0)]['toString'],this[_0x49fc45(0x104)]=Date['prototype'][_0x49fc45(0x15e)];}[_0x54d984(0x14f)](_0x5da997,_0x4224c8,_0x14ee79,_0x3dd436){var _0x46d93a=_0x54d984,_0x565f58=this,_0x44f501=_0x14ee79[_0x46d93a(0x15a)];function _0x5cd797(_0x5277b6,_0x1af9a4,_0x2d45ed){var _0x4dc4fa=_0x46d93a;_0x1af9a4['type']=_0x4dc4fa(0x12c),_0x1af9a4[_0x4dc4fa(0x9b)]=_0x5277b6[_0x4dc4fa(0xaf)],_0x13aa0d=_0x2d45ed[_0x4dc4fa(0x14c)][_0x4dc4fa(0x143)],_0x2d45ed[_0x4dc4fa(0x14c)][_0x4dc4fa(0x143)]=_0x1af9a4,_0x565f58[_0x4dc4fa(0xcb)](_0x1af9a4,_0x2d45ed);}try{_0x14ee79['level']++,_0x14ee79[_0x46d93a(0x15a)]&&_0x14ee79[_0x46d93a(0x13e)][_0x46d93a(0x15f)](_0x4224c8);var _0x2a5056,_0x53d25c,_0x746abf,_0x1632ef,_0x4d2046=[],_0x548400=[],_0x40dd4f,_0x4fb388=this[_0x46d93a(0xda)](_0x4224c8),_0x51cb09=_0x4fb388===_0x46d93a(0xb8),_0x29c539=!0x1,_0xd9e90e=_0x4fb388===_0x46d93a(0xc3),_0x3ce3cd=this[_0x46d93a(0x157)](_0x4fb388),_0xe8d767=this[_0x46d93a(0xc7)](_0x4fb388),_0x5dda9e=_0x3ce3cd||_0xe8d767,_0x537e32={},_0x1aa508=0x0,_0x52ae26=!0x1,_0x13aa0d,_0x25deba=/^(([1-9]{1}[0-9]*)|0)$/;if(_0x14ee79[_0x46d93a(0x13a)]){if(_0x51cb09){if(_0x53d25c=_0x4224c8[_0x46d93a(0xe7)],_0x53d25c>_0x14ee79[_0x46d93a(0xcc)]){for(_0x746abf=0x0,_0x1632ef=_0x14ee79[_0x46d93a(0xcc)],_0x2a5056=_0x746abf;_0x2a5056<_0x1632ef;_0x2a5056++)_0x548400[_0x46d93a(0x15f)](_0x565f58[_0x46d93a(0xaa)](_0x4d2046,_0x4224c8,_0x4fb388,_0x2a5056,_0x14ee79));_0x5da997[_0x46d93a(0xc1)]=!0x0;}else{for(_0x746abf=0x0,_0x1632ef=_0x53d25c,_0x2a5056=_0x746abf;_0x2a5056<_0x1632ef;_0x2a5056++)_0x548400['push'](_0x565f58[_0x46d93a(0xaa)](_0x4d2046,_0x4224c8,_0x4fb388,_0x2a5056,_0x14ee79));}_0x14ee79[_0x46d93a(0x8e)]+=_0x548400[_0x46d93a(0xe7)];}if(!(_0x4fb388===_0x46d93a(0x10a)||_0x4fb388===_0x46d93a(0x91))&&!_0x3ce3cd&&_0x4fb388!==_0x46d93a(0xc0)&&_0x4fb388!==_0x46d93a(0x167)&&_0x4fb388!=='bigint'){var _0x1a9f3a=_0x3dd436[_0x46d93a(0x15c)]||_0x14ee79[_0x46d93a(0x15c)];if(this[_0x46d93a(0x117)](_0x4224c8)?(_0x2a5056=0x0,_0x4224c8[_0x46d93a(0xfd)](function(_0x1b9fb6){var _0x57054d=_0x46d93a;if(_0x1aa508++,_0x14ee79[_0x57054d(0x8e)]++,_0x1aa508>_0x1a9f3a){_0x52ae26=!0x0;return;}if(!_0x14ee79['isExpressionToEvaluate']&&_0x14ee79[_0x57054d(0x15a)]&&_0x14ee79[_0x57054d(0x8e)]>_0x14ee79[_0x57054d(0x16a)]){_0x52ae26=!0x0;return;}_0x548400['push'](_0x565f58[_0x57054d(0xaa)](_0x4d2046,_0x4224c8,_0x57054d(0x14d),_0x2a5056++,_0x14ee79,function(_0x2f7713){return function(){return _0x2f7713;};}(_0x1b9fb6)));})):this[_0x46d93a(0x16b)](_0x4224c8)&&_0x4224c8[_0x46d93a(0xfd)](function(_0x17c731,_0x214360){var _0x174899=_0x46d93a;if(_0x1aa508++,_0x14ee79[_0x174899(0x8e)]++,_0x1aa508>_0x1a9f3a){_0x52ae26=!0x0;return;}if(!_0x14ee79[_0x174899(0xad)]&&_0x14ee79[_0x174899(0x15a)]&&_0x14ee79[_0x174899(0x8e)]>_0x14ee79[_0x174899(0x16a)]){_0x52ae26=!0x0;return;}var _0x22d642=_0x214360['toString']();_0x22d642[_0x174899(0xe7)]>0x64&&(_0x22d642=_0x22d642[_0x174899(0x113)](0x0,0x64)+_0x174899(0x169)),_0x548400[_0x174899(0x15f)](_0x565f58[_0x174899(0xaa)](_0x4d2046,_0x4224c8,_0x174899(0xb7),_0x22d642,_0x14ee79,function(_0x556151){return function(){return _0x556151;};}(_0x17c731)));}),!_0x29c539){try{for(_0x40dd4f in _0x4224c8)if(!(_0x51cb09&&_0x25deba[_0x46d93a(0x106)](_0x40dd4f))&&!this[_0x46d93a(0x11e)](_0x4224c8,_0x40dd4f,_0x14ee79)){if(_0x1aa508++,_0x14ee79['autoExpandPropertyCount']++,_0x1aa508>_0x1a9f3a){_0x52ae26=!0x0;break;}if(!_0x14ee79[_0x46d93a(0xad)]&&_0x14ee79['autoExpand']&&_0x14ee79['autoExpandPropertyCount']>_0x14ee79[_0x46d93a(0x16a)]){_0x52ae26=!0x0;break;}_0x548400['push'](_0x565f58[_0x46d93a(0xae)](_0x4d2046,_0x537e32,_0x4224c8,_0x4fb388,_0x40dd4f,_0x14ee79));}}catch{}if(_0x537e32[_0x46d93a(0x120)]=!0x0,_0xd9e90e&&(_0x537e32['_p_name']=!0x0),!_0x52ae26){var _0x211cb6=[][_0x46d93a(0x95)](this['_getOwnPropertyNames'](_0x4224c8))[_0x46d93a(0x95)](this[_0x46d93a(0x14b)](_0x4224c8));for(_0x2a5056=0x0,_0x53d25c=_0x211cb6[_0x46d93a(0xe7)];_0x2a5056<_0x53d25c;_0x2a5056++)if(_0x40dd4f=_0x211cb6[_0x2a5056],!(_0x51cb09&&_0x25deba['test'](_0x40dd4f[_0x46d93a(0x15e)]()))&&!this[_0x46d93a(0x11e)](_0x4224c8,_0x40dd4f,_0x14ee79)&&!_0x537e32[_0x46d93a(0x165)+_0x40dd4f[_0x46d93a(0x15e)]()]){if(_0x1aa508++,_0x14ee79[_0x46d93a(0x8e)]++,_0x1aa508>_0x1a9f3a){_0x52ae26=!0x0;break;}if(!_0x14ee79[_0x46d93a(0xad)]&&_0x14ee79[_0x46d93a(0x15a)]&&_0x14ee79[_0x46d93a(0x8e)]>_0x14ee79[_0x46d93a(0x16a)]){_0x52ae26=!0x0;break;}_0x548400['push'](_0x565f58[_0x46d93a(0xae)](_0x4d2046,_0x537e32,_0x4224c8,_0x4fb388,_0x40dd4f,_0x14ee79));}}}}}if(_0x5da997[_0x46d93a(0x124)]=_0x4fb388,_0x5dda9e?(_0x5da997[_0x46d93a(0xd3)]=_0x4224c8[_0x46d93a(0xa1)](),this['_capIfString'](_0x4fb388,_0x5da997,_0x14ee79,_0x3dd436)):_0x4fb388===_0x46d93a(0xef)?_0x5da997[_0x46d93a(0xd3)]=this['_dateToString'][_0x46d93a(0x146)](_0x4224c8):_0x4fb388===_0x46d93a(0x136)?_0x5da997[_0x46d93a(0xd3)]=_0x4224c8[_0x46d93a(0x15e)]():_0x4fb388===_0x46d93a(0xdf)?_0x5da997[_0x46d93a(0xd3)]=this[_0x46d93a(0x85)][_0x46d93a(0x146)](_0x4224c8):_0x4fb388===_0x46d93a(0x8b)&&this[_0x46d93a(0xa8)]?_0x5da997[_0x46d93a(0xd3)]=this[_0x46d93a(0xa8)][_0x46d93a(0xa0)][_0x46d93a(0x15e)]['call'](_0x4224c8):!_0x14ee79[_0x46d93a(0x13a)]&&!(_0x4fb388===_0x46d93a(0x10a)||_0x4fb388===_0x46d93a(0x91))&&(delete _0x5da997[_0x46d93a(0xd3)],_0x5da997[_0x46d93a(0xb1)]=!0x0),_0x52ae26&&(_0x5da997['cappedProps']=!0x0),_0x13aa0d=_0x14ee79[_0x46d93a(0x14c)][_0x46d93a(0x143)],_0x14ee79[_0x46d93a(0x14c)]['current']=_0x5da997,this[_0x46d93a(0xcb)](_0x5da997,_0x14ee79),_0x548400[_0x46d93a(0xe7)]){for(_0x2a5056=0x0,_0x53d25c=_0x548400[_0x46d93a(0xe7)];_0x2a5056<_0x53d25c;_0x2a5056++)_0x548400[_0x2a5056](_0x2a5056);}_0x4d2046[_0x46d93a(0xe7)]&&(_0x5da997['props']=_0x4d2046);}catch(_0x5155d5){_0x5cd797(_0x5155d5,_0x5da997,_0x14ee79);}return this[_0x46d93a(0x89)](_0x4224c8,_0x5da997),this[_0x46d93a(0xe5)](_0x5da997,_0x14ee79),_0x14ee79[_0x46d93a(0x14c)][_0x46d93a(0x143)]=_0x13aa0d,_0x14ee79[_0x46d93a(0xf4)]--,_0x14ee79[_0x46d93a(0x15a)]=_0x44f501,_0x14ee79[_0x46d93a(0x15a)]&&_0x14ee79[_0x46d93a(0x13e)]['pop'](),_0x5da997;}[_0x54d984(0x14b)](_0x5808d9){var _0x66abf2=_0x54d984;return Object['getOwnPropertySymbols']?Object[_0x66abf2(0xf0)](_0x5808d9):[];}[_0x54d984(0x117)](_0x680252){var _0x44bf63=_0x54d984;return!!(_0x680252&&_0x252ee7[_0x44bf63(0x14d)]&&this['_objectToString'](_0x680252)===_0x44bf63(0xc6)&&_0x680252[_0x44bf63(0xfd)]);}[_0x54d984(0x11e)](_0x58c879,_0x46a1ce,_0x502fe2){var _0x5443a0=_0x54d984;return _0x502fe2[_0x5443a0(0x14e)]?typeof _0x58c879[_0x46a1ce]==_0x5443a0(0xc3):!0x1;}['_type'](_0x49a6f2){var _0x4ac393=_0x54d984,_0x268882='';return _0x268882=typeof _0x49a6f2,_0x268882===_0x4ac393(0xa9)?this[_0x4ac393(0x9a)](_0x49a6f2)==='[object\\x20Array]'?_0x268882=_0x4ac393(0xb8):this[_0x4ac393(0x9a)](_0x49a6f2)===_0x4ac393(0xa3)?_0x268882=_0x4ac393(0xef):this['_objectToString'](_0x49a6f2)===_0x4ac393(0xe3)?_0x268882='bigint':_0x49a6f2===null?_0x268882='null':_0x49a6f2['constructor']&&(_0x268882=_0x49a6f2[_0x4ac393(0x12f)]['name']||_0x268882):_0x268882===_0x4ac393(0x91)&&this[_0x4ac393(0x97)]&&_0x49a6f2 instanceof this[_0x4ac393(0x97)]&&(_0x268882=_0x4ac393(0x129)),_0x268882;}[_0x54d984(0x9a)](_0x1cd45f){var _0x1a6e5f=_0x54d984;return Object[_0x1a6e5f(0xa0)]['toString'][_0x1a6e5f(0x146)](_0x1cd45f);}[_0x54d984(0x157)](_0x5d44b7){var _0x2c2dcf=_0x54d984;return _0x5d44b7===_0x2c2dcf(0xa2)||_0x5d44b7==='string'||_0x5d44b7==='number';}[_0x54d984(0xc7)](_0x4a6219){var _0x107a17=_0x54d984;return _0x4a6219===_0x107a17(0x14a)||_0x4a6219===_0x107a17(0xc0)||_0x4a6219===_0x107a17(0x86);}[_0x54d984(0xaa)](_0x211ad2,_0x7563ed,_0x324fb2,_0x37a414,_0x13c141,_0x47991e){var _0x50d817=this;return function(_0x2a70e5){var _0x478d2f=_0x5a45,_0x436625=_0x13c141[_0x478d2f(0x14c)][_0x478d2f(0x143)],_0x573ae1=_0x13c141[_0x478d2f(0x14c)][_0x478d2f(0xd6)],_0x1e573d=_0x13c141[_0x478d2f(0x14c)][_0x478d2f(0x153)];_0x13c141['node'][_0x478d2f(0x153)]=_0x436625,_0x13c141[_0x478d2f(0x14c)][_0x478d2f(0xd6)]=typeof _0x37a414==_0x478d2f(0x149)?_0x37a414:_0x2a70e5,_0x211ad2[_0x478d2f(0x15f)](_0x50d817[_0x478d2f(0x119)](_0x7563ed,_0x324fb2,_0x37a414,_0x13c141,_0x47991e)),_0x13c141[_0x478d2f(0x14c)][_0x478d2f(0x153)]=_0x1e573d,_0x13c141[_0x478d2f(0x14c)][_0x478d2f(0xd6)]=_0x573ae1;};}[_0x54d984(0xae)](_0x3e4715,_0x10a913,_0x440dda,_0x1fcc02,_0x3df342,_0x198316,_0x1df01b){var _0xef252f=_0x54d984,_0x31db88=this;return _0x10a913['_p_'+_0x3df342[_0xef252f(0x15e)]()]=!0x0,function(_0xeacf84){var _0x202c1c=_0xef252f,_0x16f55b=_0x198316['node'][_0x202c1c(0x143)],_0x5a4b7f=_0x198316['node'][_0x202c1c(0xd6)],_0x97b5e3=_0x198316[_0x202c1c(0x14c)][_0x202c1c(0x153)];_0x198316[_0x202c1c(0x14c)]['parent']=_0x16f55b,_0x198316[_0x202c1c(0x14c)]['index']=_0xeacf84,_0x3e4715[_0x202c1c(0x15f)](_0x31db88['_property'](_0x440dda,_0x1fcc02,_0x3df342,_0x198316,_0x1df01b)),_0x198316['node'][_0x202c1c(0x153)]=_0x97b5e3,_0x198316[_0x202c1c(0x14c)][_0x202c1c(0xd6)]=_0x5a4b7f;};}[_0x54d984(0x119)](_0x1710ac,_0x1f5a60,_0x27288f,_0x15078b,_0x368b27){var _0xebca43=_0x54d984,_0x10e010=this;_0x368b27||(_0x368b27=function(_0x31720c,_0x3e0d38){return _0x31720c[_0x3e0d38];});var _0x1b9ee3=_0x27288f['toString'](),_0x24885a=_0x15078b[_0xebca43(0x148)]||{},_0x28587d=_0x15078b[_0xebca43(0x13a)],_0x5eed83=_0x15078b['isExpressionToEvaluate'];try{var _0x523302=this[_0xebca43(0x16b)](_0x1710ac),_0xa9c420=_0x1b9ee3;_0x523302&&_0xa9c420[0x0]==='\\x27'&&(_0xa9c420=_0xa9c420[_0xebca43(0xab)](0x1,_0xa9c420[_0xebca43(0xe7)]-0x2));var _0x4eb2f7=_0x15078b['expressionsToEvaluate']=_0x24885a[_0xebca43(0x165)+_0xa9c420];_0x4eb2f7&&(_0x15078b[_0xebca43(0x13a)]=_0x15078b[_0xebca43(0x13a)]+0x1),_0x15078b[_0xebca43(0xad)]=!!_0x4eb2f7;var _0x204548=typeof _0x27288f=='symbol',_0x71f08b={'name':_0x204548||_0x523302?_0x1b9ee3:this[_0xebca43(0x13c)](_0x1b9ee3)};if(_0x204548&&(_0x71f08b[_0xebca43(0x8b)]=!0x0),!(_0x1f5a60===_0xebca43(0xb8)||_0x1f5a60===_0xebca43(0x87))){var _0x2fc9cc=this['_getOwnPropertyDescriptor'](_0x1710ac,_0x27288f);if(_0x2fc9cc&&(_0x2fc9cc['set']&&(_0x71f08b[_0xebca43(0x156)]=!0x0),_0x2fc9cc['get']&&!_0x4eb2f7&&!_0x15078b[_0xebca43(0x16c)]))return _0x71f08b['getter']=!0x0,this['_processTreeNodeResult'](_0x71f08b,_0x15078b),_0x71f08b;}var _0x372093;try{_0x372093=_0x368b27(_0x1710ac,_0x27288f);}catch(_0xca98b){return _0x71f08b={'name':_0x1b9ee3,'type':_0xebca43(0x12c),'error':_0xca98b[_0xebca43(0xaf)]},this['_processTreeNodeResult'](_0x71f08b,_0x15078b),_0x71f08b;}var _0x4fc92b=this[_0xebca43(0xda)](_0x372093),_0x43167d=this['_isPrimitiveType'](_0x4fc92b);if(_0x71f08b['type']=_0x4fc92b,_0x43167d)this[_0xebca43(0x103)](_0x71f08b,_0x15078b,_0x372093,function(){var _0x48492f=_0xebca43;_0x71f08b[_0x48492f(0xd3)]=_0x372093[_0x48492f(0xa1)](),!_0x4eb2f7&&_0x10e010[_0x48492f(0x132)](_0x4fc92b,_0x71f08b,_0x15078b,{});});else{var _0x17e50c=_0x15078b[_0xebca43(0x15a)]&&_0x15078b['level']<_0x15078b[_0xebca43(0x13b)]&&_0x15078b[_0xebca43(0x13e)][_0xebca43(0xe9)](_0x372093)<0x0&&_0x4fc92b!==_0xebca43(0xc3)&&_0x15078b['autoExpandPropertyCount']<_0x15078b['autoExpandLimit'];_0x17e50c||_0x15078b['level']<_0x28587d||_0x4eb2f7?(this['serialize'](_0x71f08b,_0x372093,_0x15078b,_0x4eb2f7||{}),this[_0xebca43(0x89)](_0x372093,_0x71f08b)):this[_0xebca43(0x103)](_0x71f08b,_0x15078b,_0x372093,function(){var _0x3d5f37=_0xebca43;_0x4fc92b===_0x3d5f37(0x10a)||_0x4fc92b==='undefined'||(delete _0x71f08b['value'],_0x71f08b[_0x3d5f37(0xb1)]=!0x0);});}return _0x71f08b;}finally{_0x15078b[_0xebca43(0x148)]=_0x24885a,_0x15078b[_0xebca43(0x13a)]=_0x28587d,_0x15078b['isExpressionToEvaluate']=_0x5eed83;}}[_0x54d984(0x132)](_0x15644c,_0x21d003,_0x5d08ae,_0x477282){var _0x4ab8e6=_0x54d984,_0x597b03=_0x477282[_0x4ab8e6(0xc8)]||_0x5d08ae['strLength'];if((_0x15644c===_0x4ab8e6(0x8a)||_0x15644c===_0x4ab8e6(0xc0))&&_0x21d003[_0x4ab8e6(0xd3)]){let _0x3f458e=_0x21d003['value'][_0x4ab8e6(0xe7)];_0x5d08ae[_0x4ab8e6(0x127)]+=_0x3f458e,_0x5d08ae[_0x4ab8e6(0x127)]>_0x5d08ae['totalStrLength']?(_0x21d003['capped']='',delete _0x21d003['value']):_0x3f458e>_0x597b03&&(_0x21d003['capped']=_0x21d003[_0x4ab8e6(0xd3)][_0x4ab8e6(0xab)](0x0,_0x597b03),delete _0x21d003[_0x4ab8e6(0xd3)]);}}[_0x54d984(0x16b)](_0xadcbce){var _0x6e5f4b=_0x54d984;return!!(_0xadcbce&&_0x252ee7['Map']&&this[_0x6e5f4b(0x9a)](_0xadcbce)===_0x6e5f4b(0xdb)&&_0xadcbce['forEach']);}[_0x54d984(0x13c)](_0x2964aa){var _0x313a0d=_0x54d984;if(_0x2964aa[_0x313a0d(0xc2)](/^\\d+$/))return _0x2964aa;var _0x2d9f65;try{_0x2d9f65=JSON[_0x313a0d(0xe1)](''+_0x2964aa);}catch{_0x2d9f65='\\x22'+this['_objectToString'](_0x2964aa)+'\\x22';}return _0x2d9f65['match'](/^\"([a-zA-Z_][a-zA-Z_0-9]*)\"$/)?_0x2d9f65=_0x2d9f65['substr'](0x1,_0x2d9f65[_0x313a0d(0xe7)]-0x2):_0x2d9f65=_0x2d9f65['replace'](/'/g,'\\x5c\\x27')[_0x313a0d(0xd5)](/\\\\\"/g,'\\x22')[_0x313a0d(0xd5)](/(^\"|\"$)/g,'\\x27'),_0x2d9f65;}['_processTreeNodeResult'](_0xce303f,_0x5ff6c7,_0x2d4532,_0x55c161){var _0x428ab9=_0x54d984;this[_0x428ab9(0xcb)](_0xce303f,_0x5ff6c7),_0x55c161&&_0x55c161(),this[_0x428ab9(0x89)](_0x2d4532,_0xce303f),this[_0x428ab9(0xe5)](_0xce303f,_0x5ff6c7);}[_0x54d984(0xcb)](_0x41516b,_0x4712a1){var _0x2ed291=_0x54d984;this[_0x2ed291(0x135)](_0x41516b,_0x4712a1),this[_0x2ed291(0xd1)](_0x41516b,_0x4712a1),this['_setNodeExpressionPath'](_0x41516b,_0x4712a1),this[_0x2ed291(0x13f)](_0x41516b,_0x4712a1);}[_0x54d984(0x135)](_0x54df9e,_0x25adf7){}[_0x54d984(0xd1)](_0x2492f8,_0x44e33f){}[_0x54d984(0xfa)](_0x14f781,_0x5280eb){}[_0x54d984(0xd9)](_0x21f85d){var _0x19ef6c=_0x54d984;return _0x21f85d===this[_0x19ef6c(0x100)];}['_treeNodePropertiesAfterFullValue'](_0x489c95,_0x423c1c){var _0x28b63d=_0x54d984;this[_0x28b63d(0xfa)](_0x489c95,_0x423c1c),this[_0x28b63d(0xcd)](_0x489c95),_0x423c1c[_0x28b63d(0x11c)]&&this[_0x28b63d(0x123)](_0x489c95),this[_0x28b63d(0x152)](_0x489c95,_0x423c1c),this[_0x28b63d(0x92)](_0x489c95,_0x423c1c),this[_0x28b63d(0x170)](_0x489c95);}[_0x54d984(0x89)](_0x4dbcaa,_0x355b84){var _0x12d1f4=_0x54d984;let _0x1eed9a;try{_0x252ee7[_0x12d1f4(0x108)]&&(_0x1eed9a=_0x252ee7['console'][_0x12d1f4(0x9b)],_0x252ee7['console'][_0x12d1f4(0x9b)]=function(){}),_0x4dbcaa&&typeof _0x4dbcaa[_0x12d1f4(0xe7)]==_0x12d1f4(0x149)&&(_0x355b84[_0x12d1f4(0xe7)]=_0x4dbcaa[_0x12d1f4(0xe7)]);}catch{}finally{_0x1eed9a&&(_0x252ee7['console']['error']=_0x1eed9a);}if(_0x355b84[_0x12d1f4(0x124)]===_0x12d1f4(0x149)||_0x355b84['type']===_0x12d1f4(0x86)){if(isNaN(_0x355b84[_0x12d1f4(0xd3)]))_0x355b84['nan']=!0x0,delete _0x355b84[_0x12d1f4(0xd3)];else switch(_0x355b84[_0x12d1f4(0xd3)]){case Number[_0x12d1f4(0xfe)]:_0x355b84[_0x12d1f4(0xc9)]=!0x0,delete _0x355b84[_0x12d1f4(0xd3)];break;case Number[_0x12d1f4(0x16f)]:_0x355b84[_0x12d1f4(0x12e)]=!0x0,delete _0x355b84['value'];break;case 0x0:this[_0x12d1f4(0x116)](_0x355b84['value'])&&(_0x355b84[_0x12d1f4(0x10e)]=!0x0);break;}}else _0x355b84[_0x12d1f4(0x124)]==='function'&&typeof _0x4dbcaa[_0x12d1f4(0x15d)]=='string'&&_0x4dbcaa[_0x12d1f4(0x15d)]&&_0x355b84['name']&&_0x4dbcaa['name']!==_0x355b84[_0x12d1f4(0x15d)]&&(_0x355b84[_0x12d1f4(0xb2)]=_0x4dbcaa[_0x12d1f4(0x15d)]);}[_0x54d984(0x116)](_0x787478){var _0x5cb23d=_0x54d984;return 0x1/_0x787478===Number[_0x5cb23d(0x16f)];}[_0x54d984(0x123)](_0x313190){var _0x10707c=_0x54d984;!_0x313190[_0x10707c(0x15c)]||!_0x313190['props'][_0x10707c(0xe7)]||_0x313190[_0x10707c(0x124)]==='array'||_0x313190[_0x10707c(0x124)]===_0x10707c(0xb7)||_0x313190[_0x10707c(0x124)]===_0x10707c(0x14d)||_0x313190[_0x10707c(0x15c)][_0x10707c(0x13d)](function(_0x4dd13c,_0x18cb73){var _0x167573=_0x10707c,_0xa45fc9=_0x4dd13c[_0x167573(0x15d)][_0x167573(0xeb)](),_0x18dae3=_0x18cb73[_0x167573(0x15d)]['toLowerCase']();return _0xa45fc9<_0x18dae3?-0x1:_0xa45fc9>_0x18dae3?0x1:0x0;});}[_0x54d984(0x152)](_0xa69bd9,_0x24e091){var _0x76017=_0x54d984;if(!(_0x24e091['noFunctions']||!_0xa69bd9['props']||!_0xa69bd9[_0x76017(0x15c)]['length'])){for(var _0x7c22f=[],_0x265c9a=[],_0x56af45=0x0,_0x311920=_0xa69bd9['props'][_0x76017(0xe7)];_0x56af45<_0x311920;_0x56af45++){var _0x59194e=_0xa69bd9[_0x76017(0x15c)][_0x56af45];_0x59194e['type']===_0x76017(0xc3)?_0x7c22f[_0x76017(0x15f)](_0x59194e):_0x265c9a[_0x76017(0x15f)](_0x59194e);}if(!(!_0x265c9a['length']||_0x7c22f[_0x76017(0xe7)]<=0x1)){_0xa69bd9[_0x76017(0x15c)]=_0x265c9a;var _0x1e0926={'functionsNode':!0x0,'props':_0x7c22f};this[_0x76017(0x135)](_0x1e0926,_0x24e091),this[_0x76017(0xfa)](_0x1e0926,_0x24e091),this[_0x76017(0xcd)](_0x1e0926),this['_setNodePermissions'](_0x1e0926,_0x24e091),_0x1e0926['id']+='\\x20f',_0xa69bd9[_0x76017(0x15c)]['unshift'](_0x1e0926);}}}[_0x54d984(0x92)](_0x5d4567,_0x3f22a5){}[_0x54d984(0xcd)](_0xed1ebc){}[_0x54d984(0x147)](_0x44d40f){var _0x3bc38a=_0x54d984;return Array[_0x3bc38a(0x118)](_0x44d40f)||typeof _0x44d40f==_0x3bc38a(0xa9)&&this[_0x3bc38a(0x9a)](_0x44d40f)===_0x3bc38a(0x155);}[_0x54d984(0x13f)](_0x327ed6,_0x4f2889){}['_cleanNode'](_0x57f2ce){var _0x62d332=_0x54d984;delete _0x57f2ce[_0x62d332(0x105)],delete _0x57f2ce[_0x62d332(0x144)],delete _0x57f2ce['_hasMapOnItsPath'];}[_0x54d984(0x125)](_0x2708b4,_0x354945){}}let _0x2267c6=new _0x15f4c2(),_0x10e34e={'props':0x64,'elements':0x64,'strLength':0x400*0x32,'totalStrLength':0x400*0x32,'autoExpandLimit':0x1388,'autoExpandMaxDepth':0xa},_0x4bed4c={'props':0x5,'elements':0x5,'strLength':0x100,'totalStrLength':0x100*0x3,'autoExpandLimit':0x1e,'autoExpandMaxDepth':0x2};function _0xd37905(_0x44431c,_0x46b12f,_0x332972,_0x9a9f60,_0x222085,_0x333e5f){var _0x186dba=_0x54d984;let _0x12ec8b,_0x137fff;try{_0x137fff=_0x1ba96c(),_0x12ec8b=_0xa8908e[_0x46b12f],!_0x12ec8b||_0x137fff-_0x12ec8b['ts']>0x1f4&&_0x12ec8b[_0x186dba(0x93)]&&_0x12ec8b[_0x186dba(0xac)]/_0x12ec8b[_0x186dba(0x93)]<0x64?(_0xa8908e[_0x46b12f]=_0x12ec8b={'count':0x0,'time':0x0,'ts':_0x137fff},_0xa8908e[_0x186dba(0x12a)]={}):_0x137fff-_0xa8908e['hits']['ts']>0x32&&_0xa8908e[_0x186dba(0x12a)][_0x186dba(0x93)]&&_0xa8908e['hits'][_0x186dba(0xac)]/_0xa8908e['hits'][_0x186dba(0x93)]<0x64&&(_0xa8908e[_0x186dba(0x12a)]={});let _0x1e71fa=[],_0x420fae=_0x12ec8b['reduceLimits']||_0xa8908e[_0x186dba(0x12a)][_0x186dba(0x8d)]?_0x4bed4c:_0x10e34e,_0x4e8d1d=_0x5ab579=>{var _0x4918f5=_0x186dba;let _0x3afe12={};return _0x3afe12[_0x4918f5(0x15c)]=_0x5ab579[_0x4918f5(0x15c)],_0x3afe12[_0x4918f5(0xcc)]=_0x5ab579[_0x4918f5(0xcc)],_0x3afe12[_0x4918f5(0xc8)]=_0x5ab579[_0x4918f5(0xc8)],_0x3afe12[_0x4918f5(0xe6)]=_0x5ab579[_0x4918f5(0xe6)],_0x3afe12[_0x4918f5(0x16a)]=_0x5ab579['autoExpandLimit'],_0x3afe12[_0x4918f5(0x13b)]=_0x5ab579[_0x4918f5(0x13b)],_0x3afe12[_0x4918f5(0x11c)]=!0x1,_0x3afe12['noFunctions']=!_0x2be4cb,_0x3afe12[_0x4918f5(0x13a)]=0x1,_0x3afe12[_0x4918f5(0xf4)]=0x0,_0x3afe12[_0x4918f5(0xb6)]='root_exp_id',_0x3afe12['rootExpression']=_0x4918f5(0x158),_0x3afe12[_0x4918f5(0x15a)]=!0x0,_0x3afe12['autoExpandPreviousObjects']=[],_0x3afe12[_0x4918f5(0x8e)]=0x0,_0x3afe12[_0x4918f5(0x16c)]=!0x0,_0x3afe12[_0x4918f5(0x127)]=0x0,_0x3afe12[_0x4918f5(0x14c)]={'current':void 0x0,'parent':void 0x0,'index':0x0},_0x3afe12;};for(var _0x2a7234=0x0;_0x2a7234<_0x222085[_0x186dba(0xe7)];_0x2a7234++)_0x1e71fa[_0x186dba(0x15f)](_0x2267c6['serialize']({'timeNode':_0x44431c==='time'||void 0x0},_0x222085[_0x2a7234],_0x4e8d1d(_0x420fae),{}));if(_0x44431c===_0x186dba(0x10c)){let _0x2a0dc2=Error['stackTraceLimit'];try{Error[_0x186dba(0xce)]=0x1/0x0,_0x1e71fa['push'](_0x2267c6['serialize']({'stackNode':!0x0},new Error()['stack'],_0x4e8d1d(_0x420fae),{'strLength':0x1/0x0}));}finally{Error[_0x186dba(0xce)]=_0x2a0dc2;}}return{'method':'log','version':_0x1093fe,'args':[{'ts':_0x332972,'session':_0x9a9f60,'args':_0x1e71fa,'id':_0x46b12f,'context':_0x333e5f}]};}catch(_0x53c5b8){return{'method':'log','version':_0x1093fe,'args':[{'ts':_0x332972,'session':_0x9a9f60,'args':[{'type':_0x186dba(0x12c),'error':_0x53c5b8&&_0x53c5b8[_0x186dba(0xaf)]}],'id':_0x46b12f,'context':_0x333e5f}]};}finally{try{if(_0x12ec8b&&_0x137fff){let _0xeacb14=_0x1ba96c();_0x12ec8b[_0x186dba(0x93)]++,_0x12ec8b[_0x186dba(0xac)]+=_0x415d43(_0x137fff,_0xeacb14),_0x12ec8b['ts']=_0xeacb14,_0xa8908e[_0x186dba(0x12a)][_0x186dba(0x93)]++,_0xa8908e[_0x186dba(0x12a)][_0x186dba(0xac)]+=_0x415d43(_0x137fff,_0xeacb14),_0xa8908e[_0x186dba(0x12a)]['ts']=_0xeacb14,(_0x12ec8b[_0x186dba(0x93)]>0x32||_0x12ec8b[_0x186dba(0xac)]>0x64)&&(_0x12ec8b[_0x186dba(0x8d)]=!0x0),(_0xa8908e['hits'][_0x186dba(0x93)]>0x3e8||_0xa8908e[_0x186dba(0x12a)][_0x186dba(0xac)]>0x12c)&&(_0xa8908e[_0x186dba(0x12a)][_0x186dba(0x8d)]=!0x0);}}catch{}}}return _0xd37905;}((_0x2c791c,_0x715769,_0x35b369,_0x5602b0,_0x4260ca,_0x99bca4,_0x4ed33f,_0x4e081c,_0x2bffc0,_0x2457d4)=>{var _0x2e7b75=_0x39c404;if(_0x2c791c[_0x2e7b75(0x137)])return _0x2c791c[_0x2e7b75(0x137)];if(!J(_0x2c791c,_0x4e081c,_0x4260ca))return _0x2c791c['_console_ninja']={'consoleLog':()=>{},'consoleTrace':()=>{},'consoleTime':()=>{},'consoleTimeEnd':()=>{},'autoLog':()=>{},'autoLogMany':()=>{},'autoTraceMany':()=>{},'coverage':()=>{},'autoTrace':()=>{},'autoTime':()=>{},'autoTimeEnd':()=>{}},_0x2c791c[_0x2e7b75(0x137)];let _0x4b93b9=W(_0x2c791c),_0x6e38ae=_0x4b93b9[_0x2e7b75(0xa7)],_0x4abd16=_0x4b93b9['timeStamp'],_0x3bf630=_0x4b93b9[_0x2e7b75(0xb5)],_0x1025b5={'hits':{},'ts':{}},_0xe60b39=Y(_0x2c791c,_0x2bffc0,_0x1025b5,_0x99bca4),_0xc22f1f=_0x5d5ef7=>{_0x1025b5['ts'][_0x5d5ef7]=_0x4abd16();},_0x22f39c=(_0x2e9e0b,_0x3909a1)=>{var _0x37f4fa=_0x2e7b75;let _0x25ce43=_0x1025b5['ts'][_0x3909a1];if(delete _0x1025b5['ts'][_0x3909a1],_0x25ce43){let _0x282fa3=_0x6e38ae(_0x25ce43,_0x4abd16());_0x1a5bfa(_0xe60b39(_0x37f4fa(0xac),_0x2e9e0b,_0x3bf630(),_0x4cb23d,[_0x282fa3],_0x3909a1));}},_0x56f609=_0x27033c=>_0x1f57ea=>{var _0x4370b6=_0x2e7b75;try{_0xc22f1f(_0x1f57ea),_0x27033c(_0x1f57ea);}finally{_0x2c791c[_0x4370b6(0x108)][_0x4370b6(0xac)]=_0x27033c;}},_0x3b8a89=_0x61b94e=>_0x4f8947=>{var _0x4df500=_0x2e7b75;try{let [_0x445306,_0x599289]=_0x4f8947[_0x4df500(0x111)](_0x4df500(0x11b));_0x22f39c(_0x599289,_0x445306),_0x61b94e(_0x445306);}finally{_0x2c791c[_0x4df500(0x108)]['timeEnd']=_0x61b94e;}};_0x2c791c[_0x2e7b75(0x137)]={'consoleLog':(_0x486e14,_0x5a5f6f)=>{var _0x2abaf8=_0x2e7b75;_0x2c791c['console'][_0x2abaf8(0x16d)]['name']!==_0x2abaf8(0xb0)&&_0x1a5bfa(_0xe60b39(_0x2abaf8(0x16d),_0x486e14,_0x3bf630(),_0x4cb23d,_0x5a5f6f));},'consoleTrace':(_0x1ee243,_0x198f6d)=>{var _0x43fbdc=_0x2e7b75;_0x2c791c[_0x43fbdc(0x108)][_0x43fbdc(0x16d)]['name']!==_0x43fbdc(0xf1)&&_0x1a5bfa(_0xe60b39(_0x43fbdc(0x10c),_0x1ee243,_0x3bf630(),_0x4cb23d,_0x198f6d));},'consoleTime':()=>{var _0x478cdd=_0x2e7b75;_0x2c791c[_0x478cdd(0x108)][_0x478cdd(0xac)]=_0x56f609(_0x2c791c[_0x478cdd(0x108)][_0x478cdd(0xac)]);},'consoleTimeEnd':()=>{var _0xfd2b40=_0x2e7b75;_0x2c791c[_0xfd2b40(0x108)][_0xfd2b40(0x98)]=_0x3b8a89(_0x2c791c[_0xfd2b40(0x108)][_0xfd2b40(0x98)]);},'autoLog':(_0x590589,_0x3d297c)=>{var _0x4d8146=_0x2e7b75;_0x1a5bfa(_0xe60b39(_0x4d8146(0x16d),_0x3d297c,_0x3bf630(),_0x4cb23d,[_0x590589]));},'autoLogMany':(_0x566e85,_0xf5c048)=>{var _0x52c265=_0x2e7b75;_0x1a5bfa(_0xe60b39(_0x52c265(0x16d),_0x566e85,_0x3bf630(),_0x4cb23d,_0xf5c048));},'autoTrace':(_0x5f4ae6,_0x20adca)=>{var _0x38ab4d=_0x2e7b75;_0x1a5bfa(_0xe60b39(_0x38ab4d(0x10c),_0x20adca,_0x3bf630(),_0x4cb23d,[_0x5f4ae6]));},'autoTraceMany':(_0x507d93,_0x571933)=>{var _0x3e3a5d=_0x2e7b75;_0x1a5bfa(_0xe60b39(_0x3e3a5d(0x10c),_0x507d93,_0x3bf630(),_0x4cb23d,_0x571933));},'autoTime':(_0x1cf37e,_0x55e7c9,_0x7038ce)=>{_0xc22f1f(_0x7038ce);},'autoTimeEnd':(_0x6327fb,_0x3c032c,_0x44b6b6)=>{_0x22f39c(_0x3c032c,_0x44b6b6);},'coverage':_0x20742f=>{var _0x2d0d6e=_0x2e7b75;_0x1a5bfa({'method':_0x2d0d6e(0xf5),'version':_0x99bca4,'args':[{'id':_0x20742f}]});}};let _0x1a5bfa=b(_0x2c791c,_0x715769,_0x35b369,_0x5602b0,_0x4260ca,_0x2457d4),_0x4cb23d=_0x2c791c[_0x2e7b75(0xec)];return _0x2c791c[_0x2e7b75(0x137)];})(globalThis,_0x39c404(0xf9),_0x39c404(0x131),\"c:\\\\Users\\\\APLICACIONES MOVILES\\\\.vscode\\\\extensions\\\\wallabyjs.console-ninja-1.0.267\\\\node_modules\",_0x39c404(0xfb),'1.0.0',_0x39c404(0xd4),[\"localhost\",\"127.0.0.1\",\"example.cypress.io\",\"1-21-01-E034-11\",\"172.31.116.140\"],_0x39c404(0x140),_0x39c404(0x159));")}catch{}})().consoleLog(n,e)}catch{}return e}const jx=[{path:"",component:qx}];let Kx=(()=>{var n;class e{}return(n=e).\u0275fac=function(r){return new(r||n)},n.\u0275mod=b.oAB({type:n}),n.\u0275inj=b.cJS({imports:[$u.Bz.forChild(jx),$u.Bz]}),e})(),$x=(()=>{var n;class e{}return(n=e).\u0275fac=function(r){return new(r||n)},n.\u0275mod=b.oAB({type:n}),n.\u0275inj=b.cJS({imports:[Ku.ez,Z_.u5,qe.Pc,Kx]}),e})()}}]);